---
title: "Homework 4"
author: "Lindsay Jones"
description: The fourth homework
date: "11/14/2022"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - hw4
---

# Homework 4

## Setup

```{r}
library(alr4)
library(smss)
```

## Question 1

For recent data in Jacksonville, Florida, on y = selling price of home (in dollars), x₁ = size of home (in square feet), and x₂ = lot size (in square feet), the prediction equation is ŷ = −10,536 + 53.8x₁ + 2.84x₂.

### A

A particular home of 1240 square feet on a lot of 18,000 square feet sold for \$145,000. Find the predicted selling price and the residual, and interpret.

```{r}
#plug variables into equation
x1 = 1240
x2 = 18000
y = 145000

ybar1 <- (-10536)+(53.8*x1)+(2.84*x2)

ybar1
```

```{r}
#subtract predicted from actual to find residual
y - ybar1
```

The house sold for \$37,704 greater than predicted.

### B

For fixed lot size, how much is the house selling price predicted to increase for each square-foot increase in home size? Why?

```{r}
#plug variables into equation
x1f = 1241 #increased size by 1 square foot
x2f = 18000
yf = 145000

ybar1f <- (-10536)+(53.8*x1f)+(2.84*x2f)

#subtract old predicted price from new predicted price
ybar1f-ybar1 
```

In the given equation ŷ = −10,536 + 53.8x₁ + 2.84x₂, the slope coefficient for x₁ (size of home) is 53.8, meaning for every 1-foot increase in square footage the house selling price increases by \$53.80. In the code above I demonstrate this by taking my code from part A and increasing square footage by 1, then subtracting part A's solution from the new solution.

### C

According to this prediction equation, for fixed home size, how much would lot size need to increase to have the same impact as a one-square-foot increase in home size?

```{r}
53.8/2.84
```

The slope coefficient for x₂ (lot size) is 2.84, meaning for every 1-foot increase in lot size the house selling price increases by \$2.84. We can use the equation 2.84 \* x₂ = 53.8 to calculate what increase in lot size is needed to have the same value increase in home size. We can simplify this equation as 53.8/2.84, which equals about 18.94 square feet.

## Question 2

The data file concerns salary and other characteristics of all faculty in a small Midwestern college collected in the early 1980s for presentation in legal proceedings for which discrimination against women in salary was at issue. All persons in the data hold tenured or tenure track positions; temporary faculty are not included. The variables include degree, a factor with levels PhD and MS; rank, a factor with levels Asst, Assoc, and Prof; sex, a factor with levels Male and Female; Year, years in current rank; ysdeg, years since highest degree, and salary, academic year salary in dollars.

```{r}
head(salary)
```


### A
Test the hypothesis that the mean salary for men and women is the same, without regard to any other variable but sex. Explain your findings.

The null hypothesis is that the mean salary for men is the same as the mean salary for women, controlling for other variables. The alternative hypothesis is that the mean salary for men is NOT the same as the mean salary for women, controlling for other variables.

```{r}
t.test(salary ~ sex, data = salary, var.equal = TRUE)
```
The t-test shows that the mean salaries for each sex are different, but since the p-value is greater than .05, we fail to reject the null hypothesis.

### B
Run a multiple linear regression with salary as the outcome variable and everything else as predictors, including sex. Assuming no interactions between sex and the other predictors, obtain a 95% confidence interval for the difference in salary between males and females.

```{r}
#run multiple linear regression
fit = lm(formula = salary ~ degree + rank + sex + year + ysdeg, data = salary)
summary(fit)
```
```{r}
#obtain a 95% confidence interval
confint(fit, "sexFemale")
```
The above confidence interval suggests that a female professor may earn between approximately \$697.82 less and \$3030.57 more than a male professor. 

### C
Interpret your finding for each predictor variable; discuss (a) statistical significance, (b) interpretation of the coefficient / slope in relation to the outcome variable and other variables. 

```{r}
summary(fit)
```
We can see from the p-values that the only statistically significant predictors are rank (both associate and professor) and year. The estimator column gives us the coefficient/slope of each variable, so we see that all variables except years since last degree are associated with an increase in salary. Years since last degree is actually associated with a decrease in salary (but again, this value is not statistically significant). 

### D
Change the baseline category for the rank variable. Interpret the coefficients related to rank again.

```{r}
rank2 = relevel(salary$rank, "Prof")

fit2 = lm(formula = salary ~ degree + rank2 + sex + year + ysdeg, data = salary)
summary(fit2)
```
By changing the baseline category for the rank to "Prof," I made the coefficients for the rank completely different- now rank is associated with a decrease in salary. This just means that if a professor were to become an assistant or associate professor, their salary would be expected to decrease. 

### E

Finkelstein (1980), in a discussion of the use of regression in discrimination cases, wrote, “[a] variable may reflect a position or status bestowed by the employer, in which case if there is discrimination in the award of the position or status, the variable may be ‘tainted.’ ” Thus, for example, if discrimination is at work in promotion of faculty to higher ranks, using rank to adjust salaries before comparing the sexes may not be acceptable to the courts. 

Exclude the variable rank, refit, and summarize how your findings changed, if they did.

```{r}
fit3 = lm(formula = salary ~ degree + sex + year + ysdeg, data = salary)
summary(fit3)
```
Eliminating rank from the regression completely changes the direction for having a PhD, being female, and years since last degree. 

### F

Everyone in this dataset was hired the year they earned their highest degree. It is also known that a new Dean was appointed 15 years ago, and everyone in the dataset who earned their highest degree 15 years ago or less than that has been hired by the new Dean. Some people have argued that the new Dean has been making offers that are a lot more generous to newly hired faculty than the previous one and that this might explain some of the variation in Salary.

Create a new variable that would allow you to test this hypothesis and run another multiple regression model to test this. Select variables carefully to make sure there is no multicollinearity. Explain why multicollinearity would be a concern in this case and how you avoided it. Do you find support for the hypothesis that the people hired by the new Dean are making higher than those that were not?

```{r}
#create a dummy variable
salary$hired <- ifelse(salary$ysdeg <= 15, 1, 0)

dean <- lm(salary ~ hired + rank + sex + degree, data = salary)
summary(dean)
```
I removed the variable ysdegree since it would be highly correlated (collinear) with the dummy variable I created, which is based on those who earned their most recent degree in the last 15 years. In this model, those hired by the new dean make $319 more than those hired by the previous dean. This is only supported at the highest significance level, so I would not say that the evidence to support this theory is strong. 

## Question 3

### A
Using the house.selling.price data, run and report regression results modeling y = selling price (in dollars) in terms of size of home (in square feet) and whether the home is new (1 = yes; 0 = no). In particular, for each variable; discuss statistical significance and interpret the meaning of the coefficient.

```{r}
data("house.selling.price")

summary(lm(Price ~ Size + New, data = house.selling.price))
```
Size and "newnesss" of the homes both seem to be a predictor, as they are both statistically significant at the given value. The coefficient for size indicates that the price is expected to increase by about \$116.13 for every 1 foot increase in square footage. The coefficient for newness indicates that, controlling for everything else, a new home is expected to sell for about \$57,736.28 more than an older home. 

### B
Report and interpret the prediction equation, and form separate equations relating selling price to size for new and for not new homes.

The prediction equation is ŷ = -40230.867 + 116.132x + 57736.283z, where x = the size of the home; and z = 1 if the home is new or z = 0 if the home is older.

Old: price = -40230.867 + 116.132x
New: price = -40230.867 + 116.132 + 57736.283   or 17505.133 + 116.132x

### C
Find the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.

```{r}
#old
-40230.867 + 116.132*3000

#new
17505.133 + 116.132*3000
```
### D
Fit another model, this time with an interaction term allowing interaction between size and new, and report the regression results
```{r}
newfit = lm(Price ~ Size*New, data = house.selling.price)
summary(newfit)
```
The interaction between size and newness appears statistically significant.

### E
Report the lines relating the predicted selling price to the size for homes that are (i) new, (ii) not new.

Old: ŷ = -22227.808 + 104.438x
New: ŷ = -22227.808 + 104.438x + -78527.502 + 61.916xz

### F
Find the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.

#### i
```{r}
#new
-22227.808 + 104.438*3000 + -78527.502 + 61.916*3000
```

#### ii
```{r}
#old
-22227.808 + 104.438*3000
```
### G
Find the predicted selling price for a home of 1500 square feet that is (i) new, (ii) not new. Comparing to (F), explain how the difference in predicted selling prices changes as the size of home increases.

```{r}
#new
-22227.808 + 104.438*1500 + -78527.502 + 61.916*1500
```

#### ii
```{r}
#old
-22227.808 + 104.438*1500
```
We can see that the price difference for larger homes differs much more dramatically based on age than for smaller homes. 

### H
Do you think the model with interaction or the one without it represents the relationship of size and new to the outcome price? What makes you prefer one model over another?

Based on the p-values and the R-squared for both models, I think the model with interaction is a slightly better fit. 