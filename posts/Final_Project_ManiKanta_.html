<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mani Kanta Gogula">
<meta name="dcterms.date" content="2022-12-03">
<meta name="description" content="Final project">

<title>Final project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final project">
<meta name="twitter:description" content="Final project">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Fall_2022/">
 <span class="menu-text">Fall 2022 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/603_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#heart-disease-in-the-united-states" id="toc-heart-disease-in-the-united-states" class="nav-link active" data-scroll-target="#heart-disease-in-the-united-states">Heart Disease in the United States:</a></li>
  <li><a href="#research" id="toc-research" class="nav-link" data-scroll-target="#research">Research :</a></li>
  <li><a href="#loading-required-libraries-and-reading-the-dataset" id="toc-loading-required-libraries-and-reading-the-dataset" class="nav-link" data-scroll-target="#loading-required-libraries-and-reading-the-dataset">Loading Required Libraries and Reading the Dataset</a></li>
  <li><a href="#variable-description" id="toc-variable-description" class="nav-link" data-scroll-target="#variable-description">Variable Description</a></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis</a></li>
  <li><a href="#renaming-the-columns" id="toc-renaming-the-columns" class="nav-link" data-scroll-target="#renaming-the-columns">Renaming the columns</a></li>
  <li><a href="#variable-description-1" id="toc-variable-description-1" class="nav-link" data-scroll-target="#variable-description-1">Variable Description</a></li>
  <li><a href="#reading-the-dataset" id="toc-reading-the-dataset" class="nav-link" data-scroll-target="#reading-the-dataset">Reading the Dataset</a></li>
  <li><a href="#structure-of-the-dataset" id="toc-structure-of-the-dataset" class="nav-link" data-scroll-target="#structure-of-the-dataset">Structure of the dataset</a></li>
  <li><a href="#data-summary" id="toc-data-summary" class="nav-link" data-scroll-target="#data-summary">Data Summary</a></li>
  <li><a href="#dimension-of-the-data" id="toc-dimension-of-the-data" class="nav-link" data-scroll-target="#dimension-of-the-data">Dimension of the Data</a></li>
  <li><a href="#glimpse-of-the-dataset" id="toc-glimpse-of-the-dataset" class="nav-link" data-scroll-target="#glimpse-of-the-dataset">Glimpse of the Dataset</a></li>
  <li><a href="#counting-outcome-variable" id="toc-counting-outcome-variable" class="nav-link" data-scroll-target="#counting-outcome-variable">Counting outcome variable</a></li>
  <li><a href="#removing-null-values-and-inapporpriate-data" id="toc-removing-null-values-and-inapporpriate-data" class="nav-link" data-scroll-target="#removing-null-values-and-inapporpriate-data">Removing Null values and Inapporpriate Data</a></li>
  <li><a href="#recoding-the-variables-based-on-data" id="toc-recoding-the-variables-based-on-data" class="nav-link" data-scroll-target="#recoding-the-variables-based-on-data">Recoding the variables based on Data</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">Correlation Analysis</a></li>
  <li><a href="#correlation-between-the-variables" id="toc-correlation-between-the-variables" class="nav-link" data-scroll-target="#correlation-between-the-variables">Correlation between the variables</a></li>
  <li><a href="#regression-model" id="toc-regression-model" class="nav-link" data-scroll-target="#regression-model">Regression Model</a></li>
  <li><a href="#model-evaluation-and-dianostic-plots" id="toc-model-evaluation-and-dianostic-plots" class="nav-link" data-scroll-target="#model-evaluation-and-dianostic-plots">Model Evaluation and Dianostic Plots</a></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling">Modelling</a></li>
  <li><a href="#data-preparation-for-modelling" id="toc-data-preparation-for-modelling" class="nav-link" data-scroll-target="#data-preparation-for-modelling">Data Preparation For Modelling</a></li>
  <li><a href="#logistic-regression-assumptions" id="toc-logistic-regression-assumptions" class="nav-link" data-scroll-target="#logistic-regression-assumptions">Logistic Regression Assumptions</a></li>
  <li><a href="#partitioning-the-data" id="toc-partitioning-the-data" class="nav-link" data-scroll-target="#partitioning-the-data">Partitioning the Data</a></li>
  <li><a href="#multiple-logistic-regression" id="toc-multiple-logistic-regression" class="nav-link" data-scroll-target="#multiple-logistic-regression">Multiple logistic regression</a></li>
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model 1</a></li>
  <li><a href="#hypothesis-evaluation" id="toc-hypothesis-evaluation" class="nav-link" data-scroll-target="#hypothesis-evaluation">Hypothesis Evaluation</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation :</a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2">Model 2</a></li>
  <li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3">Model 3</a></li>
  <li><a href="#model-evaluation-and-diagnostics" id="toc-model-evaluation-and-diagnostics" class="nav-link" data-scroll-target="#model-evaluation-and-diagnostics">Model Evaluation and Diagnostics</a></li>
  <li><a href="#variable-importance" id="toc-variable-importance" class="nav-link" data-scroll-target="#variable-importance">Variable Importance</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model Comparison:</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final</div>
    <div class="quarto-category">Heart Disease Prediction</div>
    <div class="quarto-category">Mani Kanta Gogula</div>
  </div>
  </div>

<div>
  <div class="description">
    Final project
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mani Kanta Gogula </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 3, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="heart-disease-in-the-united-states" class="level1">
<h1>Heart Disease in the United States:</h1>
<p>Heart disease is the leading cause of death for men, women, and people of most racial and ethnic groups in the United States.One person dies every 34 seconds in the United States from cardiovascular disease.About 697,000 people in the United States died from heart disease in 2020—that’s 1 in every 5 deaths.Heart disease cost the United States about $229 billion each year from 2017 to 2018.3 This includes the cost of health care services, medicines, and lost productivity due to death. Coronary heart disease is the most common type of heart disease, killing 382,820 people in 2020. About 20.1 million adults age 20 and older have CAD (about 7.2%).In 2020, about 2 in 10 deaths from CAD happen in adults less than 65 years old.Early Action Is Important for Heart Attack Know the warning signs and symptoms of a heart attack. In the United States, someone has a heart attack every 40 seconds.2 Every year, about 805,000 people in the United States have a heart attack.Of these, 605,000 are a first heart attack 200,000 happen to people who have already had a heart attack About 1 in 5 heart attacks are silent—the damage is done, but the person is not aware of it.</p>
<div class="cell">

</div>
</section>
<section id="research" class="level1">
<h1>Research :</h1>
<ol type="1">
<li><p>Examining the relationship between maximum heart rate one can achieve during excercise and likelihood of developing heart disease .</p></li>
<li><p>Using Multiple logistic regression confounding effects of age and gender.</p></li>
</ol>
</section>
<section id="loading-required-libraries-and-reading-the-dataset" class="level1">
<h1>Loading Required Libraries and Reading the Dataset</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'kableExtra' was built under R version 4.1.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.2 --
v ggplot2 3.4.0      v purrr   0.3.5 
v tibble  3.1.8      v dplyr   1.0.10
v tidyr   1.2.1      v stringr 1.5.0 
v readr   2.1.3      v forcats 0.5.2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter()     masks stats::filter()
x dplyr::group_rows() masks kableExtra::group_rows()
x dplyr::lag()        masks stats::lag()</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'caret' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'GGally' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pROC' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Metrics' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Metrics'

The following object is masked from 'package:pROC':

    auc

The following objects are masked from 'package:caret':

    precision, recall</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"heart_cleveland_upload.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 297 Columns: 14
-- Column specification --------------------------------------------------------
Delimiter: ","
dbl (14): age, sex, cp, trestbps, chol, fbs, restecg, thalach, exang, oldpea...

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sex"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["trestbps"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["chol"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["fbs"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["restecg"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["thalach"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["exang"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["oldpeak"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["slope"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["ca"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["thal"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["condition"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"69","2":"1","3":"0","4":"160","5":"234","6":"1","7":"2","8":"131","9":"0","10":"0.1","11":"1","12":"1","13":"0","14":"0"},{"1":"69","2":"0","3":"0","4":"140","5":"239","6":"0","7":"0","8":"151","9":"0","10":"1.8","11":"0","12":"2","13":"0","14":"0"},{"1":"66","2":"0","3":"0","4":"150","5":"226","6":"0","7":"0","8":"114","9":"0","10":"2.6","11":"2","12":"0","13":"0","14":"0"},{"1":"65","2":"1","3":"0","4":"138","5":"282","6":"1","7":"2","8":"174","9":"0","10":"1.4","11":"1","12":"1","13":"0","14":"1"},{"1":"64","2":"1","3":"0","4":"110","5":"211","6":"0","7":"2","8":"144","9":"1","10":"1.8","11":"1","12":"0","13":"0","14":"0"},{"1":"64","2":"1","3":"0","4":"170","5":"227","6":"0","7":"2","8":"155","9":"0","10":"0.6","11":"1","12":"0","13":"2","14":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="variable-description" class="level1">
<h1>Variable Description</h1>
<p>There are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:</p>
<p>Age: Age of subject</p>
<p>Sex: Gender of subject: 0 = female 1 = male</p>
<p>Chest-pain type: Type of chest-pain experienced by the individual: 1 = typical angina 2 = atypical angina 3 = non-angina pain 4 = asymptomatic angina</p>
<p>Resting Blood Pressure: Resting blood pressure in mm Hg</p>
<p>Serum Cholesterol: Serum cholesterol in mg/dl</p>
<p>Fasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar &lt;= 120 mg/dl 1 = fasting blood sugar &gt; 120 mg/dl</p>
<p>Resting ECG: Resting electrocardiographic results 0 = normal 1 = ST-T wave abnormality 2 = left ventricle hyperthrophy</p>
<p>Max Heart Rate Achieved: Max heart rate of subject</p>
<p>Exercise Induced Angina: 0 = no 1 = yes</p>
<p>ST Depression Induced by Exercise Relative to Rest: ST Depression of subject</p>
<p>Peak Exercise ST Segment: 1 = Up-sloaping 2 = Flat 3 = Down-sloaping</p>
<p>Number of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro</p>
<p>Thal: Form of thalassemia: 3 3 = normal 6 = fixed defect 7 = reversible defect</p>
<p>Diagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not: 0 = absence 1 = heart disease present</p>
</section>
<section id="hypothesis" class="level1">
<h1>Hypothesis</h1>
<p>The aging and elderly population are particularly susceptible to cardiovascular disease. Age is an independent risk factor for cardiovascular disease (CVD) in adults, but these risks are compounded by additional factors, including frailty, obesity, and diabetes. These factors are known to complicate and enhance cardiac risk factors that are associated with the onset of advanced age. Sex is another potential risk factor in aging adults, given that older females are reported to be at a greater risk for CVD than age-matched men. However, in both men and women, the risks associated with CVD increase with age, and these correspond to an overall decline in sex hormones, primarily of estrogen and testosterone. Despite this, hormone replacement therapies are largely shown to not improve outcomes in older patients and may also increase the risks of cardiac events in older adults. My Hypothesis for this project based on a reserach article.</p>
<p>Does Sex/Gender Have an effect?</p>
</section>
<section id="renaming-the-columns" class="level1">
<h1>Renaming the columns</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sex"</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Chest_Pain_Type"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Resting_Blood_Pressure"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Serum_Cholesterol"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Fasting_Blood_Sugar"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Resting_ECG"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Max_Heart_Rate_Achieved"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Exercise_Induced_Angina"</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"ST_Depression_Exercise"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Peak_Exercise_ST_Segment"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Num_Major_Vessels_Flouro"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Thalassemia"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Diagnosis_Heart_Disease"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply column names to the dataframe</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heart_disease_dataset) <span class="ot">&lt;-</span> names</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Glimpse data to verify new column names are in place</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 297
Columns: 14
$ Age                      &lt;dbl&gt; 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~
$ Sex                      &lt;dbl&gt; 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~
$ Chest_Pain_Type          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ Resting_Blood_Pressure   &lt;dbl&gt; 160, 140, 150, 138, 110, 170, 145, 134, 150, ~
$ Serum_Cholesterol        &lt;dbl&gt; 234, 239, 226, 282, 211, 227, 233, 234, 240, ~
$ Fasting_Blood_Sugar      &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~
$ Resting_ECG              &lt;dbl&gt; 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~
$ Max_Heart_Rate_Achieved  &lt;dbl&gt; 131, 151, 114, 174, 144, 155, 150, 145, 171, ~
$ Exercise_Induced_Angina  &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ ST_Depression_Exercise   &lt;dbl&gt; 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~
$ Peak_Exercise_ST_Segment &lt;dbl&gt; 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~
$ Num_Major_Vessels_Flouro &lt;dbl&gt; 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~
$ Thalassemia              &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~
$ Diagnosis_Heart_Disease  &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~</code></pre>
</div>
</div>
</section>
<section id="variable-description-1" class="level1">
<h1>Variable Description</h1>
<p>There are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:</p>
<p>Age: Age of subject</p>
<p>Sex: Gender of subject: 0 = female 1 = male</p>
<p>Chest-pain type: Type of chest-pain experienced by the individual: 1 = typical angina 2 = atypical angina 3 = non-angina pain 4 = asymptomatic angina</p>
<p>Resting Blood Pressure: Resting blood pressure in mm Hg</p>
<p>Serum Cholesterol: Serum cholesterol in mg/dl</p>
<p>Fasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar &lt;= 120 mg/dl 1 = fasting blood sugar &gt; 120 mg/dl</p>
<p>Resting ECG: Resting electrocardiographic results 0 = normal 1 = ST-T wave abnormality 2 = left ventricle hyperthrophy</p>
<p>Max Heart Rate Achieved: Max heart rate of subject</p>
<p>Exercise Induced Angina: 0 = no 1 = yes</p>
<p>ST Depression Induced by Exercise Relative to Rest: ST Depression of subject</p>
<p>Peak Exercise ST Segment: 1 = Up-sloaping 2 = Flat 3 = Down-sloaping</p>
<p>Number of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro</p>
<p>Thal: Form of thalassemia: 3 3 = normal 6 = fixed defect 7 = reversible defect</p>
<p>Diagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not: 0 = absence 1 = heart disease present</p>
</section>
<section id="reading-the-dataset" class="level1">
<h1>Reading the Dataset</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sex"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chest_Pain_Type"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Resting_Blood_Pressure"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Serum_Cholesterol"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Fasting_Blood_Sugar"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Resting_ECG"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Max_Heart_Rate_Achieved"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Exercise_Induced_Angina"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["ST_Depression_Exercise"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Peak_Exercise_ST_Segment"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Num_Major_Vessels_Flouro"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Thalassemia"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Diagnosis_Heart_Disease"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"69","2":"1","3":"0","4":"160","5":"234","6":"1","7":"2","8":"131","9":"0","10":"0.1","11":"1","12":"1","13":"0","14":"0"},{"1":"69","2":"0","3":"0","4":"140","5":"239","6":"0","7":"0","8":"151","9":"0","10":"1.8","11":"0","12":"2","13":"0","14":"0"},{"1":"66","2":"0","3":"0","4":"150","5":"226","6":"0","7":"0","8":"114","9":"0","10":"2.6","11":"2","12":"0","13":"0","14":"0"},{"1":"65","2":"1","3":"0","4":"138","5":"282","6":"1","7":"2","8":"174","9":"0","10":"1.4","11":"1","12":"1","13":"0","14":"1"},{"1":"64","2":"1","3":"0","4":"110","5":"211","6":"0","7":"2","8":"144","9":"1","10":"1.8","11":"1","12":"0","13":"0","14":"0"},{"1":"64","2":"1","3":"0","4":"170","5":"227","6":"0","7":"2","8":"155","9":"0","10":"0.6","11":"1","12":"0","13":"2","14":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sex"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chest_Pain_Type"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Resting_Blood_Pressure"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Serum_Cholesterol"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Fasting_Blood_Sugar"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Resting_ECG"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Max_Heart_Rate_Achieved"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Exercise_Induced_Angina"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["ST_Depression_Exercise"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Peak_Exercise_ST_Segment"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Num_Major_Vessels_Flouro"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Thalassemia"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Diagnosis_Heart_Disease"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"40","2":"1","3":"3","4":"110","5":"167","6":"0","7":"2","8":"114","9":"1","10":"2.0","11":"1","12":"0","13":"2","14":"1"},{"1":"40","2":"1","3":"3","4":"152","5":"223","6":"0","7":"0","8":"181","9":"0","10":"0.0","11":"0","12":"0","13":"2","14":"1"},{"1":"39","2":"1","3":"3","4":"118","5":"219","6":"0","7":"0","8":"140","9":"0","10":"1.2","11":"1","12":"0","13":"2","14":"1"},{"1":"35","2":"1","3":"3","4":"120","5":"198","6":"0","7":"0","8":"130","9":"1","10":"1.6","11":"1","12":"0","13":"2","14":"1"},{"1":"35","2":"0","3":"3","4":"138","5":"183","6":"0","7":"0","8":"182","9":"0","10":"1.4","11":"0","12":"0","13":"0","14":"0"},{"1":"35","2":"1","3":"3","4":"126","5":"282","6":"0","7":"2","8":"156","9":"1","10":"0.0","11":"0","12":"0","13":"2","14":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="structure-of-the-dataset" class="level1">
<h1>Structure of the dataset</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#structure of the dataset</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [297 x 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ Age                     : num [1:297] 69 69 66 65 64 64 63 61 60 59 ...
 $ Sex                     : num [1:297] 1 0 0 1 1 1 1 1 0 1 ...
 $ Chest_Pain_Type         : num [1:297] 0 0 0 0 0 0 0 0 0 0 ...
 $ Resting_Blood_Pressure  : num [1:297] 160 140 150 138 110 170 145 134 150 178 ...
 $ Serum_Cholesterol       : num [1:297] 234 239 226 282 211 227 233 234 240 270 ...
 $ Fasting_Blood_Sugar     : num [1:297] 1 0 0 1 0 0 1 0 0 0 ...
 $ Resting_ECG             : num [1:297] 2 0 0 2 2 2 2 0 0 2 ...
 $ Max_Heart_Rate_Achieved : num [1:297] 131 151 114 174 144 155 150 145 171 145 ...
 $ Exercise_Induced_Angina : num [1:297] 0 0 0 0 1 0 0 0 0 0 ...
 $ ST_Depression_Exercise  : num [1:297] 0.1 1.8 2.6 1.4 1.8 0.6 2.3 2.6 0.9 4.2 ...
 $ Peak_Exercise_ST_Segment: num [1:297] 1 0 2 1 1 1 2 1 0 2 ...
 $ Num_Major_Vessels_Flouro: num [1:297] 1 2 0 1 0 0 0 2 0 0 ...
 $ Thalassemia             : num [1:297] 0 0 0 0 0 2 1 0 0 2 ...
 $ Diagnosis_Heart_Disease : num [1:297] 0 0 0 1 0 0 0 1 0 0 ...
 - attr(*, "spec")=
  .. cols(
  ..   age = col_double(),
  ..   sex = col_double(),
  ..   cp = col_double(),
  ..   trestbps = col_double(),
  ..   chol = col_double(),
  ..   fbs = col_double(),
  ..   restecg = col_double(),
  ..   thalach = col_double(),
  ..   exang = col_double(),
  ..   oldpeak = col_double(),
  ..   slope = col_double(),
  ..   ca = col_double(),
  ..   thal = col_double(),
  ..   condition = col_double()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</section>
<section id="data-summary" class="level1">
<h1>Data Summary</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary of the dataset</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Age             Sex         Chest_Pain_Type Resting_Blood_Pressure
 Min.   :29.00   Min.   :0.0000   Min.   :0.000   Min.   : 94.0         
 1st Qu.:48.00   1st Qu.:0.0000   1st Qu.:2.000   1st Qu.:120.0         
 Median :56.00   Median :1.0000   Median :2.000   Median :130.0         
 Mean   :54.54   Mean   :0.6768   Mean   :2.158   Mean   :131.7         
 3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:3.000   3rd Qu.:140.0         
 Max.   :77.00   Max.   :1.0000   Max.   :3.000   Max.   :200.0         
 Serum_Cholesterol Fasting_Blood_Sugar  Resting_ECG     Max_Heart_Rate_Achieved
 Min.   :126.0     Min.   :0.0000      Min.   :0.0000   Min.   : 71.0          
 1st Qu.:211.0     1st Qu.:0.0000      1st Qu.:0.0000   1st Qu.:133.0          
 Median :243.0     Median :0.0000      Median :1.0000   Median :153.0          
 Mean   :247.4     Mean   :0.1448      Mean   :0.9966   Mean   :149.6          
 3rd Qu.:276.0     3rd Qu.:0.0000      3rd Qu.:2.0000   3rd Qu.:166.0          
 Max.   :564.0     Max.   :1.0000      Max.   :2.0000   Max.   :202.0          
 Exercise_Induced_Angina ST_Depression_Exercise Peak_Exercise_ST_Segment
 Min.   :0.0000          Min.   :0.000          Min.   :0.0000          
 1st Qu.:0.0000          1st Qu.:0.000          1st Qu.:0.0000          
 Median :0.0000          Median :0.800          Median :1.0000          
 Mean   :0.3266          Mean   :1.056          Mean   :0.6027          
 3rd Qu.:1.0000          3rd Qu.:1.600          3rd Qu.:1.0000          
 Max.   :1.0000          Max.   :6.200          Max.   :2.0000          
 Num_Major_Vessels_Flouro  Thalassemia    Diagnosis_Heart_Disease
 Min.   :0.0000           Min.   :0.000   Min.   :0.0000         
 1st Qu.:0.0000           1st Qu.:0.000   1st Qu.:0.0000         
 Median :0.0000           Median :0.000   Median :0.0000         
 Mean   :0.6768           Mean   :0.835   Mean   :0.4613         
 3rd Qu.:1.0000           3rd Qu.:2.000   3rd Qu.:1.0000         
 Max.   :3.0000           Max.   :2.000   Max.   :1.0000         </code></pre>
</div>
</div>
</section>
<section id="dimension-of-the-data" class="level1">
<h1>Dimension of the Data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 297  14</code></pre>
</div>
</div>
</section>
<section id="glimpse-of-the-dataset" class="level1">
<h1>Glimpse of the Dataset</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#glimpse of the dataset</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_disease_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 297
Columns: 14
$ Age                      &lt;dbl&gt; 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~
$ Sex                      &lt;dbl&gt; 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~
$ Chest_Pain_Type          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ Resting_Blood_Pressure   &lt;dbl&gt; 160, 140, 150, 138, 110, 170, 145, 134, 150, ~
$ Serum_Cholesterol        &lt;dbl&gt; 234, 239, 226, 282, 211, 227, 233, 234, 240, ~
$ Fasting_Blood_Sugar      &lt;dbl&gt; 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~
$ Resting_ECG              &lt;dbl&gt; 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~
$ Max_Heart_Rate_Achieved  &lt;dbl&gt; 131, 151, 114, 174, 144, 155, 150, 145, 171, ~
$ Exercise_Induced_Angina  &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ ST_Depression_Exercise   &lt;dbl&gt; 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~
$ Peak_Exercise_ST_Segment &lt;dbl&gt; 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~
$ Num_Major_Vessels_Flouro &lt;dbl&gt; 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~
$ Thalassemia              &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~
$ Diagnosis_Heart_Disease  &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~</code></pre>
</div>
</div>
<p>I also want to know the number of observations in the dependent variable column to understand if the dataset is relatively balanced.</p>
<p>To know this factor , I have removed null values if there is any in the dataset and have counted the Dependent variable Diagnosis_Heart_Disease .</p>
</section>
<section id="counting-outcome-variable" class="level1">
<h1>Counting outcome variable</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Determine the number of values in each level of dependent variable</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"full_width"</span> <span class="ot">=</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:center;"> Diagnosis_Heart_Disease </th>
   <th style="text-align:center;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 160 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 137 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>By above result we can state that that there is no huge difference in the dependent variable of the dataset . Since the value 0 in the above result states that there is a no presence of heart disease and the value 1 states that patient is diagnoised with the heart disease.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identify the different levels of Thalassemia</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Thalassemia) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"full_width"</span> <span class="ot">=</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:center;"> Thalassemia </th>
   <th style="text-align:center;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 164 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 18 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 2 </td>
   <td style="text-align:center;"> 115 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="removing-null-values-and-inapporpriate-data" class="level1">
<h1>Removing Null values and Inapporpriate Data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop NA's, convert to factors, lump target variable to 2 levels, remove "?", reorder variables</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>heart_dataset_clean_tbl <span class="ot">&lt;-</span> heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Resting_ECG"</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Fasting_Blood_Sugar"</span>, </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Sex"</span>, </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Diagnosis_Heart_Disease"</span>, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Exercise_Induced_Angina"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Peak_Exercise_ST_Segment"</span>, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Chest_Pain_Type"</span>), as_factor) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Num_Major_Vessels_Flouro =</span> <span class="fu">as.numeric</span>(Num_Major_Vessels_Flouro)) <span class="sc">%&gt;%</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Diagnosis_Heart_Disease =</span> <span class="fu">fct_lump</span>(Diagnosis_Heart_Disease, <span class="at">other_level =</span> <span class="st">"1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Thalassemia <span class="sc">!=</span> <span class="st">"?"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Age, </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>           Resting_Blood_Pressure, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>           Serum_Cholesterol, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>           Max_Heart_Rate_Achieved, </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>           ST_Depression_Exercise,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>           Num_Major_Vessels_Flouro,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">everything</span>())</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Glimpse data</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>heart_dataset_clean_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 297
Columns: 14
$ Age                      &lt;dbl&gt; 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~
$ Resting_Blood_Pressure   &lt;dbl&gt; 160, 140, 150, 138, 110, 170, 145, 134, 150, ~
$ Serum_Cholesterol        &lt;dbl&gt; 234, 239, 226, 282, 211, 227, 233, 234, 240, ~
$ Max_Heart_Rate_Achieved  &lt;dbl&gt; 131, 151, 114, 174, 144, 155, 150, 145, 171, ~
$ ST_Depression_Exercise   &lt;dbl&gt; 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~
$ Num_Major_Vessels_Flouro &lt;dbl&gt; 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~
$ Sex                      &lt;fct&gt; 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~
$ Chest_Pain_Type          &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ Fasting_Blood_Sugar      &lt;fct&gt; 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~
$ Resting_ECG              &lt;fct&gt; 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~
$ Exercise_Induced_Angina  &lt;fct&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~
$ Peak_Exercise_ST_Segment &lt;fct&gt; 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~
$ Thalassemia              &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~
$ Diagnosis_Heart_Disease  &lt;fct&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~</code></pre>
</div>
</div>
</section>
<section id="recoding-the-variables-based-on-data" class="level1">
<h1>Recoding the variables based on Data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select categorical vars, recode them to their character values, convert to long format</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>hd_long_fact_tbl <span class="ot">&lt;-</span> heart_dataset_clean_tbl  <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>         Chest_Pain_Type,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         Fasting_Blood_Sugar,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         Resting_ECG,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         Exercise_Induced_Angina,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         Peak_Exercise_ST_Segment,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         Thalassemia,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>         Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">recode_factor</span>(Sex, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"female"</span>, </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"male"</span> ),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chest_Pain_Type =</span> <span class="fu">recode_factor</span>(Chest_Pain_Type, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"typical"</span>,   </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"atypical"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"non-angina"</span>, </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"asymptomatic"</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">Fasting_Blood_Sugar =</span> <span class="fu">recode_factor</span>(Fasting_Blood_Sugar, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"&lt;= 120 mg/dl"</span>, </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"&gt; 120 mg/dl"</span>),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Resting_ECG =</span> <span class="fu">recode_factor</span>(Resting_ECG, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"normal"</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"ST-T abnormality"</span>,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"LV hypertrophy"</span>),</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">Exercise_Induced_Angina =</span> <span class="fu">recode_factor</span>(Exercise_Induced_Angina, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"no"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"yes"</span>),</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">Peak_Exercise_ST_Segment =</span> <span class="fu">recode_factor</span>(Peak_Exercise_ST_Segment, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"up-sloaping"</span>,</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"flat"</span>,</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"down-sloaping"</span>),</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">Thalassemia =</span> <span class="fu">recode_factor</span>(Thalassemia, <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"normal"</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">6</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"fixed defect"</span>,</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">7</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"reversible defect"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>Diagnosis_Heart_Disease)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unreplaced values treated as NA as `.x` is not compatible.
Please specify replacements exhaustively or supply `.default`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables;
they will be dropped</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualize with bar plot</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>hd_long_fact_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x        =</span> value, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill     =</span> Diagnosis_Heart_Disease), </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha    =</span> .<span class="dv">6</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">"dodge"</span>, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color    =</span> <span class="st">"black"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width    =</span> .<span class="dv">8</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Scaled Effect of Categorical Variables"</span>) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fde725ff"</span>, <span class="st">"#20a486ff"</span>),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">name   =</span> <span class="st">"Heart</span><span class="sc">\n</span><span class="st">Disease"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No HD"</span>, <span class="st">"Yes HD"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Must gather() data first in order to facet wrap by key </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#(default gather call puts all var names into new key col)</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>hd_long_cont_tbl <span class="ot">&lt;-</span> heart_dataset_clean_tbl  <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         Resting_Blood_Pressure,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         Serum_Cholesterol,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>         Max_Heart_Rate_Achieved,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>         ST_Depression_Exercise,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>         Num_Major_Vessels_Flouro,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>         Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key   =</span> <span class="st">"key"</span>, </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> <span class="st">"value"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Diagnosis_Heart_Disease)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualize numeric variables as boxplots</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>hd_long_cont_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diagnosis_Heart_Disease),</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha  =</span> .<span class="dv">6</span>,</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fatten =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Boxplots for Numeric Variables"</span>) <span class="sc">+</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fde725ff"</span>, <span class="st">"#20a486ff"</span>),</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">name   =</span> <span class="st">"Heart</span><span class="sc">\n</span><span class="st">Disease"</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No HD"</span>, <span class="st">"Yes HD"</span>)) <span class="sc">+</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol   =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The faceted plots for categorical and numeric variables suggest the following conditions are associated with increased prevalence of heart disease (note: this does not mean the relationship is causal).</p>
<p>Asymptomatic angina chest pain (relative to typical angina chest pain, atypical angina pain, or non-angina pain) Presence of exercise induced angina Lower fasting blood sugar Flat or down-sloaping peak exercise ST segment Presence of left ventricle hypertrophy Male Higher thelassemia score Higher age Lower max heart rate achieved Higher resting blood pressure Higher cholesterol Higher ST depression induced by exercise relative to rest</p>
<p>Age, blood pressure, cholesterol, and sex all point in the right direction based on what we generally know about the world around us. This provides a nice phase gate to let us proceed with the analysis.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>age.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heart_disease_dataset, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">fill =</span> Diagnosis_Heart_Disease)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Diagnosis_Heart_Disease)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prevelance of Heart Disease Across Age"</span>, <span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>age.plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Highly correlated variables can lead to overly complicated models or wonky predictions. The ggcorr() function from GGally package provides a nice, clean correlation matrix of the numeric variables. The default method is Pearson which I use here first. Pearson isn’t ideal if the data is skewed or has a lot of outliers so I’ll check using the rank-based Kendall method as well.</p>
</section>
<section id="correlation-analysis" class="level1">
<h1>Correlation Analysis</h1>
<p>Correlation analysis allows us to obtain an understanding on relationship and direction between features. Example +0.8 indicates very strong positive relationship while 0 indicates no relationship.</p>
<p>Two methods i.e.&nbsp;Pearson and Kendall are used for the correlation analysis in this study.</p>
</section>
<section id="correlation-between-the-variables" class="level1">
<h1>Correlation between the variables</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix using Pearson method, default method is Pearson</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> <span class="fu">ggcorr</span>(<span class="at">high       =</span> <span class="st">"#20a486ff"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">low        =</span> <span class="st">"#fde725ff"</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label      =</span> <span class="cn">TRUE</span>, </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust      =</span> <span class="fl">0.99</span>, </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size       =</span> <span class="dv">3</span>, </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label_size =</span> <span class="dv">3</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nbreaks    =</span> <span class="dv">5</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>                                              ) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Matrix"</span>,</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Pearson Method Using Pairwise Obervations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix using Kendall method</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> <span class="fu">ggcorr</span>(<span class="at">method     =</span> <span class="fu">c</span>(<span class="st">"pairwise"</span>, <span class="st">"kendall"</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">high       =</span> <span class="st">"#20a486ff"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">low        =</span> <span class="st">"#fde725ff"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label      =</span> <span class="cn">TRUE</span>, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust      =</span> .<span class="dv">99</span>, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size       =</span> <span class="dv">3</span>, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label_size =</span> <span class="dv">3</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nbreaks    =</span> <span class="dv">5</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                                   ) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Matrix"</span>,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Kendall Method Using Pairwise Observations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on Pearson and Kendall’s correlation result, the factors that showed correlation &gt;= 40% with the target feature are: Chest Pain type, Num of Major Vessels, Exercise Induced Angina, and ST Depression.</p>
<p>There are very minor differences between the Pearson and Kendall results. No variables appear to be highly correlated (i.e.&nbsp;&gt; 50%) As such, it seems reasonable to keep all the original 14 variables as we proceed into the modeling section.Some additional steps can be used in the modelling stage to identify the statitically significant features</p>
</section>
<section id="regression-model" class="level1">
<h1>Regression Model</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> heart_disease_dataset, Diagnosis_Heart_Disease <span class="sc">~</span>.,)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linear_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Diagnosis_Heart_Disease ~ ., data = heart_disease_dataset)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.95099 -0.21719 -0.04465  0.19177  0.88874 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              -0.0505202  0.3027180  -0.167 0.867577    
Age                      -0.0012505  0.0027322  -0.458 0.647534    
Sex                       0.1483876  0.0490138   3.027 0.002693 ** 
Chest_Pain_Type           0.0826754  0.0241094   3.429 0.000696 ***
Resting_Blood_Pressure    0.0021831  0.0012512   1.745 0.082106 .  
Serum_Cholesterol         0.0003295  0.0004153   0.794 0.428151    
Fasting_Blood_Sugar      -0.0955640  0.0596062  -1.603 0.109993    
Resting_ECG               0.0329834  0.0212532   1.552 0.121797    
Max_Heart_Rate_Achieved  -0.0026911  0.0011311  -2.379 0.018014 *  
Exercise_Induced_Angina   0.1334793  0.0505880   2.639 0.008787 ** 
ST_Depression_Exercise    0.0315276  0.0230370   1.369 0.172221    
Peak_Exercise_ST_Segment  0.0646453  0.0423642   1.526 0.128142    
Num_Major_Vessels_Flouro  0.1437419  0.0250276   5.743 2.39e-08 ***
Thalassemia               0.1228227  0.0257060   4.778 2.85e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3482 on 283 degrees of freedom
Multiple R-squared:  0.5352,    Adjusted R-squared:  0.5139 
F-statistic: 25.07 on 13 and 283 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="model-evaluation-and-dianostic-plots" class="level1">
<h1>Model Evaluation and Dianostic Plots</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)); <span class="fu">plot</span>(linear_model, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>According to the diagnostic plots, none of the models seem to fit super well. There are violations of assumptions in models. so I will be doing logistic regression to get a better model and check the accuracy.</p>
</section>
<section id="modelling" class="level1">
<h1>Modelling</h1>
</section>
<section id="data-preparation-for-modelling" class="level1">
<h1>Data Preparation For Modelling</h1>
<p>The plan is to split up the original data set to form a training group (70%) and testing group (30%). The training group will be used to fit the model while the testing group will be used to evaluate predictions. The initial_split() function creates a split object which is just an efficient way to store both the training and testing sets. The training() and testing() functions are used to extract the appropriate dataframes out of the split object when needed.</p>
<p>Create Logistic Regression Model</p>
<p>Logistic regression is a form of regression analysis. A binary logistic regression is used when the target feature is a dichotomy, having only two values, for example, 0 or 1, or Yes or No.&nbsp;In this project, it is used to compute the prediction of the presence of heart disease. It can be used to predict what conditions that could likely cause the presence of heart disease.The R function glm(), for generalized linear model, can be used to compute logistic regression. We need to specify the option family = binomial, which tells to R that we want to fit logistic regression.</p>
</section>
<section id="logistic-regression-assumptions" class="level1">
<h1>Logistic Regression Assumptions</h1>
<p>The first assumption is that there is a linear relationship between continuous independent variables and the logit of the outcome variable.</p>
<p>Independence of errors requires that there be no dependence between samples in the model, i.e.&nbsp;using the same individuals at different times.</p>
<p>Multicollinearity refers to a relationship (correlation) between the independent variables and must be excluded from logistic regression models</p>
</section>
<section id="partitioning-the-data" class="level1">
<h1>Partitioning the Data</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>trainDataIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease, <span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list =</span> F)  <span class="co"># 70% training data</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> heart_disease_dataset[trainDataIndex, ]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> heart_disease_dataset[<span class="sc">-</span>trainDataIndex, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="multiple-logistic-regression" class="level1">
<h1>Multiple logistic regression</h1>
<p>The multiple logistic regression is used to predict the probability of class membership based on multiple predictor variables, as follow:</p>
</section>
<section id="model-1" class="level1">
<h1>Model 1</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using glm function from base R and specify the family argument as binomial</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> heart_disease_dataset, Diagnosis_Heart_Disease <span class="sc">~</span>.,, <span class="at">family =</span> <span class="st">"binomial"</span> )</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the model summary</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Diagnosis_Heart_Disease ~ ., family = "binomial", 
    data = heart_disease_dataset)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8042  -0.5263  -0.1860   0.4161   2.3676  

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -5.118417   2.729300  -1.875  0.06074 .  
Age                      -0.014057   0.024036  -0.585  0.55866    
Sex                       1.319688   0.486718   2.711  0.00670 ** 
Chest_Pain_Type           0.578582   0.191335   3.024  0.00250 ** 
Resting_Blood_Pressure    0.024182   0.010727   2.254  0.02418 *  
Serum_Cholesterol         0.004816   0.003775   1.276  0.20202    
Fasting_Blood_Sugar      -0.991868   0.554947  -1.787  0.07389 .  
Resting_ECG               0.246117   0.185238   1.329  0.18396    
Max_Heart_Rate_Achieved  -0.021183   0.010275  -2.062  0.03923 *  
Exercise_Induced_Angina   0.915651   0.414003   2.212  0.02699 *  
ST_Depression_Exercise    0.249909   0.212418   1.176  0.23940    
Peak_Exercise_ST_Segment  0.582699   0.362317   1.608  0.10778    
Num_Major_Vessels_Flouro  1.267008   0.265723   4.768 1.86e-06 ***
Thalassemia               0.714003   0.202068   3.533  0.00041 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 203.86  on 283  degrees of freedom
AIC: 231.86

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>From the output above, the coefficients table shows the beta coefficient estimates and their significance levels. Columns are:</p>
<p>Estimate: the intercept (b0) and the beta coefficient estimates associated to each predictor variable</p>
<p>Std.Error: the standard error of the coefficient estimates. This represents the accuracy of the coefficients. The larger the standard error, the less confident we are about the estimate.</p>
<p>z value: the z-statistic, which is the coefficient estimate (column 2) divided by the standard error of the estimate (column 3)</p>
<p>Pr(&gt;|z|): The p-value corresponding to the z-statistic. The smaller the p-value, the more significant the estimate is.</p>
</section>
<section id="hypothesis-evaluation" class="level1">
<h1>Hypothesis Evaluation</h1>
<p>We have a p-value of less than 0.05 significance level. So we reject the null hypothesis and conclude that Sex and Diagnosis_Heart_disease have a significant relationship.</p>
</section>
<section id="interpretation" class="level1">
<h1>Interpretation :</h1>
<p>It can be seen only sex, chest pain type, resting blood pressure, maximum heart rate reached during exercise, and exercise induced angina are significantly associated with the outcome.And the other variables like Age, serum cholesterol, and fasting blood sugar were found to be insignificant predictors of the outcome of the data i.e Diagnosis_heart_disease.</p>
<p>The coefficient estimate of the variable Chest_Pain_Type is 0.578582, which is positive. This means that an increase in chest_Pain_Type is associated with increase in the probability of being heart disease. However the coefficient for the variable Fasting_Blood_Sugar is -0.991868, which is negative. This means that an increase in Fasting_Blood_Sugar will be associated with a decreased probability of being heart disease positive.Similarly the other variables like Thalassemia, which is positive with 0.714 that means that an increase in Thalassemia is associated with the increase in the probability of the heart disease.Variable Peak_Exercise_ST_Segment which is positive with 0.582699, and an increase in Peak_Exercise_ST_Segment is associated with the increase in the probabality of the heart disease.</p>
<p>An important concept to understand, for interpreting the logistic beta coefficients, is the odds ratio. An odds ratio measures the association between a predictor variable (x) and the outcome variable (y). It represents the ratio of the odds that an event will occur (event = 1) given the presence of the predictor x (x = 1), compared to the odds of the event occurring in the absence of that predictor (x = 0).</p>
<p>For a given predictor (say x1), the associated beta coefficient (b1) in the logistic regression function corresponds to the log of the odds ratio for that predictor.</p>
<p>If the odds ratio is 2, then the odds that the event occurs (event = 1) are two times higher when the predictor x is present (x = 1) versus x is absent (x = 0).</p>
<p>For example, the regression coefficient Chest_Pain_Type is 0.578582. This indicate that one unit increase in the Chest_Pain_Type concentration will increase the odds of heart disease by exp(0.57) 1.7 times.</p>
<p>From the logistic regression results, it can be noticed that some variables - serum cholesterol, and fasting blood sugar and age - are not statistically significant. Keeping them in the model may contribute to overfitting. Therefore, they should be eliminated.</p>
</section>
<section id="model-2" class="level1">
<h1>Model 2</h1>
<p>So I’m running again the multiple logistic regression using significant variables and removing variables which are statistically not significant. Below is my second model with the variables which are significant. i.e Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>logitmod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span> Chest_Pain_Type<span class="sc">+</span>Resting_Blood_Pressure<span class="sc">+</span>Exercise_Induced_Angina<span class="sc">+</span>Num_Major_Vessels_Flouro<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Diagnosis_Heart_Disease ~ Chest_Pain_Type + Resting_Blood_Pressure + 
    Exercise_Induced_Angina + Num_Major_Vessels_Flouro + Thalassemia, 
    family = "binomial", data = heart_disease_dataset)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.6485  -0.5736  -0.3053   0.5457   2.4856  

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -5.675942   1.349495  -4.206 2.60e-05 ***
Chest_Pain_Type           0.574750   0.178033   3.228 0.001245 ** 
Resting_Blood_Pressure    0.017156   0.009169   1.871 0.061338 .  
Exercise_Induced_Angina   1.321728   0.367050   3.601 0.000317 ***
Num_Major_Vessels_Flouro  1.183047   0.213516   5.541 3.01e-08 ***
Thalassemia               1.013251   0.175363   5.778 7.56e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 235.66  on 291  degrees of freedom
AIC: 247.66

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8426966</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Resting_Blood_Pressure=</span><span class="dv">100</span>, <span class="at">Exercise_Induced_Angina=</span><span class="dv">2</span>, <span class="at">Thalassemia=</span><span class="dv">0</span>,<span class="at">Chest_Pain_Type=</span><span class="dv">0</span>, <span class="at">Num_Major_Vessels_Flouro=</span><span class="dv">4</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>p_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.9681783 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, clasification error</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease) </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease) </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC= 0.838959854014598"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy= 0.841750841750842"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Classification Error= 0.158249158249158"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Predicted Status
True Status   0   1
          0 140  20
          1  27 110</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-3" class="level1">
<h1>Model 3</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>logitmod3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span> Chest_Pain_Type<span class="sc">+</span>Exercise_Induced_Angina<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Diagnosis_Heart_Disease ~ Chest_Pain_Type + Exercise_Induced_Angina + 
    Thalassemia, family = "binomial", data = heart_disease_dataset)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.2599  -0.6121  -0.4437   0.7150   2.4528  

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -2.9575     0.4240  -6.975 3.07e-12 ***
Chest_Pain_Type           0.6889     0.1694   4.066 4.78e-05 ***
Exercise_Induced_Angina   1.2391     0.3353   3.696 0.000219 ***
Thalassemia               1.0621     0.1585   6.700 2.09e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 279.17  on 293  degrees of freedom
AIC: 287.17

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7752809</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Exercise_Induced_Angina=</span><span class="dv">2</span>, <span class="at">Thalassemia=</span><span class="dv">0</span>,<span class="at">Chest_Pain_Type=</span><span class="dv">0</span>)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>p_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.3824118 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, classification error</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2) </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2) </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC= 0.806660583941606"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy= 0.808080808080808"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Classification Error= 0.191919191919192"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Predicted Status
True Status   0   1
          0 140  20
          1  27 110</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Model 4</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>logitmod4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span>Resting_Blood_Pressure<span class="sc">+</span>Num_Major_Vessels_Flouro<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Diagnosis_Heart_Disease ~ Resting_Blood_Pressure + 
    Num_Major_Vessels_Flouro + Thalassemia, family = "binomial", 
    data = heart_disease_dataset)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8472  -0.5522  -0.4629   0.6345   2.1491  

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -3.558096   1.165384  -3.053  0.00226 ** 
Resting_Blood_Pressure    0.012531   0.008666   1.446  0.14815    
Num_Major_Vessels_Flouro  1.204857   0.196336   6.137 8.42e-10 ***
Thalassemia               1.175053   0.160420   7.325 2.39e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 409.95  on 296  degrees of freedom
Residual deviance: 272.39  on 293  degrees of freedom
AIC: 280.39

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.752809</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Resting_Blood_Pressure=</span><span class="dv">160</span>,<span class="at">Num_Major_Vessels_Flouro=</span><span class="dv">2</span>,<span class="at">Thalassemia=</span><span class="dv">2</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>p_new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.9610853 </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, clasification error</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3) </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3) </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AUC= 0.792084854014598"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Accuracy= 0.791245791245791"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Classification Error= 0.208754208754209"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Predicted Status
True Status   0   1
          0 140  20
          1  27 110</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_ManiKanta__files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(logitmod2, logitmod3,logitmod4, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================
                              Dependent variable:     
                         -----------------------------
                            Diagnosis_Heart_Disease   
                            (1)       (2)       (3)   
------------------------------------------------------
Chest_Pain_Type          0.575***  0.689***           
                          (0.178)   (0.169)           
                                                      
Resting_Blood_Pressure    0.017*               0.013  
                          (0.009)             (0.009) 
                                                      
Exercise_Induced_Angina  1.322***  1.239***           
                          (0.367)   (0.335)           
                                                      
Num_Major_Vessels_Flouro 1.183***            1.205*** 
                          (0.214)             (0.196) 
                                                      
Thalassemia              1.013***  1.062***  1.175*** 
                          (0.175)   (0.159)   (0.160) 
                                                      
Constant                 -5.676*** -2.958*** -3.558***
                          (1.349)   (0.424)   (1.165) 
                                                      
------------------------------------------------------
Observations                297       297       297   
Log Likelihood           -117.832  -139.584  -136.197 
Akaike Inf. Crit.         247.665   287.169   280.394 
======================================================
Note:                      *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="model-evaluation-and-diagnostics" class="level1">
<h1>Model Evaluation and Diagnostics</h1>
<p>A logistic regression models has been built and the coefficients have been examined. However, some critical questions remain.</p>
<p>Which model among all the models is good?</p>
<p>Whcih Predictors are most important?</p>
<p>Are the Predictions Accurate?</p>
<p>To answer these critical Questions We perform Model Evaluation Techniques: Likelihood Ratio Test (Goodness of fit) Varaible Importance</p>
<p>#1. Likelihood Ratio Test (Goodness of fit) :</p>
<p>A logistic regression is said to provide a better fit to the data if it demonstrates an improvement over a model with fewer predictors. This is performed using the likelihood ratio test, which compares the likelihood of the data under the full model against the likelihood of the data under a model with fewer predictors. Removing predictor variables from a model will almost always make the model fit less well (i.e.&nbsp;a model will have a lower log likelihood), but it is necessary to test whether the observed difference in model fit is statistically significant. Given that H0 holds that the reduced model is true, a p-value for the overall model fit statistic that is less than 0.05 would compel us to reject the null hypothesis. It would provide evidence against the reduced model in favor of the current model. The likelihood ratio test can be performed in R using the lrtest() function from the lmtest package or using the anova() function in base.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model,logitmod2, <span class="at">test =</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"283","2":"203.8609","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"291","2":"235.6646","3":"-8","4":"-31.80371","5":"0.0001009902","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lmtest' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'zoo' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(logitmod2,logitmod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["#Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["LogLik"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"6","2":"-117.8323","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"4","2":"-139.5844","3":"-2","4":"43.50422","5":"3.574191e-10","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The structure of this output:</p>
<p>Here, we see each model listed out, followed by a table that shows each model’s degrees of freedom and loglikelihood. To the right of these values, we are given the degrees of freedom of our test statistic, the value of our test statistic, and then our p-value.</p>
<p>From the output we can see that the p-value of the likelihood ratio test is 0.000101. Since this is less than .05, we would reject the null hypothesis.</p>
<p>Thus, we would conclude that the model 3 with reduced predictors offers a significant improvement in fit over the model with just reduced predictors comapring with the model 2.</p>
</section>
<section id="variable-importance" class="level1">
<h1>Variable Importance</h1>
<p>To assess the relative importance of individual predictors in the model, we can also look at the absolute value of the t-statistic for each model parameter. This technique is utilized by the varImp function in the caret package for general and generalized linear models.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Overall"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.228334","_rn_":"Chest_Pain_Type"},{"1":"1.871053","_rn_":"Resting_Blood_Pressure"},{"1":"3.600954","_rn_":"Exercise_Induced_Angina"},{"1":"5.540799","_rn_":"Num_Major_Vessels_Flouro"},{"1":"5.778032","_rn_":"Thalassemia"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Overall"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.066296","_rn_":"Chest_Pain_Type"},{"1":"3.695847","_rn_":"Exercise_Induced_Angina"},{"1":"6.699872","_rn_":"Thalassemia"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Overall"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.446081","_rn_":"Resting_Blood_Pressure"},{"1":"6.136708","_rn_":"Num_Major_Vessels_Flouro"},{"1":"7.324856","_rn_":"Thalassemia"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-comparison" class="level1">
<h1>Model Comparison:</h1>
<p>In the first Model, I have performed mutliple logistic regression with all the predictor valuables in the data to predict heart disease.</p>
<p>Based on the first model , I found the variables which are statistically significant and which are not statistically significant.Variable which are statistically significant are Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi .</p>
<p>In the third model , I have used all the predictors which are statistically significant and found the AUC of 84%. Later in the third model , I have used three variables which are statistically significant i.e.Chest_Pain_Type,Excercise_Induced_Angin as a predictor variables and found the AUC of 80.6%.</p>
<p>Rest three statistically significant variables :Resting_Blood_Pressure,Num_Major_Vessels_Flouro,Thalassemia are executed in this model and found the AUC of 79.2%</p>
<p>Based on all these models, We can infer that the model with all the variables which are statistically significant are the best predictors to classify the patient for the heart disease diagnosis. This model has an AUC of 84%</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>After doing this analysis, I can conclude that the variables in data are not much correlated and there are more categorical variables.</p>
<p>The best Logistic model with dependent variable as Diagonsis-heart_Disease is Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemia .Here we observed that accuracy, specificity, and sensitivity are good in their scores. The predictions on test data with this model are very good compared to any other logistic models.</p>
</section>
<section id="references" class="level1">
<h1>References:</h1>
<p>1.EwR] Hanck, C., Arnold, M., Gerber, A. &amp; Schmelzer, M. (2021) Introduction to Econometrics with R. (https://www.econometrics-with-r.org/)</p>
<p>2.https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6616540/</p>
<p>3.LSR] Navarro, Danielle. Learning Statistics with R. (freely available at https://learningstatisticswithr.com/)</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Fall_2022" data-repo-id="R_kgDOH568kA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb129" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final project"</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Mani Kanta Gogula"</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Final project"</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/3/2022"</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - final</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Heart Disease Prediction</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - Mani Kanta Gogula</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Heart Disease in the United States:</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>Heart disease is the leading cause of death for men, women, and people of most racial and ethnic groups in the United States.One person dies every 34 seconds in the United States from cardiovascular disease.About 697,000 people in the United States died from heart disease in 2020—that’s 1 in every 5 deaths.Heart disease cost the United States about $229 billion each year from 2017 to 2018.3 This includes the cost of health care services, medicines, and lost productivity due to death.</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>Coronary heart disease is the most common type of heart disease, killing 382,820 people in 2020.</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>About 20.1 million adults age 20 and older have CAD (about 7.2%).In 2020, about 2 in 10 deaths from CAD happen in adults less than 65 years old.Early Action Is Important for Heart Attack</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>Know the warning signs and symptoms of a heart attack.</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>In the United States, someone has a heart attack every 40 seconds.2</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>Every year, about 805,000 people in the United States have a heart attack.Of these,</span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>605,000 are a first heart attack</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>200,000 happen to people who have already had a heart attack</span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>About 1 in 5 heart attacks are silent—the damage is done, but the person is not aware of it.</span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research :</span></span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Examining the relationship between maximum heart rate one can achieve during excercise and likelihood of developing heart disease .</span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Using Multiple logistic regression confounding effects of age and gender.</span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a><span class="fu"># Loading Required Libraries and Reading the Dataset</span></span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"heart_cleveland_upload.csv"</span>)</span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_disease_dataset)</span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a><span class="fu"># Variable Description</span></span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a>There are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:</span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>Age: Age of subject</span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a>Sex: Gender of subject:</span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a>0 = female 1 = male</span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a>Chest-pain type: Type of chest-pain experienced by the individual:</span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a>1 = typical angina</span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a>2 = atypical angina</span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a>3 = non-angina pain</span>
<span id="cb129-73"><a href="#cb129-73" aria-hidden="true" tabindex="-1"></a>4 = asymptomatic angina</span>
<span id="cb129-74"><a href="#cb129-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a>Resting Blood Pressure: Resting blood pressure in mm Hg</span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a>Serum Cholesterol: Serum cholesterol in mg/dl</span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a>Fasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar &lt;= 120 mg/dl</span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a>1 = fasting blood sugar &gt; 120 mg/dl</span>
<span id="cb129-81"><a href="#cb129-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-82"><a href="#cb129-82" aria-hidden="true" tabindex="-1"></a>Resting ECG: Resting electrocardiographic results</span>
<span id="cb129-83"><a href="#cb129-83" aria-hidden="true" tabindex="-1"></a>0 = normal</span>
<span id="cb129-84"><a href="#cb129-84" aria-hidden="true" tabindex="-1"></a>1 = ST-T wave abnormality</span>
<span id="cb129-85"><a href="#cb129-85" aria-hidden="true" tabindex="-1"></a>2 = left ventricle hyperthrophy</span>
<span id="cb129-86"><a href="#cb129-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-87"><a href="#cb129-87" aria-hidden="true" tabindex="-1"></a>Max Heart Rate Achieved: Max heart rate of subject</span>
<span id="cb129-88"><a href="#cb129-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-89"><a href="#cb129-89" aria-hidden="true" tabindex="-1"></a>Exercise Induced Angina:</span>
<span id="cb129-90"><a href="#cb129-90" aria-hidden="true" tabindex="-1"></a>0 = no 1 = yes</span>
<span id="cb129-91"><a href="#cb129-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-92"><a href="#cb129-92" aria-hidden="true" tabindex="-1"></a>ST Depression Induced by Exercise Relative to Rest: ST Depression of subject</span>
<span id="cb129-93"><a href="#cb129-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-94"><a href="#cb129-94" aria-hidden="true" tabindex="-1"></a>Peak Exercise ST Segment:</span>
<span id="cb129-95"><a href="#cb129-95" aria-hidden="true" tabindex="-1"></a>1 = Up-sloaping</span>
<span id="cb129-96"><a href="#cb129-96" aria-hidden="true" tabindex="-1"></a>2 = Flat</span>
<span id="cb129-97"><a href="#cb129-97" aria-hidden="true" tabindex="-1"></a>3 = Down-sloaping</span>
<span id="cb129-98"><a href="#cb129-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-99"><a href="#cb129-99" aria-hidden="true" tabindex="-1"></a>Number of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro</span>
<span id="cb129-100"><a href="#cb129-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-101"><a href="#cb129-101" aria-hidden="true" tabindex="-1"></a>Thal: Form of thalassemia: 3</span>
<span id="cb129-102"><a href="#cb129-102" aria-hidden="true" tabindex="-1"></a>3 = normal</span>
<span id="cb129-103"><a href="#cb129-103" aria-hidden="true" tabindex="-1"></a>6 = fixed defect</span>
<span id="cb129-104"><a href="#cb129-104" aria-hidden="true" tabindex="-1"></a>7 = reversible defect</span>
<span id="cb129-105"><a href="#cb129-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-106"><a href="#cb129-106" aria-hidden="true" tabindex="-1"></a>Diagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not:</span>
<span id="cb129-107"><a href="#cb129-107" aria-hidden="true" tabindex="-1"></a>0 = absence</span>
<span id="cb129-108"><a href="#cb129-108" aria-hidden="true" tabindex="-1"></a>1 = heart disease present</span>
<span id="cb129-109"><a href="#cb129-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-110"><a href="#cb129-110" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis</span></span>
<span id="cb129-111"><a href="#cb129-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-112"><a href="#cb129-112" aria-hidden="true" tabindex="-1"></a>The aging and elderly population are particularly susceptible to cardiovascular disease. Age is an independent risk factor for cardiovascular disease (CVD) in adults, but these risks are compounded by additional factors, including frailty, obesity, and diabetes. These factors are known to complicate and enhance cardiac risk factors that are associated with the onset of advanced age. Sex is another potential risk factor in aging adults, given that older females are reported to be at a greater risk for CVD than age-matched men. However, in both men and women, the risks associated with CVD increase with age, and these correspond to an overall decline in sex hormones, primarily of estrogen and testosterone. Despite this, hormone replacement therapies are largely shown to not improve outcomes in older patients and may also increase the risks of cardiac events in older adults. My Hypothesis for this project based on a reserach article. </span>
<span id="cb129-113"><a href="#cb129-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-114"><a href="#cb129-114" aria-hidden="true" tabindex="-1"></a> Does Sex/Gender Have an effect?</span>
<span id="cb129-115"><a href="#cb129-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-116"><a href="#cb129-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-117"><a href="#cb129-117" aria-hidden="true" tabindex="-1"></a><span class="fu"># Renaming the columns</span></span>
<span id="cb129-118"><a href="#cb129-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-121"><a href="#cb129-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-122"><a href="#cb129-122" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Age"</span>,</span>
<span id="cb129-123"><a href="#cb129-123" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sex"</span>,</span>
<span id="cb129-124"><a href="#cb129-124" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Chest_Pain_Type"</span>,</span>
<span id="cb129-125"><a href="#cb129-125" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Resting_Blood_Pressure"</span>,</span>
<span id="cb129-126"><a href="#cb129-126" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Serum_Cholesterol"</span>,</span>
<span id="cb129-127"><a href="#cb129-127" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Fasting_Blood_Sugar"</span>,</span>
<span id="cb129-128"><a href="#cb129-128" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Resting_ECG"</span>,</span>
<span id="cb129-129"><a href="#cb129-129" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Max_Heart_Rate_Achieved"</span>,</span>
<span id="cb129-130"><a href="#cb129-130" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Exercise_Induced_Angina"</span>,</span>
<span id="cb129-131"><a href="#cb129-131" aria-hidden="true" tabindex="-1"></a>           <span class="st">"ST_Depression_Exercise"</span>,</span>
<span id="cb129-132"><a href="#cb129-132" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Peak_Exercise_ST_Segment"</span>,</span>
<span id="cb129-133"><a href="#cb129-133" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Num_Major_Vessels_Flouro"</span>,</span>
<span id="cb129-134"><a href="#cb129-134" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Thalassemia"</span>,</span>
<span id="cb129-135"><a href="#cb129-135" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Diagnosis_Heart_Disease"</span>)</span>
<span id="cb129-136"><a href="#cb129-136" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply column names to the dataframe</span></span>
<span id="cb129-137"><a href="#cb129-137" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(heart_disease_dataset) <span class="ot">&lt;-</span> names</span>
<span id="cb129-138"><a href="#cb129-138" aria-hidden="true" tabindex="-1"></a><span class="co">#Glimpse data to verify new column names are in place</span></span>
<span id="cb129-139"><a href="#cb129-139" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_disease_dataset)</span>
<span id="cb129-140"><a href="#cb129-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-141"><a href="#cb129-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-142"><a href="#cb129-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-143"><a href="#cb129-143" aria-hidden="true" tabindex="-1"></a><span class="fu"># Variable Description</span></span>
<span id="cb129-144"><a href="#cb129-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-145"><a href="#cb129-145" aria-hidden="true" tabindex="-1"></a> There are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:</span>
<span id="cb129-146"><a href="#cb129-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-147"><a href="#cb129-147" aria-hidden="true" tabindex="-1"></a>Age: Age of subject</span>
<span id="cb129-148"><a href="#cb129-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-149"><a href="#cb129-149" aria-hidden="true" tabindex="-1"></a>Sex: Gender of subject:</span>
<span id="cb129-150"><a href="#cb129-150" aria-hidden="true" tabindex="-1"></a>0 = female 1 = male</span>
<span id="cb129-151"><a href="#cb129-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-152"><a href="#cb129-152" aria-hidden="true" tabindex="-1"></a>Chest-pain type: Type of chest-pain experienced by the individual:</span>
<span id="cb129-153"><a href="#cb129-153" aria-hidden="true" tabindex="-1"></a>1 = typical angina</span>
<span id="cb129-154"><a href="#cb129-154" aria-hidden="true" tabindex="-1"></a>2 = atypical angina</span>
<span id="cb129-155"><a href="#cb129-155" aria-hidden="true" tabindex="-1"></a>3 = non-angina pain</span>
<span id="cb129-156"><a href="#cb129-156" aria-hidden="true" tabindex="-1"></a>4 = asymptomatic angina</span>
<span id="cb129-157"><a href="#cb129-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-158"><a href="#cb129-158" aria-hidden="true" tabindex="-1"></a>Resting Blood Pressure: Resting blood pressure in mm Hg</span>
<span id="cb129-159"><a href="#cb129-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-160"><a href="#cb129-160" aria-hidden="true" tabindex="-1"></a>Serum Cholesterol: Serum cholesterol in mg/dl</span>
<span id="cb129-161"><a href="#cb129-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-162"><a href="#cb129-162" aria-hidden="true" tabindex="-1"></a>Fasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar &lt;= 120 mg/dl</span>
<span id="cb129-163"><a href="#cb129-163" aria-hidden="true" tabindex="-1"></a>1 = fasting blood sugar &gt; 120 mg/dl</span>
<span id="cb129-164"><a href="#cb129-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-165"><a href="#cb129-165" aria-hidden="true" tabindex="-1"></a>Resting ECG: Resting electrocardiographic results</span>
<span id="cb129-166"><a href="#cb129-166" aria-hidden="true" tabindex="-1"></a>0 = normal</span>
<span id="cb129-167"><a href="#cb129-167" aria-hidden="true" tabindex="-1"></a>1 = ST-T wave abnormality</span>
<span id="cb129-168"><a href="#cb129-168" aria-hidden="true" tabindex="-1"></a>2 = left ventricle hyperthrophy</span>
<span id="cb129-169"><a href="#cb129-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-170"><a href="#cb129-170" aria-hidden="true" tabindex="-1"></a>Max Heart Rate Achieved: Max heart rate of subject</span>
<span id="cb129-171"><a href="#cb129-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-172"><a href="#cb129-172" aria-hidden="true" tabindex="-1"></a>Exercise Induced Angina:</span>
<span id="cb129-173"><a href="#cb129-173" aria-hidden="true" tabindex="-1"></a>0 = no 1 = yes</span>
<span id="cb129-174"><a href="#cb129-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-175"><a href="#cb129-175" aria-hidden="true" tabindex="-1"></a>ST Depression Induced by Exercise Relative to Rest: ST Depression of subject</span>
<span id="cb129-176"><a href="#cb129-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-177"><a href="#cb129-177" aria-hidden="true" tabindex="-1"></a>Peak Exercise ST Segment:</span>
<span id="cb129-178"><a href="#cb129-178" aria-hidden="true" tabindex="-1"></a>1 = Up-sloaping</span>
<span id="cb129-179"><a href="#cb129-179" aria-hidden="true" tabindex="-1"></a>2 = Flat</span>
<span id="cb129-180"><a href="#cb129-180" aria-hidden="true" tabindex="-1"></a>3 = Down-sloaping</span>
<span id="cb129-181"><a href="#cb129-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-182"><a href="#cb129-182" aria-hidden="true" tabindex="-1"></a>Number of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro</span>
<span id="cb129-183"><a href="#cb129-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-184"><a href="#cb129-184" aria-hidden="true" tabindex="-1"></a>Thal: Form of thalassemia: 3</span>
<span id="cb129-185"><a href="#cb129-185" aria-hidden="true" tabindex="-1"></a>3 = normal</span>
<span id="cb129-186"><a href="#cb129-186" aria-hidden="true" tabindex="-1"></a>6 = fixed defect</span>
<span id="cb129-187"><a href="#cb129-187" aria-hidden="true" tabindex="-1"></a>7 = reversible defect</span>
<span id="cb129-188"><a href="#cb129-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-189"><a href="#cb129-189" aria-hidden="true" tabindex="-1"></a>Diagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not:</span>
<span id="cb129-190"><a href="#cb129-190" aria-hidden="true" tabindex="-1"></a>0 = absence</span>
<span id="cb129-191"><a href="#cb129-191" aria-hidden="true" tabindex="-1"></a>1 = heart disease present</span>
<span id="cb129-192"><a href="#cb129-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-193"><a href="#cb129-193" aria-hidden="true" tabindex="-1"></a><span class="fu"># Reading the Dataset</span></span>
<span id="cb129-194"><a href="#cb129-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-197"><a href="#cb129-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-198"><a href="#cb129-198" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heart_disease_dataset)</span>
<span id="cb129-199"><a href="#cb129-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-200"><a href="#cb129-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-201"><a href="#cb129-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-204"><a href="#cb129-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-205"><a href="#cb129-205" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(heart_disease_dataset)</span>
<span id="cb129-206"><a href="#cb129-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-207"><a href="#cb129-207" aria-hidden="true" tabindex="-1"></a><span class="fu"># Structure of the dataset</span></span>
<span id="cb129-208"><a href="#cb129-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-211"><a href="#cb129-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-212"><a href="#cb129-212" aria-hidden="true" tabindex="-1"></a><span class="co">#structure of the dataset</span></span>
<span id="cb129-213"><a href="#cb129-213" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(heart_disease_dataset)</span>
<span id="cb129-214"><a href="#cb129-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-215"><a href="#cb129-215" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Summary</span></span>
<span id="cb129-216"><a href="#cb129-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-219"><a href="#cb129-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-220"><a href="#cb129-220" aria-hidden="true" tabindex="-1"></a><span class="co">#summary of the dataset</span></span>
<span id="cb129-221"><a href="#cb129-221" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_disease_dataset)</span>
<span id="cb129-222"><a href="#cb129-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-223"><a href="#cb129-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-224"><a href="#cb129-224" aria-hidden="true" tabindex="-1"></a><span class="fu"># Dimension of the Data</span></span>
<span id="cb129-225"><a href="#cb129-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-228"><a href="#cb129-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-229"><a href="#cb129-229" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(heart_disease_dataset)</span>
<span id="cb129-230"><a href="#cb129-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-231"><a href="#cb129-231" aria-hidden="true" tabindex="-1"></a><span class="fu"># Glimpse of the Dataset</span></span>
<span id="cb129-232"><a href="#cb129-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-235"><a href="#cb129-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-236"><a href="#cb129-236" aria-hidden="true" tabindex="-1"></a><span class="co">#glimpse of the dataset</span></span>
<span id="cb129-237"><a href="#cb129-237" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(heart_disease_dataset)</span>
<span id="cb129-238"><a href="#cb129-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-239"><a href="#cb129-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-240"><a href="#cb129-240" aria-hidden="true" tabindex="-1"></a>I also want to know the number of observations in the dependent variable column to understand if the dataset is relatively balanced.</span>
<span id="cb129-241"><a href="#cb129-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-242"><a href="#cb129-242" aria-hidden="true" tabindex="-1"></a>To know this factor , I have removed null values if there is any in the dataset and have counted the Dependent variable Diagnosis_Heart_Disease .</span>
<span id="cb129-243"><a href="#cb129-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-244"><a href="#cb129-244" aria-hidden="true" tabindex="-1"></a><span class="fu"># Counting outcome variable </span></span>
<span id="cb129-245"><a href="#cb129-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-248"><a href="#cb129-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-249"><a href="#cb129-249" aria-hidden="true" tabindex="-1"></a><span class="co">#Determine the number of values in each level of dependent variable</span></span>
<span id="cb129-250"><a href="#cb129-250" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb129-251"><a href="#cb129-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-252"><a href="#cb129-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span></span>
<span id="cb129-253"><a href="#cb129-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb129-254"><a href="#cb129-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-255"><a href="#cb129-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"full_width"</span> <span class="ot">=</span> F)</span>
<span id="cb129-256"><a href="#cb129-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-257"><a href="#cb129-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-258"><a href="#cb129-258" aria-hidden="true" tabindex="-1"></a>By above result we can state that that there is no huge difference in the dependent variable of the dataset . Since the value 0 in the above result states that there is a no presence of heart disease and the value 1 states that patient is diagnoised with the heart disease.</span>
<span id="cb129-259"><a href="#cb129-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-260"><a href="#cb129-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-261"><a href="#cb129-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-264"><a href="#cb129-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-265"><a href="#cb129-265" aria-hidden="true" tabindex="-1"></a><span class="co">#Identify the different levels of Thalassemia</span></span>
<span id="cb129-266"><a href="#cb129-266" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb129-267"><a href="#cb129-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-268"><a href="#cb129-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Thalassemia) <span class="sc">%&gt;%</span></span>
<span id="cb129-269"><a href="#cb129-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb129-270"><a href="#cb129-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-271"><a href="#cb129-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="fu">rep</span>(<span class="st">"c"</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="st">"full_width"</span> <span class="ot">=</span> F)</span>
<span id="cb129-272"><a href="#cb129-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-273"><a href="#cb129-273" aria-hidden="true" tabindex="-1"></a><span class="fu"># Removing Null values and Inapporpriate Data</span></span>
<span id="cb129-274"><a href="#cb129-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-275"><a href="#cb129-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-278"><a href="#cb129-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-279"><a href="#cb129-279" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop NA's, convert to factors, lump target variable to 2 levels, remove "?", reorder variables</span></span>
<span id="cb129-280"><a href="#cb129-280" aria-hidden="true" tabindex="-1"></a>heart_dataset_clean_tbl <span class="ot">&lt;-</span> heart_disease_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb129-281"><a href="#cb129-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-282"><a href="#cb129-282" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"Resting_ECG"</span>, </span>
<span id="cb129-283"><a href="#cb129-283" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Fasting_Blood_Sugar"</span>, </span>
<span id="cb129-284"><a href="#cb129-284" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Sex"</span>, </span>
<span id="cb129-285"><a href="#cb129-285" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Diagnosis_Heart_Disease"</span>, </span>
<span id="cb129-286"><a href="#cb129-286" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Exercise_Induced_Angina"</span>,</span>
<span id="cb129-287"><a href="#cb129-287" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Peak_Exercise_ST_Segment"</span>, </span>
<span id="cb129-288"><a href="#cb129-288" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Chest_Pain_Type"</span>), as_factor) <span class="sc">%&gt;%</span></span>
<span id="cb129-289"><a href="#cb129-289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Num_Major_Vessels_Flouro =</span> <span class="fu">as.numeric</span>(Num_Major_Vessels_Flouro)) <span class="sc">%&gt;%</span></span>
<span id="cb129-290"><a href="#cb129-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Diagnosis_Heart_Disease =</span> <span class="fu">fct_lump</span>(Diagnosis_Heart_Disease, <span class="at">other_level =</span> <span class="st">"1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-291"><a href="#cb129-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Thalassemia <span class="sc">!=</span> <span class="st">"?"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-292"><a href="#cb129-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Age, </span>
<span id="cb129-293"><a href="#cb129-293" aria-hidden="true" tabindex="-1"></a>           Resting_Blood_Pressure, </span>
<span id="cb129-294"><a href="#cb129-294" aria-hidden="true" tabindex="-1"></a>           Serum_Cholesterol, </span>
<span id="cb129-295"><a href="#cb129-295" aria-hidden="true" tabindex="-1"></a>           Max_Heart_Rate_Achieved, </span>
<span id="cb129-296"><a href="#cb129-296" aria-hidden="true" tabindex="-1"></a>           ST_Depression_Exercise,</span>
<span id="cb129-297"><a href="#cb129-297" aria-hidden="true" tabindex="-1"></a>           Num_Major_Vessels_Flouro,</span>
<span id="cb129-298"><a href="#cb129-298" aria-hidden="true" tabindex="-1"></a>           <span class="fu">everything</span>())</span>
<span id="cb129-299"><a href="#cb129-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-300"><a href="#cb129-300" aria-hidden="true" tabindex="-1"></a><span class="co">#Glimpse data</span></span>
<span id="cb129-301"><a href="#cb129-301" aria-hidden="true" tabindex="-1"></a>heart_dataset_clean_tbl <span class="sc">%&gt;%</span></span>
<span id="cb129-302"><a href="#cb129-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span>
<span id="cb129-303"><a href="#cb129-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-304"><a href="#cb129-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-305"><a href="#cb129-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-306"><a href="#cb129-306" aria-hidden="true" tabindex="-1"></a><span class="fu"># Recoding the variables based on Data </span></span>
<span id="cb129-307"><a href="#cb129-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-310"><a href="#cb129-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-311"><a href="#cb129-311" aria-hidden="true" tabindex="-1"></a><span class="co">#Select categorical vars, recode them to their character values, convert to long format</span></span>
<span id="cb129-312"><a href="#cb129-312" aria-hidden="true" tabindex="-1"></a>hd_long_fact_tbl <span class="ot">&lt;-</span> heart_dataset_clean_tbl  <span class="sc">%&gt;%</span></span>
<span id="cb129-313"><a href="#cb129-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex,</span>
<span id="cb129-314"><a href="#cb129-314" aria-hidden="true" tabindex="-1"></a>         Chest_Pain_Type,</span>
<span id="cb129-315"><a href="#cb129-315" aria-hidden="true" tabindex="-1"></a>         Fasting_Blood_Sugar,</span>
<span id="cb129-316"><a href="#cb129-316" aria-hidden="true" tabindex="-1"></a>         Resting_ECG,</span>
<span id="cb129-317"><a href="#cb129-317" aria-hidden="true" tabindex="-1"></a>         Exercise_Induced_Angina,</span>
<span id="cb129-318"><a href="#cb129-318" aria-hidden="true" tabindex="-1"></a>         Peak_Exercise_ST_Segment,</span>
<span id="cb129-319"><a href="#cb129-319" aria-hidden="true" tabindex="-1"></a>         Thalassemia,</span>
<span id="cb129-320"><a href="#cb129-320" aria-hidden="true" tabindex="-1"></a>         Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span></span>
<span id="cb129-321"><a href="#cb129-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">recode_factor</span>(Sex, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"female"</span>, </span>
<span id="cb129-322"><a href="#cb129-322" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"male"</span> ),</span>
<span id="cb129-323"><a href="#cb129-323" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chest_Pain_Type =</span> <span class="fu">recode_factor</span>(Chest_Pain_Type, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"typical"</span>,   </span>
<span id="cb129-324"><a href="#cb129-324" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"atypical"</span>,</span>
<span id="cb129-325"><a href="#cb129-325" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"non-angina"</span>, </span>
<span id="cb129-326"><a href="#cb129-326" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"asymptomatic"</span>),</span>
<span id="cb129-327"><a href="#cb129-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">Fasting_Blood_Sugar =</span> <span class="fu">recode_factor</span>(Fasting_Blood_Sugar, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"&lt;= 120 mg/dl"</span>, </span>
<span id="cb129-328"><a href="#cb129-328" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"&gt; 120 mg/dl"</span>),</span>
<span id="cb129-329"><a href="#cb129-329" aria-hidden="true" tabindex="-1"></a>         <span class="at">Resting_ECG =</span> <span class="fu">recode_factor</span>(Resting_ECG, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"normal"</span>,</span>
<span id="cb129-330"><a href="#cb129-330" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"ST-T abnormality"</span>,</span>
<span id="cb129-331"><a href="#cb129-331" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"LV hypertrophy"</span>),</span>
<span id="cb129-332"><a href="#cb129-332" aria-hidden="true" tabindex="-1"></a>         <span class="at">Exercise_Induced_Angina =</span> <span class="fu">recode_factor</span>(Exercise_Induced_Angina, <span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"no"</span>,</span>
<span id="cb129-333"><a href="#cb129-333" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"yes"</span>),</span>
<span id="cb129-334"><a href="#cb129-334" aria-hidden="true" tabindex="-1"></a>         <span class="at">Peak_Exercise_ST_Segment =</span> <span class="fu">recode_factor</span>(Peak_Exercise_ST_Segment, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"up-sloaping"</span>,</span>
<span id="cb129-335"><a href="#cb129-335" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"flat"</span>,</span>
<span id="cb129-336"><a href="#cb129-336" aria-hidden="true" tabindex="-1"></a>                                                                            <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"down-sloaping"</span>),</span>
<span id="cb129-337"><a href="#cb129-337" aria-hidden="true" tabindex="-1"></a>         <span class="at">Thalassemia =</span> <span class="fu">recode_factor</span>(Thalassemia, <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"normal"</span>,</span>
<span id="cb129-338"><a href="#cb129-338" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">6</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"fixed defect"</span>,</span>
<span id="cb129-339"><a href="#cb129-339" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">`</span><span class="at">7</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"reversible defect"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb129-340"><a href="#cb129-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"value"</span>, <span class="sc">-</span>Diagnosis_Heart_Disease)</span>
<span id="cb129-341"><a href="#cb129-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-342"><a href="#cb129-342" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualize with bar plot</span></span>
<span id="cb129-343"><a href="#cb129-343" aria-hidden="true" tabindex="-1"></a>hd_long_fact_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb129-344"><a href="#cb129-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value)) <span class="sc">+</span></span>
<span id="cb129-345"><a href="#cb129-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x        =</span> value, </span>
<span id="cb129-346"><a href="#cb129-346" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill     =</span> Diagnosis_Heart_Disease), </span>
<span id="cb129-347"><a href="#cb129-347" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha    =</span> .<span class="dv">6</span>, </span>
<span id="cb129-348"><a href="#cb129-348" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">"dodge"</span>, </span>
<span id="cb129-349"><a href="#cb129-349" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color    =</span> <span class="st">"black"</span>,</span>
<span id="cb129-350"><a href="#cb129-350" aria-hidden="true" tabindex="-1"></a>                 <span class="at">width    =</span> .<span class="dv">8</span></span>
<span id="cb129-351"><a href="#cb129-351" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb129-352"><a href="#cb129-352" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb129-353"><a href="#cb129-353" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb129-354"><a href="#cb129-354" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Scaled Effect of Categorical Variables"</span>) <span class="sc">+</span></span>
<span id="cb129-355"><a href="#cb129-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb129-356"><a href="#cb129-356" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb129-357"><a href="#cb129-357" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-358"><a href="#cb129-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb129-359"><a href="#cb129-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb129-360"><a href="#cb129-360" aria-hidden="true" tabindex="-1"></a>         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fde725ff"</span>, <span class="st">"#20a486ff"</span>),</span>
<span id="cb129-361"><a href="#cb129-361" aria-hidden="true" tabindex="-1"></a>         <span class="at">name   =</span> <span class="st">"Heart</span><span class="sc">\n</span><span class="st">Disease"</span>,</span>
<span id="cb129-362"><a href="#cb129-362" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No HD"</span>, <span class="st">"Yes HD"</span>))</span>
<span id="cb129-363"><a href="#cb129-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-364"><a href="#cb129-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-367"><a href="#cb129-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-368"><a href="#cb129-368" aria-hidden="true" tabindex="-1"></a><span class="co">#Must gather() data first in order to facet wrap by key </span></span>
<span id="cb129-369"><a href="#cb129-369" aria-hidden="true" tabindex="-1"></a><span class="co">#(default gather call puts all var names into new key col)</span></span>
<span id="cb129-370"><a href="#cb129-370" aria-hidden="true" tabindex="-1"></a>hd_long_cont_tbl <span class="ot">&lt;-</span> heart_dataset_clean_tbl  <span class="sc">%&gt;%</span></span>
<span id="cb129-371"><a href="#cb129-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age,</span>
<span id="cb129-372"><a href="#cb129-372" aria-hidden="true" tabindex="-1"></a>         Resting_Blood_Pressure,</span>
<span id="cb129-373"><a href="#cb129-373" aria-hidden="true" tabindex="-1"></a>         Serum_Cholesterol,</span>
<span id="cb129-374"><a href="#cb129-374" aria-hidden="true" tabindex="-1"></a>         Max_Heart_Rate_Achieved,</span>
<span id="cb129-375"><a href="#cb129-375" aria-hidden="true" tabindex="-1"></a>         ST_Depression_Exercise,</span>
<span id="cb129-376"><a href="#cb129-376" aria-hidden="true" tabindex="-1"></a>         Num_Major_Vessels_Flouro,</span>
<span id="cb129-377"><a href="#cb129-377" aria-hidden="true" tabindex="-1"></a>         Diagnosis_Heart_Disease) <span class="sc">%&gt;%</span> </span>
<span id="cb129-378"><a href="#cb129-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key   =</span> <span class="st">"key"</span>, </span>
<span id="cb129-379"><a href="#cb129-379" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> <span class="st">"value"</span>,</span>
<span id="cb129-380"><a href="#cb129-380" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span>Diagnosis_Heart_Disease)</span>
<span id="cb129-381"><a href="#cb129-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-382"><a href="#cb129-382" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualize numeric variables as boxplots</span></span>
<span id="cb129-383"><a href="#cb129-383" aria-hidden="true" tabindex="-1"></a>hd_long_cont_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb129-384"><a href="#cb129-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb129-385"><a href="#cb129-385" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Diagnosis_Heart_Disease),</span>
<span id="cb129-386"><a href="#cb129-386" aria-hidden="true" tabindex="-1"></a>                      <span class="at">alpha  =</span> .<span class="dv">6</span>,</span>
<span id="cb129-387"><a href="#cb129-387" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fatten =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb129-388"><a href="#cb129-388" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb129-389"><a href="#cb129-389" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb129-390"><a href="#cb129-390" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="st">"Boxplots for Numeric Variables"</span>) <span class="sc">+</span></span>
<span id="cb129-391"><a href="#cb129-391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(</span>
<span id="cb129-392"><a href="#cb129-392" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#fde725ff"</span>, <span class="st">"#20a486ff"</span>),</span>
<span id="cb129-393"><a href="#cb129-393" aria-hidden="true" tabindex="-1"></a>            <span class="at">name   =</span> <span class="st">"Heart</span><span class="sc">\n</span><span class="st">Disease"</span>,</span>
<span id="cb129-394"><a href="#cb129-394" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"No HD"</span>, <span class="st">"Yes HD"</span>)) <span class="sc">+</span></span>
<span id="cb129-395"><a href="#cb129-395" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb129-396"><a href="#cb129-396" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb129-397"><a href="#cb129-397" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb129-398"><a href="#cb129-398" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> key, </span>
<span id="cb129-399"><a href="#cb129-399" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">"free"</span>, </span>
<span id="cb129-400"><a href="#cb129-400" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol   =</span> <span class="dv">2</span>) </span>
<span id="cb129-401"><a href="#cb129-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-402"><a href="#cb129-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-403"><a href="#cb129-403" aria-hidden="true" tabindex="-1"></a>The faceted plots for categorical and numeric variables suggest the following conditions are associated with increased prevalence of heart disease (note: this does not mean the relationship is causal).</span>
<span id="cb129-404"><a href="#cb129-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-405"><a href="#cb129-405" aria-hidden="true" tabindex="-1"></a>Asymptomatic angina chest pain (relative to typical angina chest pain, atypical angina pain, or non-angina pain)</span>
<span id="cb129-406"><a href="#cb129-406" aria-hidden="true" tabindex="-1"></a>Presence of exercise induced angina</span>
<span id="cb129-407"><a href="#cb129-407" aria-hidden="true" tabindex="-1"></a>Lower fasting blood sugar</span>
<span id="cb129-408"><a href="#cb129-408" aria-hidden="true" tabindex="-1"></a>Flat or down-sloaping peak exercise ST segment</span>
<span id="cb129-409"><a href="#cb129-409" aria-hidden="true" tabindex="-1"></a>Presence of left ventricle hypertrophy</span>
<span id="cb129-410"><a href="#cb129-410" aria-hidden="true" tabindex="-1"></a>Male</span>
<span id="cb129-411"><a href="#cb129-411" aria-hidden="true" tabindex="-1"></a>Higher thelassemia score</span>
<span id="cb129-412"><a href="#cb129-412" aria-hidden="true" tabindex="-1"></a>Higher age</span>
<span id="cb129-413"><a href="#cb129-413" aria-hidden="true" tabindex="-1"></a>Lower max heart rate achieved</span>
<span id="cb129-414"><a href="#cb129-414" aria-hidden="true" tabindex="-1"></a>Higher resting blood pressure</span>
<span id="cb129-415"><a href="#cb129-415" aria-hidden="true" tabindex="-1"></a>Higher cholesterol</span>
<span id="cb129-416"><a href="#cb129-416" aria-hidden="true" tabindex="-1"></a>Higher ST depression induced by exercise relative to rest</span>
<span id="cb129-417"><a href="#cb129-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-418"><a href="#cb129-418" aria-hidden="true" tabindex="-1"></a>Age, blood pressure, cholesterol, and sex all point in the right direction based on what we generally know about the world around us. This provides a nice phase gate to let us proceed with the analysis.</span>
<span id="cb129-419"><a href="#cb129-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-420"><a href="#cb129-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-421"><a href="#cb129-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-424"><a href="#cb129-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-425"><a href="#cb129-425" aria-hidden="true" tabindex="-1"></a>age.plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(heart_disease_dataset, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">fill =</span> Diagnosis_Heart_Disease)) <span class="sc">+</span></span>
<span id="cb129-426"><a href="#cb129-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb129-427"><a href="#cb129-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Diagnosis_Heart_Disease)) <span class="sc">+</span></span>
<span id="cb129-428"><a href="#cb129-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Prevelance of Heart Disease Across Age"</span>, <span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>)</span>
<span id="cb129-429"><a href="#cb129-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-430"><a href="#cb129-430" aria-hidden="true" tabindex="-1"></a>age.plot</span>
<span id="cb129-431"><a href="#cb129-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-432"><a href="#cb129-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-433"><a href="#cb129-433" aria-hidden="true" tabindex="-1"></a>Highly correlated variables can lead to overly complicated models or wonky predictions. The ggcorr() function from GGally package provides a nice, clean correlation matrix of the numeric variables. The default method is Pearson which I use here first. Pearson isn’t ideal if the data is skewed or has a lot of outliers so I’ll check using the rank-based Kendall method as well.</span>
<span id="cb129-434"><a href="#cb129-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-435"><a href="#cb129-435" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correlation Analysis</span></span>
<span id="cb129-436"><a href="#cb129-436" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-437"><a href="#cb129-437" aria-hidden="true" tabindex="-1"></a>Correlation analysis allows us to obtain an understanding on relationship and direction between features. Example +0.8 indicates very strong positive relationship while 0 indicates no relationship.</span>
<span id="cb129-438"><a href="#cb129-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-439"><a href="#cb129-439" aria-hidden="true" tabindex="-1"></a>Two methods i.e. Pearson and Kendall are used for the correlation analysis in this study.</span>
<span id="cb129-440"><a href="#cb129-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-441"><a href="#cb129-441" aria-hidden="true" tabindex="-1"></a><span class="fu"># Correlation between the variables</span></span>
<span id="cb129-442"><a href="#cb129-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-443"><a href="#cb129-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-446"><a href="#cb129-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-447"><a href="#cb129-447" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb129-448"><a href="#cb129-448" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb129-449"><a href="#cb129-449" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb129-450"><a href="#cb129-450" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb129-451"><a href="#cb129-451" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix using Pearson method, default method is Pearson</span></span>
<span id="cb129-452"><a href="#cb129-452" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> <span class="fu">ggcorr</span>(<span class="at">high       =</span> <span class="st">"#20a486ff"</span>,</span>
<span id="cb129-453"><a href="#cb129-453" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">low        =</span> <span class="st">"#fde725ff"</span>,</span>
<span id="cb129-454"><a href="#cb129-454" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label      =</span> <span class="cn">TRUE</span>, </span>
<span id="cb129-455"><a href="#cb129-455" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust      =</span> <span class="fl">0.99</span>, </span>
<span id="cb129-456"><a href="#cb129-456" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size       =</span> <span class="dv">3</span>, </span>
<span id="cb129-457"><a href="#cb129-457" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label_size =</span> <span class="dv">3</span>,</span>
<span id="cb129-458"><a href="#cb129-458" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nbreaks    =</span> <span class="dv">5</span></span>
<span id="cb129-459"><a href="#cb129-459" aria-hidden="true" tabindex="-1"></a>                                              ) <span class="sc">+</span></span>
<span id="cb129-460"><a href="#cb129-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Matrix"</span>,</span>
<span id="cb129-461"><a href="#cb129-461" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Pearson Method Using Pairwise Obervations"</span>)</span>
<span id="cb129-462"><a href="#cb129-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-465"><a href="#cb129-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-466"><a href="#cb129-466" aria-hidden="true" tabindex="-1"></a><span class="co">#Correlation matrix using Kendall method</span></span>
<span id="cb129-467"><a href="#cb129-467" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset <span class="sc">%&gt;%</span> <span class="fu">ggcorr</span>(<span class="at">method     =</span> <span class="fu">c</span>(<span class="st">"pairwise"</span>, <span class="st">"kendall"</span>),</span>
<span id="cb129-468"><a href="#cb129-468" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">high       =</span> <span class="st">"#20a486ff"</span>,</span>
<span id="cb129-469"><a href="#cb129-469" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">low        =</span> <span class="st">"#fde725ff"</span>,</span>
<span id="cb129-470"><a href="#cb129-470" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label      =</span> <span class="cn">TRUE</span>, </span>
<span id="cb129-471"><a href="#cb129-471" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust      =</span> .<span class="dv">99</span>, </span>
<span id="cb129-472"><a href="#cb129-472" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size       =</span> <span class="dv">3</span>, </span>
<span id="cb129-473"><a href="#cb129-473" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">label_size =</span> <span class="dv">3</span>,</span>
<span id="cb129-474"><a href="#cb129-474" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nbreaks    =</span> <span class="dv">5</span></span>
<span id="cb129-475"><a href="#cb129-475" aria-hidden="true" tabindex="-1"></a>                                   ) <span class="sc">+</span></span>
<span id="cb129-476"><a href="#cb129-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Matrix"</span>,</span>
<span id="cb129-477"><a href="#cb129-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"Kendall Method Using Pairwise Observations"</span>)</span>
<span id="cb129-478"><a href="#cb129-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-479"><a href="#cb129-479" aria-hidden="true" tabindex="-1"></a>Based on Pearson and Kendall’s correlation result, the factors that showed correlation &gt;= 40% with the target feature are: Chest Pain type, Num of Major Vessels, Exercise Induced Angina, and ST Depression.</span>
<span id="cb129-480"><a href="#cb129-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-481"><a href="#cb129-481" aria-hidden="true" tabindex="-1"></a>There are very minor differences between the Pearson and Kendall results. No variables appear to be highly correlated (i.e. &gt; 50%) As such, it seems reasonable to keep all the original 14 variables as we proceed into the modeling section.Some additional steps can be used in the modelling stage to identify the statitically significant features</span>
<span id="cb129-482"><a href="#cb129-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-483"><a href="#cb129-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-484"><a href="#cb129-484" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regression Model</span></span>
<span id="cb129-485"><a href="#cb129-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-488"><a href="#cb129-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-489"><a href="#cb129-489" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> heart_disease_dataset, Diagnosis_Heart_Disease <span class="sc">~</span>.,)</span>
<span id="cb129-490"><a href="#cb129-490" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(linear_model)</span>
<span id="cb129-491"><a href="#cb129-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-492"><a href="#cb129-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-493"><a href="#cb129-493" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Evaluation and Dianostic Plots</span></span>
<span id="cb129-494"><a href="#cb129-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-497"><a href="#cb129-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-498"><a href="#cb129-498" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)); <span class="fu">plot</span>(linear_model, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb129-499"><a href="#cb129-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-500"><a href="#cb129-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-501"><a href="#cb129-501" aria-hidden="true" tabindex="-1"></a>According to the diagnostic plots, none of the models seem to fit super well. There are violations of assumptions in models. so I will be doing logistic regression to get a better model and check the accuracy.</span>
<span id="cb129-502"><a href="#cb129-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-503"><a href="#cb129-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-504"><a href="#cb129-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-505"><a href="#cb129-505" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modelling</span></span>
<span id="cb129-506"><a href="#cb129-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-507"><a href="#cb129-507" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Preparation For Modelling</span></span>
<span id="cb129-508"><a href="#cb129-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-509"><a href="#cb129-509" aria-hidden="true" tabindex="-1"></a>The plan is to split up the original data set to form a training group (70%) and testing group (30%). The training group will be used to fit the model while the testing group will be used to evaluate predictions. The initial_split() function creates a split object which is just an efficient way to store both the training and testing sets. The training() and testing() functions are used to extract the appropriate dataframes out of the split object when needed.</span>
<span id="cb129-510"><a href="#cb129-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-511"><a href="#cb129-511" aria-hidden="true" tabindex="-1"></a>Create Logistic Regression Model</span>
<span id="cb129-512"><a href="#cb129-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-513"><a href="#cb129-513" aria-hidden="true" tabindex="-1"></a>Logistic regression is a form of regression analysis. A binary logistic regression is used when the target feature is a dichotomy, having only two values, for example, 0 or 1, or Yes or No.  In this project, it is used to compute the prediction of the presence of heart disease. It can be used to predict what conditions that could likely cause the presence of heart disease.The R function glm(), for generalized linear model, can be used to compute logistic regression. We need to specify the option family = binomial, which tells to R that we want to fit logistic regression.</span>
<span id="cb129-514"><a href="#cb129-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-515"><a href="#cb129-515" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic Regression Assumptions</span></span>
<span id="cb129-516"><a href="#cb129-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-517"><a href="#cb129-517" aria-hidden="true" tabindex="-1"></a>The first assumption is that there is a linear relationship between continuous independent variables and the logit of the outcome variable.</span>
<span id="cb129-518"><a href="#cb129-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-519"><a href="#cb129-519" aria-hidden="true" tabindex="-1"></a>Independence of errors requires that there be no dependence between samples in the model, i.e. using the same individuals at different times.</span>
<span id="cb129-520"><a href="#cb129-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-521"><a href="#cb129-521" aria-hidden="true" tabindex="-1"></a>Multicollinearity refers to a relationship (correlation) between the independent variables and must be excluded from logistic regression models</span>
<span id="cb129-522"><a href="#cb129-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-523"><a href="#cb129-523" aria-hidden="true" tabindex="-1"></a><span class="fu"># Partitioning the Data</span></span>
<span id="cb129-524"><a href="#cb129-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-527"><a href="#cb129-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-528"><a href="#cb129-528" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb129-529"><a href="#cb129-529" aria-hidden="true" tabindex="-1"></a>trainDataIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease, <span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list =</span> F)  <span class="co"># 70% training data</span></span>
<span id="cb129-530"><a href="#cb129-530" aria-hidden="true" tabindex="-1"></a>trainData <span class="ot">&lt;-</span> heart_disease_dataset[trainDataIndex, ]</span>
<span id="cb129-531"><a href="#cb129-531" aria-hidden="true" tabindex="-1"></a>testData <span class="ot">&lt;-</span> heart_disease_dataset[<span class="sc">-</span>trainDataIndex, ]</span>
<span id="cb129-532"><a href="#cb129-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-533"><a href="#cb129-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-534"><a href="#cb129-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-535"><a href="#cb129-535" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple logistic regression</span></span>
<span id="cb129-536"><a href="#cb129-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-537"><a href="#cb129-537" aria-hidden="true" tabindex="-1"></a>The multiple logistic regression is used to predict the probability of class membership based on multiple predictor variables, as follow:</span>
<span id="cb129-538"><a href="#cb129-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-539"><a href="#cb129-539" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model 1</span></span>
<span id="cb129-540"><a href="#cb129-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-543"><a href="#cb129-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-544"><a href="#cb129-544" aria-hidden="true" tabindex="-1"></a><span class="co"># using glm function from base R and specify the family argument as binomial</span></span>
<span id="cb129-545"><a href="#cb129-545" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> heart_disease_dataset, Diagnosis_Heart_Disease <span class="sc">~</span>.,, <span class="at">family =</span> <span class="st">"binomial"</span> )</span>
<span id="cb129-546"><a href="#cb129-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-547"><a href="#cb129-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-548"><a href="#cb129-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-549"><a href="#cb129-549" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the model summary</span></span>
<span id="cb129-550"><a href="#cb129-550" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb129-551"><a href="#cb129-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-552"><a href="#cb129-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-553"><a href="#cb129-553" aria-hidden="true" tabindex="-1"></a>From the output above, the coefficients table shows the beta coefficient estimates and their significance levels. Columns are:</span>
<span id="cb129-554"><a href="#cb129-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-555"><a href="#cb129-555" aria-hidden="true" tabindex="-1"></a>Estimate: the intercept (b0) and the beta coefficient estimates associated to each predictor variable</span>
<span id="cb129-556"><a href="#cb129-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-557"><a href="#cb129-557" aria-hidden="true" tabindex="-1"></a>Std.Error: the standard error of the coefficient estimates. This represents the accuracy of the coefficients. The larger the standard error, the less confident we are about the estimate.</span>
<span id="cb129-558"><a href="#cb129-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-559"><a href="#cb129-559" aria-hidden="true" tabindex="-1"></a>z value: the z-statistic, which is the coefficient estimate (column 2) divided by the standard error of the estimate (column 3)</span>
<span id="cb129-560"><a href="#cb129-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-561"><a href="#cb129-561" aria-hidden="true" tabindex="-1"></a>Pr(&gt;|z|): The p-value corresponding to the z-statistic. The smaller the p-value, the more significant the estimate is.</span>
<span id="cb129-562"><a href="#cb129-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-563"><a href="#cb129-563" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hypothesis Evaluation</span></span>
<span id="cb129-564"><a href="#cb129-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-565"><a href="#cb129-565" aria-hidden="true" tabindex="-1"></a>We have a  p-value of less than 0.05 significance level. So we reject the null hypothesis and conclude that Sex and Diagnosis_Heart_disease have a significant relationship.</span>
<span id="cb129-566"><a href="#cb129-566" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-567"><a href="#cb129-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-568"><a href="#cb129-568" aria-hidden="true" tabindex="-1"></a><span class="fu"># Interpretation : </span></span>
<span id="cb129-569"><a href="#cb129-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-570"><a href="#cb129-570" aria-hidden="true" tabindex="-1"></a>It can be seen only sex, chest pain type, resting blood pressure, maximum heart rate reached during exercise, and exercise induced angina are significantly associated with the outcome.And the other variables like Age, serum cholesterol, and fasting blood sugar were found to be insignificant predictors of the outcome of the data i.e Diagnosis_heart_disease.</span>
<span id="cb129-571"><a href="#cb129-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-572"><a href="#cb129-572" aria-hidden="true" tabindex="-1"></a>The coefficient estimate of the variable Chest_Pain_Type is   0.578582, which is positive. This means that an increase in chest_Pain_Type is associated with increase in the probability of being heart disease. However the coefficient for the variable Fasting_Blood_Sugar is -0.991868, which is negative. This means that an increase in Fasting_Blood_Sugar will be associated with a decreased probability of being heart disease positive.Similarly the other variables like Thalassemia, which is positive with 0.714 that means that an increase in Thalassemia is associated with the increase in the probability of the heart disease.Variable Peak_Exercise_ST_Segment which is positive with 0.582699, and an increase in Peak_Exercise_ST_Segment is associated with the increase in the probabality of the heart disease.</span>
<span id="cb129-573"><a href="#cb129-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-574"><a href="#cb129-574" aria-hidden="true" tabindex="-1"></a>An important concept to understand, for interpreting the logistic beta coefficients, is the odds ratio. An odds ratio measures the association between a predictor variable (x) and the outcome variable (y). It represents the ratio of the odds that an event will occur (event = 1) given the presence of the predictor x (x = 1), compared to the odds of the event occurring in the absence of that predictor (x = 0).</span>
<span id="cb129-575"><a href="#cb129-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-576"><a href="#cb129-576" aria-hidden="true" tabindex="-1"></a>For a given predictor (say x1), the associated beta coefficient (b1) in the logistic regression function corresponds to the log of the odds ratio for that predictor.</span>
<span id="cb129-577"><a href="#cb129-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-578"><a href="#cb129-578" aria-hidden="true" tabindex="-1"></a>If the odds ratio is 2, then the odds that the event occurs (event = 1) are two times higher when the predictor x is present (x = 1) versus x is absent (x = 0).</span>
<span id="cb129-579"><a href="#cb129-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-580"><a href="#cb129-580" aria-hidden="true" tabindex="-1"></a>For example, the regression coefficient Chest_Pain_Type is   0.578582. This indicate that one unit increase in the Chest_Pain_Type concentration will increase the odds of heart disease by exp(0.57) 1.7 times.</span>
<span id="cb129-581"><a href="#cb129-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-582"><a href="#cb129-582" aria-hidden="true" tabindex="-1"></a>From the logistic regression results, it can be noticed that some variables - serum cholesterol, and fasting blood sugar and age - are not statistically significant. Keeping them in the model may contribute to overfitting. Therefore, they should be eliminated.</span>
<span id="cb129-583"><a href="#cb129-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-584"><a href="#cb129-584" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model 2</span></span>
<span id="cb129-585"><a href="#cb129-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-586"><a href="#cb129-586" aria-hidden="true" tabindex="-1"></a> So I'm running again the multiple logistic regression using significant variables and removing variables which are statistically not significant. Below is my second model with the variables which are significant. i.e Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi </span>
<span id="cb129-587"><a href="#cb129-587" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb129-588"><a href="#cb129-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-591"><a href="#cb129-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-592"><a href="#cb129-592" aria-hidden="true" tabindex="-1"></a>logitmod2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span> Chest_Pain_Type<span class="sc">+</span>Resting_Blood_Pressure<span class="sc">+</span>Exercise_Induced_Angina<span class="sc">+</span>Num_Major_Vessels_Flouro<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb129-593"><a href="#cb129-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-594"><a href="#cb129-594" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod2)</span>
<span id="cb129-595"><a href="#cb129-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-598"><a href="#cb129-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-599"><a href="#cb129-599" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb129-600"><a href="#cb129-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-601"><a href="#cb129-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb129-602"><a href="#cb129-602" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb129-603"><a href="#cb129-603" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb129-604"><a href="#cb129-604" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb129-605"><a href="#cb129-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-606"><a href="#cb129-606" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-607"><a href="#cb129-607" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb129-608"><a href="#cb129-608" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb129-609"><a href="#cb129-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-610"><a href="#cb129-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb129-611"><a href="#cb129-611" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span>
<span id="cb129-612"><a href="#cb129-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-613"><a href="#cb129-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-614"><a href="#cb129-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-615"><a href="#cb129-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-616"><a href="#cb129-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-619"><a href="#cb129-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-620"><a href="#cb129-620" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb129-621"><a href="#cb129-621" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb129-622"><a href="#cb129-622" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-623"><a href="#cb129-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-624"><a href="#cb129-624" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb129-625"><a href="#cb129-625" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-626"><a href="#cb129-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-627"><a href="#cb129-627" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb129-628"><a href="#cb129-628" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Resting_Blood_Pressure=</span><span class="dv">100</span>, <span class="at">Exercise_Induced_Angina=</span><span class="dv">2</span>, <span class="at">Thalassemia=</span><span class="dv">0</span>,<span class="at">Chest_Pain_Type=</span><span class="dv">0</span>, <span class="at">Num_Major_Vessels_Flouro=</span><span class="dv">4</span>)</span>
<span id="cb129-629"><a href="#cb129-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-630"><a href="#cb129-630" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb129-631"><a href="#cb129-631" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod2, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-632"><a href="#cb129-632" aria-hidden="true" tabindex="-1"></a>p_new</span>
<span id="cb129-633"><a href="#cb129-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-634"><a href="#cb129-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-637"><a href="#cb129-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-638"><a href="#cb129-638" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb129-639"><a href="#cb129-639" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb129-640"><a href="#cb129-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-641"><a href="#cb129-641" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, clasification error</span></span>
<span id="cb129-642"><a href="#cb129-642" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease) </span>
<span id="cb129-643"><a href="#cb129-643" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease)</span>
<span id="cb129-644"><a href="#cb129-644" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease) </span>
<span id="cb129-645"><a href="#cb129-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-646"><a href="#cb129-646" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb129-647"><a href="#cb129-647" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span>
<span id="cb129-648"><a href="#cb129-648" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span>
<span id="cb129-649"><a href="#cb129-649" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span>
<span id="cb129-650"><a href="#cb129-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-651"><a href="#cb129-651" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb129-652"><a href="#cb129-652" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span>
<span id="cb129-653"><a href="#cb129-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-654"><a href="#cb129-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-655"><a href="#cb129-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-658"><a href="#cb129-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-659"><a href="#cb129-659" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span>
<span id="cb129-660"><a href="#cb129-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-661"><a href="#cb129-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-662"><a href="#cb129-662" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model 3</span></span>
<span id="cb129-663"><a href="#cb129-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-664"><a href="#cb129-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-667"><a href="#cb129-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-668"><a href="#cb129-668" aria-hidden="true" tabindex="-1"></a>logitmod3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span> Chest_Pain_Type<span class="sc">+</span>Exercise_Induced_Angina<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb129-669"><a href="#cb129-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-670"><a href="#cb129-670" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod3)</span>
<span id="cb129-671"><a href="#cb129-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-672"><a href="#cb129-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-675"><a href="#cb129-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-676"><a href="#cb129-676" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb129-677"><a href="#cb129-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-678"><a href="#cb129-678" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb129-679"><a href="#cb129-679" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb129-680"><a href="#cb129-680" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb129-681"><a href="#cb129-681" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb129-682"><a href="#cb129-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-683"><a href="#cb129-683" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-684"><a href="#cb129-684" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb129-685"><a href="#cb129-685" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb129-686"><a href="#cb129-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-687"><a href="#cb129-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-688"><a href="#cb129-688" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb129-689"><a href="#cb129-689" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span>
<span id="cb129-690"><a href="#cb129-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-691"><a href="#cb129-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-694"><a href="#cb129-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-695"><a href="#cb129-695" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb129-696"><a href="#cb129-696" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb129-697"><a href="#cb129-697" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-698"><a href="#cb129-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-699"><a href="#cb129-699" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb129-700"><a href="#cb129-700" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-701"><a href="#cb129-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-702"><a href="#cb129-702" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb129-703"><a href="#cb129-703" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Exercise_Induced_Angina=</span><span class="dv">2</span>, <span class="at">Thalassemia=</span><span class="dv">0</span>,<span class="at">Chest_Pain_Type=</span><span class="dv">0</span>)</span>
<span id="cb129-704"><a href="#cb129-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-705"><a href="#cb129-705" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb129-706"><a href="#cb129-706" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod3, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-707"><a href="#cb129-707" aria-hidden="true" tabindex="-1"></a>p_new</span>
<span id="cb129-708"><a href="#cb129-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-709"><a href="#cb129-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-710"><a href="#cb129-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-711"><a href="#cb129-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-714"><a href="#cb129-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-715"><a href="#cb129-715" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb129-716"><a href="#cb129-716" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb129-717"><a href="#cb129-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-718"><a href="#cb129-718" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, classification error</span></span>
<span id="cb129-719"><a href="#cb129-719" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2) </span>
<span id="cb129-720"><a href="#cb129-720" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2)</span>
<span id="cb129-721"><a href="#cb129-721" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2) </span>
<span id="cb129-722"><a href="#cb129-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-723"><a href="#cb129-723" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb129-724"><a href="#cb129-724" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span>
<span id="cb129-725"><a href="#cb129-725" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span>
<span id="cb129-726"><a href="#cb129-726" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span>
<span id="cb129-727"><a href="#cb129-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-728"><a href="#cb129-728" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb129-729"><a href="#cb129-729" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span>
<span id="cb129-730"><a href="#cb129-730" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-731"><a href="#cb129-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-732"><a href="#cb129-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-735"><a href="#cb129-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-736"><a href="#cb129-736" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_2),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span>
<span id="cb129-737"><a href="#cb129-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-738"><a href="#cb129-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-739"><a href="#cb129-739" aria-hidden="true" tabindex="-1"></a>#Model 4</span>
<span id="cb129-740"><a href="#cb129-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-743"><a href="#cb129-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-744"><a href="#cb129-744" aria-hidden="true" tabindex="-1"></a>logitmod4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Diagnosis_Heart_Disease <span class="sc">~</span>Resting_Blood_Pressure<span class="sc">+</span>Num_Major_Vessels_Flouro<span class="sc">+</span>Thalassemia, <span class="at">family =</span> <span class="st">"binomial"</span>, <span class="at">data=</span>heart_disease_dataset)</span>
<span id="cb129-745"><a href="#cb129-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-746"><a href="#cb129-746" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logitmod4)</span>
<span id="cb129-747"><a href="#cb129-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-748"><a href="#cb129-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-749"><a href="#cb129-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-752"><a href="#cb129-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-753"><a href="#cb129-753" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, <span class="at">newdata =</span> testData, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb129-754"><a href="#cb129-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-755"><a href="#cb129-755" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure the accuracy of prediction in the test data</span></span>
<span id="cb129-756"><a href="#cb129-756" aria-hidden="true" tabindex="-1"></a><span class="co"># The common practice is to take the probability cutoff as 0.5.</span></span>
<span id="cb129-757"><a href="#cb129-757" aria-hidden="true" tabindex="-1"></a><span class="co"># If the probability of Y is &gt; 0.5, then it can be classified an event (presence of heart disease).</span></span>
<span id="cb129-758"><a href="#cb129-758" aria-hidden="true" tabindex="-1"></a><span class="co"># So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative</span></span>
<span id="cb129-759"><a href="#cb129-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-760"><a href="#cb129-760" aria-hidden="true" tabindex="-1"></a>y_pred_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-761"><a href="#cb129-761" aria-hidden="true" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(y_pred_num, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb129-762"><a href="#cb129-762" aria-hidden="true" tabindex="-1"></a>y_act <span class="ot">&lt;-</span> testData<span class="sc">$</span>Diagnosis_Heart_Disease</span>
<span id="cb129-763"><a href="#cb129-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-764"><a href="#cb129-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-765"><a href="#cb129-765" aria-hidden="true" tabindex="-1"></a><span class="co"># Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)</span></span>
<span id="cb129-766"><a href="#cb129-766" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y_pred <span class="sc">==</span> y_act)</span>
<span id="cb129-767"><a href="#cb129-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-768"><a href="#cb129-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-771"><a href="#cb129-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-772"><a href="#cb129-772" aria-hidden="true" tabindex="-1"></a><span class="co"># get the predicted probability in our dataset using the predict() function</span></span>
<span id="cb129-773"><a href="#cb129-773" aria-hidden="true" tabindex="-1"></a><span class="co"># We include the argument type=”response” in order to get our prediction.</span></span>
<span id="cb129-774"><a href="#cb129-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-775"><a href="#cb129-775" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, heart_disease_dataset, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-776"><a href="#cb129-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-777"><a href="#cb129-777" aria-hidden="true" tabindex="-1"></a><span class="co"># create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame</span></span>
<span id="cb129-778"><a href="#cb129-778" aria-hidden="true" tabindex="-1"></a>heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb129-779"><a href="#cb129-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-780"><a href="#cb129-780" aria-hidden="true" tabindex="-1"></a><span class="co"># create a newdata data frame to save a new case information</span></span>
<span id="cb129-781"><a href="#cb129-781" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Resting_Blood_Pressure=</span><span class="dv">160</span>,<span class="at">Num_Major_Vessels_Flouro=</span><span class="dv">2</span>,<span class="at">Thalassemia=</span><span class="dv">2</span>)</span>
<span id="cb129-782"><a href="#cb129-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-783"><a href="#cb129-783" aria-hidden="true" tabindex="-1"></a><span class="co"># predict probability for this new case and print out the predicted value</span></span>
<span id="cb129-784"><a href="#cb129-784" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> <span class="fu">predict</span>(logitmod4, newdata, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb129-785"><a href="#cb129-785" aria-hidden="true" tabindex="-1"></a>p_new</span>
<span id="cb129-786"><a href="#cb129-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-787"><a href="#cb129-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-790"><a href="#cb129-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-791"><a href="#cb129-791" aria-hidden="true" tabindex="-1"></a><span class="co"># load Metrics package</span></span>
<span id="cb129-792"><a href="#cb129-792" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Metrics)</span>
<span id="cb129-793"><a href="#cb129-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-794"><a href="#cb129-794" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate auc, accuracy, clasification error</span></span>
<span id="cb129-795"><a href="#cb129-795" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">auc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3) </span>
<span id="cb129-796"><a href="#cb129-796" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3)</span>
<span id="cb129-797"><a href="#cb129-797" aria-hidden="true" tabindex="-1"></a>classification_error <span class="ot">&lt;-</span> <span class="fu">ce</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3) </span>
<span id="cb129-798"><a href="#cb129-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-799"><a href="#cb129-799" aria-hidden="true" tabindex="-1"></a><span class="co"># print out the metrics on to screen</span></span>
<span id="cb129-800"><a href="#cb129-800" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"AUC="</span>, auc))</span>
<span id="cb129-801"><a href="#cb129-801" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy="</span>, accuracy))</span>
<span id="cb129-802"><a href="#cb129-802" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Classification Error="</span>, classification_error))</span>
<span id="cb129-803"><a href="#cb129-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-804"><a href="#cb129-804" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion matrix</span></span>
<span id="cb129-805"><a href="#cb129-805" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease, <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"True Status"</span>, <span class="st">"Predicted Status"</span>)) <span class="co"># confusion matrix</span></span>
<span id="cb129-806"><a href="#cb129-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-807"><a href="#cb129-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-808"><a href="#cb129-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-811"><a href="#cb129-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-812"><a href="#cb129-812" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">roc</span>(heart_disease_dataset<span class="sc">$</span>Diagnosis_Heart_Disease,heart_disease_dataset<span class="sc">$</span>pred_Diagnosis_Heart_Disease_3),<span class="at">print.auc=</span><span class="cn">TRUE</span>,<span class="at">legacy.axes=</span>T)</span>
<span id="cb129-813"><a href="#cb129-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-814"><a href="#cb129-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-817"><a href="#cb129-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-818"><a href="#cb129-818" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb129-819"><a href="#cb129-819" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(logitmod2, logitmod3,logitmod4, <span class="at">type =</span> <span class="st">"text"</span>)</span>
<span id="cb129-820"><a href="#cb129-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-821"><a href="#cb129-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-822"><a href="#cb129-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-823"><a href="#cb129-823" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Evaluation and Diagnostics</span></span>
<span id="cb129-824"><a href="#cb129-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-825"><a href="#cb129-825" aria-hidden="true" tabindex="-1"></a>A logistic regression models has been built and the coefficients have been examined. However, some critical questions remain.</span>
<span id="cb129-826"><a href="#cb129-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-827"><a href="#cb129-827" aria-hidden="true" tabindex="-1"></a>Which model among all the models is good?</span>
<span id="cb129-828"><a href="#cb129-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-829"><a href="#cb129-829" aria-hidden="true" tabindex="-1"></a>Whcih Predictors are most important?</span>
<span id="cb129-830"><a href="#cb129-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-831"><a href="#cb129-831" aria-hidden="true" tabindex="-1"></a>Are the Predictions Accurate?</span>
<span id="cb129-832"><a href="#cb129-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-833"><a href="#cb129-833" aria-hidden="true" tabindex="-1"></a>To answer these critical Questions We perform Model Evaluation Techniques:</span>
<span id="cb129-834"><a href="#cb129-834" aria-hidden="true" tabindex="-1"></a> Likelihood Ratio Test (Goodness of fit)</span>
<span id="cb129-835"><a href="#cb129-835" aria-hidden="true" tabindex="-1"></a> Varaible Importance</span>
<span id="cb129-836"><a href="#cb129-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-837"><a href="#cb129-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-838"><a href="#cb129-838" aria-hidden="true" tabindex="-1"></a>#1. Likelihood Ratio Test (Goodness of fit) :</span>
<span id="cb129-839"><a href="#cb129-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-840"><a href="#cb129-840" aria-hidden="true" tabindex="-1"></a>A logistic regression is said to provide a better fit to the data if it demonstrates an improvement over a model with fewer predictors. This is performed using the likelihood ratio test, which compares the likelihood of the data under the full model against the likelihood of the data under a model with fewer predictors. Removing predictor variables from a model will almost always make the model fit less well (i.e. a model will have a lower log likelihood), but it is necessary to test whether the observed difference in model fit is statistically significant. Given that H0 holds that the reduced model is true, a p-value for the overall model fit statistic that is less than 0.05 would compel us to reject the null hypothesis. It would provide evidence against the reduced model in favor of the current model. The likelihood ratio test can be performed in R using the lrtest() function from the lmtest package or using the anova() function in base.</span>
<span id="cb129-841"><a href="#cb129-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-842"><a href="#cb129-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-845"><a href="#cb129-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-846"><a href="#cb129-846" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model,logitmod2, <span class="at">test =</span><span class="st">"Chisq"</span>)</span>
<span id="cb129-847"><a href="#cb129-847" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb129-848"><a href="#cb129-848" aria-hidden="true" tabindex="-1"></a><span class="fu">lrtest</span>(logitmod2,logitmod3)</span>
<span id="cb129-849"><a href="#cb129-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-850"><a href="#cb129-850" aria-hidden="true" tabindex="-1"></a>The structure of this output:</span>
<span id="cb129-851"><a href="#cb129-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-852"><a href="#cb129-852" aria-hidden="true" tabindex="-1"></a>Here, we see each model listed out, followed by a table that shows each model’s degrees of freedom and loglikelihood. To the right of these values, we are given the degrees of freedom of our test statistic, the value of our test statistic, and then our p-value.   </span>
<span id="cb129-853"><a href="#cb129-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-854"><a href="#cb129-854" aria-hidden="true" tabindex="-1"></a>From the output we can see that the p-value of the likelihood ratio test is 0.000101. Since this is less than .05, we would reject the null hypothesis.</span>
<span id="cb129-855"><a href="#cb129-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-856"><a href="#cb129-856" aria-hidden="true" tabindex="-1"></a>Thus, we would conclude that the model 3 with reduced predictors offers a significant improvement in fit over the model with just reduced predictors comapring with the model 2.</span>
<span id="cb129-857"><a href="#cb129-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-858"><a href="#cb129-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-859"><a href="#cb129-859" aria-hidden="true" tabindex="-1"></a><span class="fu"># Variable Importance</span></span>
<span id="cb129-860"><a href="#cb129-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-861"><a href="#cb129-861" aria-hidden="true" tabindex="-1"></a>To assess the relative importance of individual predictors in the model, we can also look at the absolute value of the t-statistic for each model parameter. This technique is utilized by the varImp function in the caret package for general and generalized linear models.</span>
<span id="cb129-862"><a href="#cb129-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-865"><a href="#cb129-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-866"><a href="#cb129-866" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod2)</span>
<span id="cb129-867"><a href="#cb129-867" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod3)</span>
<span id="cb129-868"><a href="#cb129-868" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(logitmod4)</span>
<span id="cb129-869"><a href="#cb129-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-870"><a href="#cb129-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-871"><a href="#cb129-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-872"><a href="#cb129-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-873"><a href="#cb129-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-874"><a href="#cb129-874" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Comparison:</span></span>
<span id="cb129-875"><a href="#cb129-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-876"><a href="#cb129-876" aria-hidden="true" tabindex="-1"></a>In the first Model, I have performed mutliple logistic regression with all the predictor valuables in the data to predict heart disease. </span>
<span id="cb129-877"><a href="#cb129-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-878"><a href="#cb129-878" aria-hidden="true" tabindex="-1"></a>Based on the first model , I found the variables which are statistically significant and which are not statistically significant.Variable which are statistically significant are Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi .</span>
<span id="cb129-879"><a href="#cb129-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-880"><a href="#cb129-880" aria-hidden="true" tabindex="-1"></a>In the third model , I have used all the predictors which are statistically significant and found the AUC of 84%. Later in the third model , I have used three variables which are statistically significant i.e.Chest_Pain_Type,Excercise_Induced_Angin as a predictor variables and found the AUC of 80.6%.</span>
<span id="cb129-881"><a href="#cb129-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-882"><a href="#cb129-882" aria-hidden="true" tabindex="-1"></a>Rest three statistically significant variables :Resting_Blood_Pressure,Num_Major_Vessels_Flouro,Thalassemia are executed in this model and found the AUC of 79.2%</span>
<span id="cb129-883"><a href="#cb129-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-884"><a href="#cb129-884" aria-hidden="true" tabindex="-1"></a>Based on all these models, We can infer that the model with all the variables which are statistically significant are the best predictors to classify the patient for the heart disease diagnosis.</span>
<span id="cb129-885"><a href="#cb129-885" aria-hidden="true" tabindex="-1"></a>This model has an AUC of 84%</span>
<span id="cb129-886"><a href="#cb129-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-887"><a href="#cb129-887" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion</span></span>
<span id="cb129-888"><a href="#cb129-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-889"><a href="#cb129-889" aria-hidden="true" tabindex="-1"></a>After doing this analysis, I can conclude that the variables in data are not much correlated and there are more categorical variables.</span>
<span id="cb129-890"><a href="#cb129-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-891"><a href="#cb129-891" aria-hidden="true" tabindex="-1"></a>The best Logistic model with dependent variable as Diagonsis-heart_Disease is Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemia .Here we observed that accuracy, specificity, and sensitivity are good in their scores. The predictions on test data with this model are very good compared to any other logistic models.</span>
<span id="cb129-892"><a href="#cb129-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-893"><a href="#cb129-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-894"><a href="#cb129-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-895"><a href="#cb129-895" aria-hidden="true" tabindex="-1"></a><span class="fu"># References:</span></span>
<span id="cb129-896"><a href="#cb129-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-897"><a href="#cb129-897" aria-hidden="true" tabindex="-1"></a>1.EwR] Hanck, C., Arnold, M., Gerber, A. &amp; Schmelzer, M. (2021) Introduction to Econometrics with R. (https://www.econometrics-with-r.org/)</span>
<span id="cb129-898"><a href="#cb129-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-899"><a href="#cb129-899" aria-hidden="true" tabindex="-1"></a>2.https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6616540/</span>
<span id="cb129-900"><a href="#cb129-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-901"><a href="#cb129-901" aria-hidden="true" tabindex="-1"></a>3.LSR] Navarro, Danielle. Learning Statistics with R. (freely available at https://learningstatisticswithr.com/)</span>
<span id="cb129-902"><a href="#cb129-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-903"><a href="#cb129-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-904"><a href="#cb129-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-905"><a href="#cb129-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-906"><a href="#cb129-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-907"><a href="#cb129-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-908"><a href="#cb129-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-909"><a href="#cb129-909" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>