<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Niharika Pola">
<meta name="dcterms.date" content="2022-12-01">
<meta name="description" content="Final Project Part-2">

<title>Final Project Part-2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final Project Part-2">
<meta name="twitter:description" content="Final Project Part-2">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Fall_2022/">
 <span class="menu-text">Fall 2022 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS/603_Fall_2022"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#backgroundmotivation" id="toc-backgroundmotivation" class="nav-link active" data-scroll-target="#backgroundmotivation">Background/Motivation</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a>
  <ul class="collapse">
  <li><a href="#reading-the-data-set" id="toc-reading-the-data-set" class="nav-link" data-scroll-target="#reading-the-data-set">Reading the data set</a></li>
  </ul></li>
  <li><a href="#preparation-of-the-data" id="toc-preparation-of-the-data" class="nav-link" data-scroll-target="#preparation-of-the-data">Preparation of the data</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#analyzing-the-correlation-between-each-numeric-variable" id="toc-analyzing-the-correlation-between-each-numeric-variable" class="nav-link" data-scroll-target="#analyzing-the-correlation-between-each-numeric-variable">Analyzing the correlation between each numeric variable</a>
  <ul class="collapse">
  <li><a href="#comparing-different-continents-regarding-their-happiness-variables" id="toc-comparing-different-continents-regarding-their-happiness-variables" class="nav-link" data-scroll-target="#comparing-different-continents-regarding-their-happiness-variables"><strong>Comparing different continents regarding their happiness variables</strong></a></li>
  <li><a href="#correlation-plot-for-each-continent" id="toc-correlation-plot-for-each-continent" class="nav-link" data-scroll-target="#correlation-plot-for-each-continent"><strong>Correlation plot for each continent</strong></a></li>
  <li><a href="#happiness-score-comparison-on-different-continents" id="toc-happiness-score-comparison-on-different-continents" class="nav-link" data-scroll-target="#happiness-score-comparison-on-different-continents"><strong>Happiness score comparison on different continents</strong></a></li>
  </ul></li>
  <li><a href="#find-relationship-using-scatter-plot-of-happiness-score-with-each-variable-include-regression-line" id="toc-find-relationship-using-scatter-plot-of-happiness-score-with-each-variable-include-regression-line" class="nav-link" data-scroll-target="#find-relationship-using-scatter-plot-of-happiness-score-with-each-variable-include-regression-line">Find Relationship using Scatter Plot of Happiness Score with each variable (include regression line)</a></li>
  <li><a href="#prediction-using-regression-models" id="toc-prediction-using-regression-models" class="nav-link" data-scroll-target="#prediction-using-regression-models">Prediction using Regression Models</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project Part-2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Final Project Part-2</div>
  </div>
  </div>

<div>
  <div class="description">
    Final Project Part-2
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Niharika Pola </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 1, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="backgroundmotivation" class="level2">
<h2 class="anchored" data-anchor-id="backgroundmotivation">Background/Motivation</h2>
<p>What is takes for a country or a continent to be happy? Is it the economy, life-expectancy, freedom or the trust in the government? What are the factors that affect a country’s or continents overall happiness? Can we predict the happiness score? The curiosity to find answers to these questions made me explore the world happiness data of 2022.</p>
<p>“This year marks the 10th anniversary of the <strong>World Happiness Report</strong>, which uses global survey data to report how people evaluate their own lives in more than 150 countries worldwide. The <strong>World Happiness Report 2022</strong> reveals a bright light in dark times. The pandemic brought not only pain and suffering but also an increase in social support and benevolence. As we battle the ills of disease and war, it is essential to remember the universal desire for happiness and the capacity of individuals to rally to each other’s support in times of great need.” - World Happiness Report 2022</p>
</section>
<section id="research-question" class="level2">
<h2 class="anchored" data-anchor-id="research-question">Research Question</h2>
<p>The World happiness data tries to measure the happiness of the populace of every country and comes up with a score which connotes the level of happiness of the populace.</p>
<p>The data set uses various variables to measure happiness such as the GDP per capita, Freedom to make choices, life expectancy, the perception of corruption, generosity and social support.</p>
<p>In this study, I aim to find out answers to the following research questions:</p>
<ol type="1">
<li>What are the variables or factors that are affecting world’s happiness, with a focus on individual countries &amp; continents. This includes analyzing the correlation between most effective variables.</li>
<li>To find out which model accurately predicts the happiness score.</li>
</ol>
</section>
<section id="hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis">Hypothesis</h2>
<p>I wish to test the following hypothesis,</p>
<ol type="1">
<li>Better economy of a country would lead to happiness</li>
<li>Longer life expectancy would lead to happiness</li>
<li>Having family/social support leads to happiness</li>
<li>Freedom leads to happiness</li>
<li>People’s trust in the Government leads to happiness</li>
<li>Generosity leads to happiness</li>
</ol>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<section id="reading-the-data-set" class="level3">
<h3 class="anchored" data-anchor-id="reading-the-data-set">Reading the data set</h3>
<pre data-rmessage="FALSE," data-warning="FALSE"><code>primary &lt;- read.csv("project datasets/World Happiness Report 2022.csv")
head(primary)
str(primary)
str(primary$Country)</code></pre>
<p>The dataset that I have chosen is happiness 2022 dataset, one of Kaggle’s dataset. This dataset gives the happiness rank and happiness score of 147 countries around the world based on 8 factors including GDP per capita, Social support, Health life expectancy, freedom to make life choices, Generosity, Perceptions of corruption and dystopia residual. The higher value of each of these 8 factors means the level of happiness is higher. Dystopia is the opposite of utopia and has the lowest happiness level. Dystopia will be considered as a reference for other countries to show how far they are from being the poorest country regarding happiness level.</p>
<p>Source of the data: World Happiness Report 2022 use data from the Gallup World Poll surveys from 2019 to 2021. They are based on answers to the main life evaluation question asked in the poll.</p>
<p>Some of the variable names are not clear enough and I decided to change the name of several of them a little bit. Also, I will remove whisker low and whisker high variables from my dataset because these variables give only the lower and upper confidence interval of happiness score and there is no need to use them for visualization and prediction.</p>
<p>The next step is adding another column to the dataset which is continent. I want to work on different continents to discover whether there are different trends for them regarding which factors play a significant role in gaining higher happiness score. Asia, Africa, North America, South America, Europe, and Australia are our six continents in this dataset. Then I moved the position of the continent column to the second column because I think with this position arrange, dataset looks better. Finally, I changed the type of continent variable to factor to be able to work with it easily for visualization.</p>
</section>
</section>
<section id="preparation-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="preparation-of-the-data">Preparation of the data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the name of columns</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (primary) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Happiness.Rank"</span>, <span class="st">"Country"</span>,  <span class="st">"Happiness.Score"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Whisker.High"</span>, <span class="st">"Whisker.Low"</span>, <span class="st">"Dystopia.Residual"</span>,   <span class="st">"Economy"</span>, <span class="st">"Family"</span>, <span class="st">"Life.Expectancy"</span>, <span class="st">"Freedom"</span>, <span class="st">"Generosity"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Trust"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in colnames(primary) &lt;- c("Happiness.Rank", "Country", "Happiness.Score", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Country: Name of countries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Happiness.Rank: Rank of the country based on the Happiness Score</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Happiness.Score: Happiness measurement on a scale of 0 to 10</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Whisker.High: Upper confidence interval of happiness score</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Whisker.Low: Lower confidence interval of happiness score</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Economy: The value of all final goods and services produced within a nation in a given year</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Family: Importance of having a family</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Life.Expectancy: Importance of health and amount of time prople expect to live</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Freedom: Importance of freedom in each country</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generosity: The quality of being kind and generous</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Trust: Perception of corruption in a government</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dystopia.Residual: Plays as a reference</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting unnecessary columns (Whisker.high and Whisker.low)</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>primary <span class="ot">&lt;-</span> primary[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'primary' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent &lt;- NA: object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Israel"</span>, <span class="st">"United Arab Emirates"</span>, <span class="st">"Singapore"</span>, <span class="st">"Thailand"</span>, <span class="st">"Taiwan Province of China"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Qatar"</span>, <span class="st">"Saudi Arabia"</span>, <span class="st">"Kuwait"</span>, <span class="st">"Bahrain"</span>, <span class="st">"Malaysia"</span>, <span class="st">"Uzbekistan"</span>, <span class="st">"Japan"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"South Korea"</span>, <span class="st">"Turkmenistan"</span>, <span class="st">"Kazakhstan"</span>, <span class="st">"Turkey"</span>, <span class="st">"Hong Kong S.A.R., China"</span>, <span class="st">"Philippines"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Jordan"</span>, <span class="st">"China"</span>, <span class="st">"Pakistan"</span>, <span class="st">"Indonesia"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Lebanon"</span>, <span class="st">"Vietnam"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Tajikistan"</span>, <span class="st">"Bhutan"</span>, <span class="st">"Kyrgyzstan"</span>, <span class="st">"Nepal"</span>, <span class="st">"Mongolia"</span>, <span class="st">"Palestinian Territories"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Iran"</span>, <span class="st">"Bangladesh"</span>, <span class="st">"Myanmar"</span>, <span class="st">"Iraq"</span>, <span class="st">"Sri Lanka"</span>, <span class="st">"Armenia"</span>, <span class="st">"India"</span>, <span class="st">"Georgia"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Cambodia"</span>, <span class="st">"Afghanistan"</span>, <span class="st">"Yemen"</span>, <span class="st">"Syria"</span>))] <span class="ot">&lt;-</span> <span class="st">"Asia"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(primary$Country %in% c("Israel", "United Arab Emirates", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Norway"</span>, <span class="st">"Denmark"</span>, <span class="st">"Iceland"</span>, <span class="st">"Switzerland"</span>, <span class="st">"Finland"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Netherlands"</span>, <span class="st">"Sweden"</span>, <span class="st">"Austria"</span>, <span class="st">"Ireland"</span>, <span class="st">"Germany"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Belgium"</span>, <span class="st">"Luxembourg"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Czech Republic"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Malta"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Slovakia"</span>, <span class="st">"Poland"</span>, <span class="st">"Italy"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Russia"</span>, <span class="st">"Lithuania"</span>, <span class="st">"Latvia"</span>, <span class="st">"Moldova"</span>, <span class="st">"Romania"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Slovenia"</span>, <span class="st">"North Cyprus"</span>, <span class="st">"Cyprus"</span>, <span class="st">"Estonia"</span>, <span class="st">"Belarus"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Serbia"</span>, <span class="st">"Hungary"</span>, <span class="st">"Croatia"</span>, <span class="st">"Kosovo"</span>, <span class="st">"Montenegro"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Greece"</span>, <span class="st">"Portugal"</span>, <span class="st">"Bosnia and Herzegovina"</span>, <span class="st">"Macedonia"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Bulgaria"</span>, <span class="st">"Albania"</span>, <span class="st">"Ukraine"</span>))] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(primary$Country %in% c("Norway", "Denmark", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"Costa Rica"</span>, <span class="st">"United States"</span>, <span class="st">"Mexico"</span>,  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Panama"</span>,<span class="st">"Trinidad and Tobago"</span>, <span class="st">"El Salvador"</span>, <span class="st">"Belize"</span>, <span class="st">"Guatemala"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Jamaica"</span>, <span class="st">"Nicaragua"</span>, <span class="st">"Dominican Republic"</span>, <span class="st">"Honduras"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Haiti"</span>))] <span class="ot">&lt;-</span> <span class="st">"North America"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(primary$Country %in% c("Canada", "Costa Rica", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chile"</span>, <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Uruguay"</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Colombia"</span>, <span class="st">"Ecuador"</span>, <span class="st">"Bolivia"</span>, <span class="st">"Peru"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Paraguay"</span>, <span class="st">"Venezuela"</span>))] <span class="ot">&lt;-</span> <span class="st">"South America"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(primary$Country %in% c("Chile", "Brazil", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"New Zealand"</span>, <span class="st">"Australia"</span>))] <span class="ot">&lt;-</span> <span class="st">"Australia"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(primary$Country %in% c("New Zealand", : object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(<span class="fu">is.na</span>(primary<span class="sc">$</span>Continent))] <span class="ot">&lt;-</span> <span class="st">"Africa"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in primary$Continent[which(is.na(primary$Continent))] &lt;- "Africa": object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moving the continent column's position in the dataset to the second column</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>primary <span class="ot">&lt;-</span> primary <span class="sc">%&gt;%</span> <span class="fu">select</span>(Country,Continent, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in select(., Country, Continent, everything()): object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Renaming the final dataframe to happy</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>happy <span class="ot">&lt;-</span> primary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'primary' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(happy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   51020 obs. of  10 variables:
 $ id     : num  1 2 3 4 5 6 7 8 9 10 ...
 $ happy  : Factor w/ 3 levels "not too happy",..: 1 1 2 1 2 2 1 1 2 2 ...
 $ year   : num  1972 1972 1972 1972 1972 ...
 $ age    : num  23 70 48 27 61 26 28 27 21 30 ...
 $ sex    : Factor w/ 2 levels "male","female": 2 1 2 2 2 1 1 1 2 2 ...
 $ marital: Factor w/ 5 levels "married","never married",..: 2 1 1 1 1 2 3 2 2 1 ...
 $ degree : Factor w/ 5 levels "lt high school",..: 4 1 2 4 2 2 2 4 2 2 ...
 $ finrela: Factor w/ 5 levels "far below average",..: 3 4 3 3 4 4 4 3 3 2 ...
 $ health : Factor w/ 4 levels "poor","fair",..: 3 2 4 3 3 3 4 3 4 2 ...
 $ wtssall: num  0.445 0.889 0.889 0.889 0.889 ...</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
</section>
<section id="analyzing-the-correlation-between-each-numeric-variable" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-the-correlation-between-each-numeric-variable">Analyzing the correlation between each numeric variable</h2>
<p>As we already know that the sum of these numeric variables gives the happiness score and there is an inverse relationship between happiness score and happiness rank. The higher the happiness score, the lower the happiness rank. Hence there is no need of looking at the correlation between each numeric variable and happiness rank. We can directly look at the happiness score and other numeric variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a correlation plot</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(dataset, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Correlation Heatmap"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggcorr(dataset, label = TRUE, label_round = 2, label_size = 3.5, : object 'dataset' not found</code></pre>
</div>
</div>
<p>According to the above cor plot, Economy, life expectancy, and family play the most significant role in contributing to happiness. Trust and generosity have the lowest impact on the happiness score.</p>
<section id="comparing-different-continents-regarding-their-happiness-variables" class="level3">
<h3 class="anchored" data-anchor-id="comparing-different-continents-regarding-their-happiness-variables"><strong>Comparing different continents regarding their happiness variables</strong></h3>
<p>Let’s calculate the average happiness score and the average of the other seven variables for each continent. Then melt it to have variables and values in separate columns. Finally, using ggplot to show the difference between continents.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>happy.Continent <span class="ot">&lt;-</span> happy <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>Country), <span class="fu">funs</span>(<span class="fu">mean</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `group_by()`:
! Must group by variables found in `.data`.
✖ Column `Continent` is not found.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or we can use aggregate</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(happy[, 4:11], list(happy$Continent), mean)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Melting the "happy.Continent" dataset</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>happy.Continent.melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(happy.Continent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in melt(happy.Continent): object 'happy.Continent' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Faceting</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(happy.Continent.melt, <span class="fu">aes</span>(<span class="at">y=</span>value, <span class="at">x=</span>Continent, <span class="at">color=</span>Continent, <span class="at">fill=</span>Continent)) <span class="sc">+</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>( <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span>    </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average value of happiness variables for different continents"</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average value"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplot(happy.Continent.melt, aes(y = value, x = Continent, color = Continent, : object 'happy.Continent.melt' not found</code></pre>
</div>
</div>
<p>We can see that Australia has approximately the highest average in all fields except dystopia residual, after that Europe, North America, and South America are roughly the same regarding happiness score and the other seven factors. Finally, Asia and Africa have the lowest scores in all fields.</p>
</section>
<section id="correlation-plot-for-each-continent" class="level3">
<h3 class="anchored" data-anchor-id="correlation-plot-for-each-continent"><strong>Correlation plot for each continent</strong></h3>
<p>Let’s see the correlation between variables for each continent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Africa"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Africa"</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! Problem while computing `..1 = Continent == "Africa"`.
Caused by error in `mask$eval_all_filter()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<p><strong>Correlation between “Happiness Score” and the other variables in Africa:</strong><br>
Economy &gt; Life Expectancy &gt; Family &gt; Dystopia Residual &gt; Freedom</p>
<p>Happiness score and Generosity are inversely correlated.<br>
There is no correlation between happiness score and trust.<br>
</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Asia"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Asia"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! Problem while computing `..1 = Continent == "Asia"`.
Caused by error in `mask$eval_all_filter()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<p><strong>Correlation between “Happiness Score” and the other variables in Asia:</strong><br>
Family &gt; Dystopia.Residual &gt; Freedom &gt; Economy &gt; Life Expectancy &gt; Trust<br>
</p>
<p>There is no correlation between happiness score and Generosity.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Europe"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Europe"</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! Problem while computing `..1 = Continent == "Europe"`.
Caused by error in `mask$eval_all_filter()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<p><strong>Correlation between “Happiness Score” and the other variables in Europe:</strong><br>
Trust &gt; Economy &gt; Freedom &gt; Life Expectancy &gt; Dystopia Residual &gt; Family &gt; Generosity<br>
</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"North America"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for North America"</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! Problem while computing `..1 = Continent == "North America"`.
Caused by error in `mask$eval_all_filter()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<p><strong>Correlation between “Happiness Score” and the other variables in North America:</strong><br>
Economy &gt; Life Expectancy &gt; Family &gt; Generosity &gt; Trust<br>
There is an inverse correlation between happiness score and dystopia residual.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"South America"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for South America"</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! Problem while computing `..1 = Continent == "South America"`.
Caused by error in `mask$eval_all_filter()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<p><strong>Correlation between “Happiness Score” and the other variables in South America:</strong><br>
Dystopia.Residual &gt; Trust &gt; Family &gt; Freedom &gt; Life Expectancy<br>
There is an inverse correlation between happiness score and dystopia residual, Generosity.</p>
</section>
<section id="happiness-score-comparison-on-different-continents" class="level3">
<h3 class="anchored" data-anchor-id="happiness-score-comparison-on-different-continents"><strong>Happiness score comparison on different continents</strong></h3>
<p>We will use scatter plot, box plot, and violin plot to see the happiness score distribution in different countries, how this score is populated in these continents and also will calculate the mean and median of happiness score for each of these continents.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### Happiness score for each continent</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x=</span>Continent,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y=</span>Happiness.Score,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span>Continent))<span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy , <span class="fu">aes</span>(<span class="at">x =</span> Continent, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Continent)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>gg3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy,<span class="fu">aes</span>(<span class="at">x=</span>Continent,<span class="at">y=</span>Happiness.Score))<span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Continent),<span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute descriptive statistics by groups</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>stable <span class="ot">&lt;-</span> <span class="fu">desc_statby</span>(happy, <span class="at">measure.var =</span> <span class="st">"Happiness.Score"</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grps =</span> <span class="st">"Continent"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `group_by()`:
! Must group by variables found in `.data`.
✖ Column `Continent` is not found.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>stable <span class="ot">&lt;-</span> stable[, <span class="fu">c</span>(<span class="st">"Continent"</span>,<span class="st">"mean"</span>,<span class="st">"median"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'stable' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stable) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Continent"</span>, <span class="st">"Mean of happiness score"</span>,<span class="st">"Median of happiness score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in names(stable) &lt;- c("Continent", "Mean of happiness score", "Median of happiness score"): object 'stable' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table plot</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>stable.p <span class="ot">&lt;-</span> <span class="fu">ggtexttable</span>(stable,<span class="at">rows =</span> <span class="cn">NULL</span>, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">theme =</span> <span class="fu">ttheme</span>(<span class="st">"classic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in as.matrix(d): object 'stable' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg1, gg2, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `geom_point()`:
! Problem while computing aesthetics.
ℹ Error occurred in the 1st layer.
Caused by error in `FUN()`:
! object 'Continent' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg3, stable.p, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggarrange(gg3, stable.p, ncol = 1, nrow = 2): object 'stable.p' not found</code></pre>
</div>
</div>
<p>As we have seen before, Australia has the highest median happiness score. Europe, South America, and North America are in the second place regarding median happiness score. Asia has the lowest median after Africa. We can see the range of happiness score for different continents, and also the concentration of happiness score.</p>
</section>
</section>
<section id="find-relationship-using-scatter-plot-of-happiness-score-with-each-variable-include-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="find-relationship-using-scatter-plot-of-happiness-score-with-each-variable-include-regression-line">Find Relationship using Scatter Plot of Happiness Score with each variable (include regression line)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Life.Expectancy, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Life Expectancy)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>The correlation between life expectancy and happiness score in Europe, North America, and Asia is more significant than the other continents. Worth mentioning that we will not take Australia into account because there are just two countries in Australia and creating scatter plot with the regression line for this continent will not give us any insight.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Economy, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Economy)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>We can see pretty the same result here for the correlation between happiness score and economy. Africa has the lowest relationship in this regard.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Freedom, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Freedom)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>Freedom in Europe and North America is more correlated to happiness score than any other continents.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Trust, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Trust)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>Approximately there is no correlation between trust and happiness score in Africa.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Generosity, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Generosity)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>The regression line has a positive slope only for Europe and South America. For Asia the line is horizontal, and for Africa and North America the slope is negative.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Family)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>In South America with increase in the family score, the happiness score remains constant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Dystopia.Residual, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Dystopia Residual)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in happy$Continent: $ operator is invalid for atomic vectors</code></pre>
</div>
</div>
<p>All continents act pretty the same regarding dystopia residual.</p>
</section>
<section id="prediction-using-regression-models" class="level2">
<h2 class="anchored" data-anchor-id="prediction-using-regression-models">Prediction using Regression Models</h2>
<p>In this section, we will implement several machine learning algorithms to predict happiness score. First, we should split our dataset into training and test set. Our dependent variable is happiness score, and the independent variables are family, economy, life expectancy, trust, freedom, generosity, and dystopia residual.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into the Training set and Test set</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> happy[<span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in `[.data.frame`(happy, 4:11): undefined columns selected</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">sample.split</span>(dataset<span class="sc">$</span>Happiness.Score, <span class="at">SplitRatio =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in sample.split(dataset$Happiness.Score, SplitRatio = 0.8): object 'dataset' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>training_set <span class="ot">=</span> <span class="fu">subset</span>(dataset, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in subset(dataset, split == TRUE): object 'dataset' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">=</span> <span class="fu">subset</span>(dataset, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in subset(dataset, split == FALSE): object 'dataset' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting Multiple Linear Regression to the Training set</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>regressor_lm <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> Happiness.Score <span class="sc">~</span> .,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> training_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in is.data.frame(data): object 'training_set' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regressor_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in summary(regressor_lm): object 'regressor_lm' not found</code></pre>
</div>
</div>
<p>The summary shows that all independent variables have a significant impact, and adjusted R squared is 1! As we discussed, it is clear that there is a linear correlation between dependent and independent variables. Again, I should mention that the sum of the independent variables is equal to the dependent variable which is the happiness score. This is the justification for having an adjusted R squared equals to 1. As a result, I guess Multiple Linear Regression will predict happiness scores with 100 % accuracy!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### Predicting the Test set results</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>y_pred_lm <span class="ot">=</span> <span class="fu">predict</span>(regressor_lm, <span class="at">newdata =</span> test_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in predict(regressor_lm, newdata = test_set): object 'regressor_lm' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>Pred_Actual_lm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">Prediction =</span> y_pred_lm, <span class="at">Actual =</span> test_set<span class="sc">$</span>Happiness.Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score): object 'y_pred_lm' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>gg.lm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Pred_Actual_lm, <span class="fu">aes</span>(Actual, Prediction )) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multiple Linear Regression"</span>, <span class="at">x =</span> <span class="st">"Actual happiness score"</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted happiness score"</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> (<span class="dv">15</span>)), </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">10</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplot(Pred_Actual_lm, aes(Actual, Prediction)): object 'Pred_Actual_lm' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>gg.lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'gg.lm' not found</code></pre>
</div>
</div>
<p>As we expected, actual versus predicted plot shows the accuracy of our model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting Multiple Linear Regression to the Training set</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>regressor_lm_2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> happy<span class="sc">$</span>Happiness.Score <span class="sc">~</span> happy<span class="sc">$</span>Trust<span class="sc">+</span>happy<span class="sc">$</span>Life.Expectancy<span class="sc">+</span> happy<span class="sc">$</span>Generosity <span class="sc">+</span> happy<span class="sc">$</span>Economy<span class="sc">+</span> happy<span class="sc">$</span>Family <span class="sc">+</span> happy<span class="sc">$</span>Freedom<span class="sc">+</span>happy<span class="sc">$</span>Dystopia.Residual,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> training_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in is.data.frame(data): object 'training_set' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regressor_lm_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in summary(regressor_lm_2): object 'regressor_lm_2' not found</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="do">####### Predicting the Test set results</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>y_pred_lm <span class="ot">=</span> <span class="fu">predict</span>(regressor_lm_2, <span class="at">newdata =</span> test_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in predict(regressor_lm_2, newdata = test_set): object 'regressor_lm_2' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>Pred_Actual_lm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">Prediction =</span> y_pred_lm, <span class="at">Actual =</span> test_set<span class="sc">$</span>Happiness.Score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score): object 'y_pred_lm' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>gg.lm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Pred_Actual_lm, <span class="fu">aes</span>(Actual, Prediction )) <span class="sc">+</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multiple Linear Regression"</span>, <span class="at">x =</span> <span class="st">"Actual happiness score"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted happiness score"</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> (<span class="dv">15</span>)), </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">10</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in ggplot(Pred_Actual_lm, aes(Actual, Prediction)): object 'Pred_Actual_lm' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>gg.lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'gg.lm' not found</code></pre>
</div>
</div>
<p><br>
</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Fall_2022" data-repo-id="R_kgDOH568kA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb103" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project Part-2"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Niharika Pola"</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Final Project Part-2"</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "12/1/2022"</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Final Project Part-2</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caTools)</span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background/Motivation</span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>What is takes for a country or a continent to be happy? Is it the economy, life-expectancy, freedom or the trust in the government? What are the factors that affect a country's or continents overall happiness? Can we predict the happiness score? The curiosity to find answers to these questions made me explore the world happiness data of 2022.</span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>"This year marks the 10th anniversary of the **World Happiness Report**, which uses global survey data to report how people evaluate their own lives in more than 150 countries worldwide. The **World Happiness Report 2022** reveals a bright light in dark times. The pandemic brought not only pain and suffering but also an increase in social support and benevolence. As we battle the ills of disease and war, it is essential to remember the universal desire for happiness and the capacity of individuals to rally to each other's support in times of great need." - World Happiness Report 2022</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research Question</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>The World happiness data tries to measure the happiness of the populace of every country and comes up with a score which connotes the level of happiness of the populace.</span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a>The data set uses various variables to measure happiness such as the GDP per capita, Freedom to make choices, life expectancy, the perception of corruption, generosity and social support.</span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a>In this study, I aim to find out answers to the following research questions:</span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What are the variables or factors that are affecting world's happiness, with a focus on individual countries &amp; continents. This includes analyzing the correlation between most effective variables.</span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>To find out which model accurately predicts the happiness score.</span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesis</span></span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a>I wish to test the following hypothesis,</span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Better economy of a country would lead to happiness</span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Longer life expectancy would lead to happiness</span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Having family/social support leads to happiness</span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Freedom leads to happiness</span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>People's trust in the Government leads to happiness</span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Generosity leads to happiness</span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preparation</span></span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reading the data set</span></span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a>primary <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"project datasets/World Happiness Report 2022.csv"</span>)</span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(primary)</span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(primary)</span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(primary<span class="sc">$</span>Country)</span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a>The dataset that I have chosen is happiness 2022 dataset, one of Kaggle's dataset. This dataset gives the happiness rank and happiness score of 147 countries around the world based on 8 factors including GDP per capita, Social support, Health life expectancy, freedom to make life choices, Generosity, Perceptions of corruption and dystopia residual. The higher value of each of these 8 factors means the level of happiness is higher. Dystopia is the opposite of utopia and has the lowest happiness level. Dystopia will be considered as a reference for other countries to show how far they are from being the poorest country regarding happiness level.</span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a>Source of the data: World Happiness Report 2022 use data from the Gallup World Poll surveys from 2019 to 2021. They are based on answers to the main life evaluation question asked in the poll.</span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a>Some of the variable names are not clear enough and I decided to change the name of several of them a little bit. Also, I will remove whisker low and whisker high variables from my dataset because these variables give only the lower and upper confidence interval of happiness score and there is no need to use them for visualization and prediction.</span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a>The next step is adding another column to the dataset which is continent. I want to work on different continents to discover whether there are different trends for them regarding which factors play a significant role in gaining higher happiness score. Asia, Africa, North America, South America, Europe, and Australia are our six continents in this dataset. Then I moved the position of the continent column to the second column because I think with this position arrange, dataset looks better. Finally, I changed the type of continent variable to factor to be able to work with it easily for visualization.</span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparation of the data</span></span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the name of columns</span></span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (primary) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Happiness.Rank"</span>, <span class="st">"Country"</span>,  <span class="st">"Happiness.Score"</span>,</span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Whisker.High"</span>, <span class="st">"Whisker.Low"</span>, <span class="st">"Dystopia.Residual"</span>,   <span class="st">"Economy"</span>, <span class="st">"Family"</span>, <span class="st">"Life.Expectancy"</span>, <span class="st">"Freedom"</span>, <span class="st">"Generosity"</span>,</span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Trust"</span>)</span>
<span id="cb103-84"><a href="#cb103-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-85"><a href="#cb103-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-86"><a href="#cb103-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Country: Name of countries</span></span>
<span id="cb103-87"><a href="#cb103-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Happiness.Rank: Rank of the country based on the Happiness Score</span></span>
<span id="cb103-88"><a href="#cb103-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Happiness.Score: Happiness measurement on a scale of 0 to 10</span></span>
<span id="cb103-89"><a href="#cb103-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Whisker.High: Upper confidence interval of happiness score</span></span>
<span id="cb103-90"><a href="#cb103-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Whisker.Low: Lower confidence interval of happiness score</span></span>
<span id="cb103-91"><a href="#cb103-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Economy: The value of all final goods and services produced within a nation in a given year</span></span>
<span id="cb103-92"><a href="#cb103-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Family: Importance of having a family</span></span>
<span id="cb103-93"><a href="#cb103-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Life.Expectancy: Importance of health and amount of time prople expect to live</span></span>
<span id="cb103-94"><a href="#cb103-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Freedom: Importance of freedom in each country</span></span>
<span id="cb103-95"><a href="#cb103-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Generosity: The quality of being kind and generous</span></span>
<span id="cb103-96"><a href="#cb103-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Trust: Perception of corruption in a government</span></span>
<span id="cb103-97"><a href="#cb103-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Dystopia.Residual: Plays as a reference</span></span>
<span id="cb103-98"><a href="#cb103-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-99"><a href="#cb103-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Deleting unnecessary columns (Whisker.high and Whisker.low)</span></span>
<span id="cb103-100"><a href="#cb103-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-101"><a href="#cb103-101" aria-hidden="true" tabindex="-1"></a>primary <span class="ot">&lt;-</span> primary[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)]</span>
<span id="cb103-102"><a href="#cb103-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-103"><a href="#cb103-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-104"><a href="#cb103-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb103-105"><a href="#cb103-105" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb103-106"><a href="#cb103-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-107"><a href="#cb103-107" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Israel"</span>, <span class="st">"United Arab Emirates"</span>, <span class="st">"Singapore"</span>, <span class="st">"Thailand"</span>, <span class="st">"Taiwan Province of China"</span>,</span>
<span id="cb103-108"><a href="#cb103-108" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Qatar"</span>, <span class="st">"Saudi Arabia"</span>, <span class="st">"Kuwait"</span>, <span class="st">"Bahrain"</span>, <span class="st">"Malaysia"</span>, <span class="st">"Uzbekistan"</span>, <span class="st">"Japan"</span>,</span>
<span id="cb103-109"><a href="#cb103-109" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"South Korea"</span>, <span class="st">"Turkmenistan"</span>, <span class="st">"Kazakhstan"</span>, <span class="st">"Turkey"</span>, <span class="st">"Hong Kong S.A.R., China"</span>, <span class="st">"Philippines"</span>,</span>
<span id="cb103-110"><a href="#cb103-110" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Jordan"</span>, <span class="st">"China"</span>, <span class="st">"Pakistan"</span>, <span class="st">"Indonesia"</span>, <span class="st">"Azerbaijan"</span>, <span class="st">"Lebanon"</span>, <span class="st">"Vietnam"</span>,</span>
<span id="cb103-111"><a href="#cb103-111" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Tajikistan"</span>, <span class="st">"Bhutan"</span>, <span class="st">"Kyrgyzstan"</span>, <span class="st">"Nepal"</span>, <span class="st">"Mongolia"</span>, <span class="st">"Palestinian Territories"</span>,</span>
<span id="cb103-112"><a href="#cb103-112" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Iran"</span>, <span class="st">"Bangladesh"</span>, <span class="st">"Myanmar"</span>, <span class="st">"Iraq"</span>, <span class="st">"Sri Lanka"</span>, <span class="st">"Armenia"</span>, <span class="st">"India"</span>, <span class="st">"Georgia"</span>,</span>
<span id="cb103-113"><a href="#cb103-113" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Cambodia"</span>, <span class="st">"Afghanistan"</span>, <span class="st">"Yemen"</span>, <span class="st">"Syria"</span>))] <span class="ot">&lt;-</span> <span class="st">"Asia"</span></span>
<span id="cb103-114"><a href="#cb103-114" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Norway"</span>, <span class="st">"Denmark"</span>, <span class="st">"Iceland"</span>, <span class="st">"Switzerland"</span>, <span class="st">"Finland"</span>,</span>
<span id="cb103-115"><a href="#cb103-115" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Netherlands"</span>, <span class="st">"Sweden"</span>, <span class="st">"Austria"</span>, <span class="st">"Ireland"</span>, <span class="st">"Germany"</span>,</span>
<span id="cb103-116"><a href="#cb103-116" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Belgium"</span>, <span class="st">"Luxembourg"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Czech Republic"</span>,</span>
<span id="cb103-117"><a href="#cb103-117" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Malta"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Slovakia"</span>, <span class="st">"Poland"</span>, <span class="st">"Italy"</span>,</span>
<span id="cb103-118"><a href="#cb103-118" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Russia"</span>, <span class="st">"Lithuania"</span>, <span class="st">"Latvia"</span>, <span class="st">"Moldova"</span>, <span class="st">"Romania"</span>,</span>
<span id="cb103-119"><a href="#cb103-119" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Slovenia"</span>, <span class="st">"North Cyprus"</span>, <span class="st">"Cyprus"</span>, <span class="st">"Estonia"</span>, <span class="st">"Belarus"</span>,</span>
<span id="cb103-120"><a href="#cb103-120" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Serbia"</span>, <span class="st">"Hungary"</span>, <span class="st">"Croatia"</span>, <span class="st">"Kosovo"</span>, <span class="st">"Montenegro"</span>,</span>
<span id="cb103-121"><a href="#cb103-121" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Greece"</span>, <span class="st">"Portugal"</span>, <span class="st">"Bosnia and Herzegovina"</span>, <span class="st">"Macedonia"</span>,</span>
<span id="cb103-122"><a href="#cb103-122" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Bulgaria"</span>, <span class="st">"Albania"</span>, <span class="st">"Ukraine"</span>))] <span class="ot">&lt;-</span> <span class="st">"Europe"</span></span>
<span id="cb103-123"><a href="#cb103-123" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Canada"</span>, <span class="st">"Costa Rica"</span>, <span class="st">"United States"</span>, <span class="st">"Mexico"</span>,  </span>
<span id="cb103-124"><a href="#cb103-124" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Panama"</span>,<span class="st">"Trinidad and Tobago"</span>, <span class="st">"El Salvador"</span>, <span class="st">"Belize"</span>, <span class="st">"Guatemala"</span>,</span>
<span id="cb103-125"><a href="#cb103-125" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Jamaica"</span>, <span class="st">"Nicaragua"</span>, <span class="st">"Dominican Republic"</span>, <span class="st">"Honduras"</span>,</span>
<span id="cb103-126"><a href="#cb103-126" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Haiti"</span>))] <span class="ot">&lt;-</span> <span class="st">"North America"</span></span>
<span id="cb103-127"><a href="#cb103-127" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Chile"</span>, <span class="st">"Brazil"</span>, <span class="st">"Argentina"</span>, <span class="st">"Uruguay"</span>,</span>
<span id="cb103-128"><a href="#cb103-128" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Colombia"</span>, <span class="st">"Ecuador"</span>, <span class="st">"Bolivia"</span>, <span class="st">"Peru"</span>,</span>
<span id="cb103-129"><a href="#cb103-129" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Paraguay"</span>, <span class="st">"Venezuela"</span>))] <span class="ot">&lt;-</span> <span class="st">"South America"</span></span>
<span id="cb103-130"><a href="#cb103-130" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(primary<span class="sc">$</span>Country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"New Zealand"</span>, <span class="st">"Australia"</span>))] <span class="ot">&lt;-</span> <span class="st">"Australia"</span></span>
<span id="cb103-131"><a href="#cb103-131" aria-hidden="true" tabindex="-1"></a>primary<span class="sc">$</span>Continent[<span class="fu">which</span>(<span class="fu">is.na</span>(primary<span class="sc">$</span>Continent))] <span class="ot">&lt;-</span> <span class="st">"Africa"</span></span>
<span id="cb103-132"><a href="#cb103-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-133"><a href="#cb103-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Moving the continent column's position in the dataset to the second column</span></span>
<span id="cb103-134"><a href="#cb103-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-135"><a href="#cb103-135" aria-hidden="true" tabindex="-1"></a>primary <span class="ot">&lt;-</span> primary <span class="sc">%&gt;%</span> <span class="fu">select</span>(Country,Continent, <span class="fu">everything</span>())</span>
<span id="cb103-136"><a href="#cb103-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-137"><a href="#cb103-137" aria-hidden="true" tabindex="-1"></a><span class="co">#Renaming the final dataframe to happy</span></span>
<span id="cb103-138"><a href="#cb103-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-139"><a href="#cb103-139" aria-hidden="true" tabindex="-1"></a>happy <span class="ot">&lt;-</span> primary</span>
<span id="cb103-140"><a href="#cb103-140" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(happy)</span>
<span id="cb103-141"><a href="#cb103-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-142"><a href="#cb103-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-143"><a href="#cb103-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualization</span></span>
<span id="cb103-144"><a href="#cb103-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-145"><a href="#cb103-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analyzing the correlation between each numeric variable</span></span>
<span id="cb103-146"><a href="#cb103-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-147"><a href="#cb103-147" aria-hidden="true" tabindex="-1"></a>As we already know that the sum of these numeric variables gives the happiness score and there is an inverse relationship between happiness score and happiness rank. The higher the happiness score, the lower the happiness rank. Hence there is no need of looking at the correlation between each numeric variable and happiness rank. We can directly look at the happiness score and other numeric variables.</span>
<span id="cb103-148"><a href="#cb103-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-149"><a href="#cb103-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-150"><a href="#cb103-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a correlation plot</span></span>
<span id="cb103-151"><a href="#cb103-151" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(dataset, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-152"><a href="#cb103-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Correlation Heatmap"</span>) <span class="sc">+</span></span>
<span id="cb103-153"><a href="#cb103-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-154"><a href="#cb103-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-155"><a href="#cb103-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-156"><a href="#cb103-156" aria-hidden="true" tabindex="-1"></a>According to the above cor plot, Economy, life expectancy, and family play the most significant role in contributing to happiness. Trust and generosity have the lowest impact on the happiness score.</span>
<span id="cb103-157"><a href="#cb103-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-158"><a href="#cb103-158" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Comparing different continents regarding their happiness variables**</span></span>
<span id="cb103-159"><a href="#cb103-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-160"><a href="#cb103-160" aria-hidden="true" tabindex="-1"></a>Let's calculate the average happiness score and the average of the other seven variables for each continent. Then melt it to have variables and values in separate columns. Finally, using ggplot to show the difference between continents.</span>
<span id="cb103-161"><a href="#cb103-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-162"><a href="#cb103-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-163"><a href="#cb103-163" aria-hidden="true" tabindex="-1"></a>happy.Continent <span class="ot">&lt;-</span> happy <span class="sc">%&gt;%</span></span>
<span id="cb103-164"><a href="#cb103-164" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-165"><a href="#cb103-165" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">group_by</span>(Continent) <span class="sc">%&gt;%</span></span>
<span id="cb103-166"><a href="#cb103-166" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">summarise_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>Country), <span class="fu">funs</span>(<span class="fu">mean</span>(., <span class="at">na.rm=</span><span class="cn">TRUE</span>)))</span>
<span id="cb103-167"><a href="#cb103-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-168"><a href="#cb103-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Or we can use aggregate</span></span>
<span id="cb103-169"><a href="#cb103-169" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(happy[, 4:11], list(happy$Continent), mean)</span></span>
<span id="cb103-170"><a href="#cb103-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-171"><a href="#cb103-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Melting the "happy.Continent" dataset</span></span>
<span id="cb103-172"><a href="#cb103-172" aria-hidden="true" tabindex="-1"></a>happy.Continent.melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(happy.Continent)</span>
<span id="cb103-173"><a href="#cb103-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-174"><a href="#cb103-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-175"><a href="#cb103-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Faceting</span></span>
<span id="cb103-176"><a href="#cb103-176" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(happy.Continent.melt, <span class="fu">aes</span>(<span class="at">y=</span>value, <span class="at">x=</span>Continent, <span class="at">color=</span>Continent, <span class="at">fill=</span>Continent)) <span class="sc">+</span> </span>
<span id="cb103-177"><a href="#cb103-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>( <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span>    </span>
<span id="cb103-178"><a href="#cb103-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb103-179"><a href="#cb103-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-180"><a href="#cb103-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average value of happiness variables for different continents"</span>, </span>
<span id="cb103-181"><a href="#cb103-181" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average value"</span>) </span>
<span id="cb103-182"><a href="#cb103-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-183"><a href="#cb103-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-184"><a href="#cb103-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-185"><a href="#cb103-185" aria-hidden="true" tabindex="-1"></a>We can see that Australia has approximately the highest average in all fields except dystopia residual, after that Europe, North America, and South America are roughly the same regarding happiness score and the other seven factors. Finally, Asia and Africa have the lowest scores in all fields.</span>
<span id="cb103-186"><a href="#cb103-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-187"><a href="#cb103-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Correlation plot for each continent**</span></span>
<span id="cb103-188"><a href="#cb103-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-189"><a href="#cb103-189" aria-hidden="true" tabindex="-1"></a>Let's see the correlation between variables for each continent.</span>
<span id="cb103-190"><a href="#cb103-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-191"><a href="#cb103-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-192"><a href="#cb103-192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Africa"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-193"><a href="#cb103-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Africa"</span>) <span class="sc">+</span></span>
<span id="cb103-194"><a href="#cb103-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-195"><a href="#cb103-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-196"><a href="#cb103-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-197"><a href="#cb103-197" aria-hidden="true" tabindex="-1"></a>**Correlation between "Happiness Score" and the other variables in Africa:**\</span>
<span id="cb103-198"><a href="#cb103-198" aria-hidden="true" tabindex="-1"></a>Economy <span class="sc">\&gt;</span> Life Expectancy <span class="sc">\&gt;</span> Family <span class="sc">\&gt;</span> Dystopia Residual <span class="sc">\&gt;</span> Freedom</span>
<span id="cb103-199"><a href="#cb103-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-200"><a href="#cb103-200" aria-hidden="true" tabindex="-1"></a>Happiness score and Generosity are inversely correlated.\</span>
<span id="cb103-201"><a href="#cb103-201" aria-hidden="true" tabindex="-1"></a>There is no correlation between happiness score and trust.\</span>
<span id="cb103-202"><a href="#cb103-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-203"><a href="#cb103-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-204"><a href="#cb103-204" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Asia"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-205"><a href="#cb103-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Asia"</span>) <span class="sc">+</span></span>
<span id="cb103-206"><a href="#cb103-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-207"><a href="#cb103-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-208"><a href="#cb103-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-209"><a href="#cb103-209" aria-hidden="true" tabindex="-1"></a>**Correlation between "Happiness Score" and the other variables in Asia:**\</span>
<span id="cb103-210"><a href="#cb103-210" aria-hidden="true" tabindex="-1"></a>Family <span class="sc">\&gt;</span> Dystopia.Residual <span class="sc">\&gt;</span> Freedom <span class="sc">\&gt;</span> Economy <span class="sc">\&gt;</span> Life Expectancy <span class="sc">\&gt;</span> Trust\</span>
<span id="cb103-211"><a href="#cb103-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-212"><a href="#cb103-212" aria-hidden="true" tabindex="-1"></a>There is no correlation between happiness score and Generosity.</span>
<span id="cb103-213"><a href="#cb103-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-214"><a href="#cb103-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-215"><a href="#cb103-215" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"Europe"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-216"><a href="#cb103-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for Europe"</span>) <span class="sc">+</span></span>
<span id="cb103-217"><a href="#cb103-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-218"><a href="#cb103-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-219"><a href="#cb103-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-220"><a href="#cb103-220" aria-hidden="true" tabindex="-1"></a>**Correlation between "Happiness Score" and the other variables in Europe:**\</span>
<span id="cb103-221"><a href="#cb103-221" aria-hidden="true" tabindex="-1"></a>Trust <span class="sc">\&gt;</span> Economy <span class="sc">\&gt;</span> Freedom <span class="sc">\&gt;</span> Life Expectancy <span class="sc">\&gt;</span> Dystopia Residual <span class="sc">\&gt;</span> Family <span class="sc">\&gt;</span> Generosity\</span>
<span id="cb103-222"><a href="#cb103-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-223"><a href="#cb103-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-224"><a href="#cb103-224" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"North America"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-225"><a href="#cb103-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for North America"</span>) <span class="sc">+</span></span>
<span id="cb103-226"><a href="#cb103-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-227"><a href="#cb103-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-228"><a href="#cb103-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-229"><a href="#cb103-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-230"><a href="#cb103-230" aria-hidden="true" tabindex="-1"></a>**Correlation between "Happiness Score" and the other variables in North America:**\</span>
<span id="cb103-231"><a href="#cb103-231" aria-hidden="true" tabindex="-1"></a>Economy <span class="sc">\&gt;</span> Life Expectancy <span class="sc">\&gt;</span> Family <span class="sc">\&gt;</span> Generosity <span class="sc">\&gt;</span> Trust \</span>
<span id="cb103-232"><a href="#cb103-232" aria-hidden="true" tabindex="-1"></a>There is an inverse correlation between happiness score and dystopia residual.</span>
<span id="cb103-233"><a href="#cb103-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-234"><a href="#cb103-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-235"><a href="#cb103-235" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorr</span>(happy <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"South America"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label_round =</span> <span class="dv">2</span>, <span class="at">label_size =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> .<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb103-236"><a href="#cb103-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Happiness Matrix for South America"</span>) <span class="sc">+</span></span>
<span id="cb103-237"><a href="#cb103-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-238"><a href="#cb103-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-239"><a href="#cb103-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-240"><a href="#cb103-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-241"><a href="#cb103-241" aria-hidden="true" tabindex="-1"></a>**Correlation between "Happiness Score" and the other variables in South America:**\</span>
<span id="cb103-242"><a href="#cb103-242" aria-hidden="true" tabindex="-1"></a>Dystopia.Residual <span class="sc">\&gt;</span> Trust <span class="sc">\&gt;</span> Family <span class="sc">\&gt;</span> Freedom <span class="sc">\&gt;</span> Life Expectancy\</span>
<span id="cb103-243"><a href="#cb103-243" aria-hidden="true" tabindex="-1"></a>There is an inverse correlation between happiness score and dystopia residual, Generosity.</span>
<span id="cb103-244"><a href="#cb103-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-245"><a href="#cb103-245" aria-hidden="true" tabindex="-1"></a><span class="fu">### **Happiness score comparison on different continents**</span></span>
<span id="cb103-246"><a href="#cb103-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-247"><a href="#cb103-247" aria-hidden="true" tabindex="-1"></a>We will use scatter plot, box plot, and violin plot to see the happiness score distribution in different countries, how this score is populated in these continents and also will calculate the mean and median of happiness score for each of these continents.</span>
<span id="cb103-248"><a href="#cb103-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-249"><a href="#cb103-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-250"><a href="#cb103-250" aria-hidden="true" tabindex="-1"></a><span class="do">####### Happiness score for each continent</span></span>
<span id="cb103-251"><a href="#cb103-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-252"><a href="#cb103-252" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy,</span>
<span id="cb103-253"><a href="#cb103-253" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x=</span>Continent,</span>
<span id="cb103-254"><a href="#cb103-254" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y=</span>Happiness.Score,</span>
<span id="cb103-255"><a href="#cb103-255" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span>Continent))<span class="sc">+</span></span>
<span id="cb103-256"><a href="#cb103-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb103-257"><a href="#cb103-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb103-258"><a href="#cb103-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-259"><a href="#cb103-259" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy , <span class="fu">aes</span>(<span class="at">x =</span> Continent, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span></span>
<span id="cb103-260"><a href="#cb103-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Continent)) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb103-261"><a href="#cb103-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb103-262"><a href="#cb103-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-263"><a href="#cb103-263" aria-hidden="true" tabindex="-1"></a>gg3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(happy,<span class="fu">aes</span>(<span class="at">x=</span>Continent,<span class="at">y=</span>Happiness.Score))<span class="sc">+</span></span>
<span id="cb103-264"><a href="#cb103-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Continent),<span class="at">alpha=</span><span class="fl">0.7</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb103-265"><a href="#cb103-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">8</span>)))</span>
<span id="cb103-266"><a href="#cb103-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-267"><a href="#cb103-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute descriptive statistics by groups</span></span>
<span id="cb103-268"><a href="#cb103-268" aria-hidden="true" tabindex="-1"></a>stable <span class="ot">&lt;-</span> <span class="fu">desc_statby</span>(happy, <span class="at">measure.var =</span> <span class="st">"Happiness.Score"</span>,</span>
<span id="cb103-269"><a href="#cb103-269" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grps =</span> <span class="st">"Continent"</span>)</span>
<span id="cb103-270"><a href="#cb103-270" aria-hidden="true" tabindex="-1"></a>stable <span class="ot">&lt;-</span> stable[, <span class="fu">c</span>(<span class="st">"Continent"</span>,<span class="st">"mean"</span>,<span class="st">"median"</span>)]</span>
<span id="cb103-271"><a href="#cb103-271" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stable) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Continent"</span>, <span class="st">"Mean of happiness score"</span>,<span class="st">"Median of happiness score"</span>)</span>
<span id="cb103-272"><a href="#cb103-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary table plot</span></span>
<span id="cb103-273"><a href="#cb103-273" aria-hidden="true" tabindex="-1"></a>stable.p <span class="ot">&lt;-</span> <span class="fu">ggtexttable</span>(stable,<span class="at">rows =</span> <span class="cn">NULL</span>, </span>
<span id="cb103-274"><a href="#cb103-274" aria-hidden="true" tabindex="-1"></a>                         <span class="at">theme =</span> <span class="fu">ttheme</span>(<span class="st">"classic"</span>))</span>
<span id="cb103-275"><a href="#cb103-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-276"><a href="#cb103-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-277"><a href="#cb103-277" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg1, gg2, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb103-278"><a href="#cb103-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-279"><a href="#cb103-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-280"><a href="#cb103-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-281"><a href="#cb103-281" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(gg3, stable.p, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb103-282"><a href="#cb103-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-283"><a href="#cb103-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-284"><a href="#cb103-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-285"><a href="#cb103-285" aria-hidden="true" tabindex="-1"></a>As we have seen before, Australia has the highest median happiness score. Europe, South America, and North America are in the second place regarding median happiness score. Asia has the lowest median after Africa. We can see the range of happiness score for different continents, and also the concentration of happiness score.</span>
<span id="cb103-286"><a href="#cb103-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-287"><a href="#cb103-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Find Relationship using Scatter Plot of Happiness Score with each variable (include regression line)</span></span>
<span id="cb103-288"><a href="#cb103-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-289"><a href="#cb103-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-290"><a href="#cb103-290" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Life.Expectancy, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-291"><a href="#cb103-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-292"><a href="#cb103-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-293"><a href="#cb103-293" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-294"><a href="#cb103-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-295"><a href="#cb103-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Life Expectancy)"</span>)</span>
<span id="cb103-296"><a href="#cb103-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-297"><a href="#cb103-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-298"><a href="#cb103-298" aria-hidden="true" tabindex="-1"></a>The correlation between life expectancy and happiness score in Europe, North America, and Asia is more significant than the other continents. Worth mentioning that we will not take Australia into account because there are just two countries in Australia and creating scatter plot with the regression line for this continent will not give us any insight.</span>
<span id="cb103-299"><a href="#cb103-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-300"><a href="#cb103-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-301"><a href="#cb103-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Economy, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-302"><a href="#cb103-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-303"><a href="#cb103-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-304"><a href="#cb103-304" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-305"><a href="#cb103-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-306"><a href="#cb103-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Economy)"</span>)</span>
<span id="cb103-307"><a href="#cb103-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-308"><a href="#cb103-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-309"><a href="#cb103-309" aria-hidden="true" tabindex="-1"></a>We can see pretty the same result here for the correlation between happiness score and economy. Africa has the lowest relationship in this regard.</span>
<span id="cb103-310"><a href="#cb103-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-311"><a href="#cb103-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-312"><a href="#cb103-312" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Freedom, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-313"><a href="#cb103-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-314"><a href="#cb103-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-315"><a href="#cb103-315" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-316"><a href="#cb103-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-317"><a href="#cb103-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Freedom)"</span>)</span>
<span id="cb103-318"><a href="#cb103-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-319"><a href="#cb103-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-320"><a href="#cb103-320" aria-hidden="true" tabindex="-1"></a>Freedom in Europe and North America is more correlated to happiness score than any other continents.</span>
<span id="cb103-321"><a href="#cb103-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-322"><a href="#cb103-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-323"><a href="#cb103-323" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Trust, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-324"><a href="#cb103-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-325"><a href="#cb103-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-326"><a href="#cb103-326" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-327"><a href="#cb103-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-328"><a href="#cb103-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Trust)"</span>)</span>
<span id="cb103-329"><a href="#cb103-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-330"><a href="#cb103-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-331"><a href="#cb103-331" aria-hidden="true" tabindex="-1"></a>Approximately there is no correlation between trust and happiness score in Africa.</span>
<span id="cb103-332"><a href="#cb103-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-333"><a href="#cb103-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-334"><a href="#cb103-334" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Generosity, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-335"><a href="#cb103-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-336"><a href="#cb103-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-337"><a href="#cb103-337" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-338"><a href="#cb103-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-339"><a href="#cb103-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Generosity)"</span>)</span>
<span id="cb103-340"><a href="#cb103-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-341"><a href="#cb103-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-342"><a href="#cb103-342" aria-hidden="true" tabindex="-1"></a>The regression line has a positive slope only for Europe and South America. For Asia the line is horizontal, and for Africa and North America the slope is negative.</span>
<span id="cb103-343"><a href="#cb103-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-344"><a href="#cb103-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-345"><a href="#cb103-345" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Family, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-346"><a href="#cb103-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-347"><a href="#cb103-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-348"><a href="#cb103-348" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-349"><a href="#cb103-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-350"><a href="#cb103-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Family)"</span>)</span>
<span id="cb103-351"><a href="#cb103-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-352"><a href="#cb103-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-353"><a href="#cb103-353" aria-hidden="true" tabindex="-1"></a>In South America with increase in the family score, the happiness score remains constant.</span>
<span id="cb103-354"><a href="#cb103-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-355"><a href="#cb103-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-356"><a href="#cb103-356" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(happy, happy<span class="sc">$</span>Continent <span class="sc">!=</span> <span class="st">"Australia"</span>), <span class="fu">aes</span>(<span class="at">x =</span> Dystopia.Residual, <span class="at">y =</span> Happiness.Score)) <span class="sc">+</span> </span>
<span id="cb103-357"><a href="#cb103-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Continent), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  </span>
<span id="cb103-358"><a href="#cb103-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> Continent, <span class="at">fill =</span> Continent), </span>
<span id="cb103-359"><a href="#cb103-359" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb103-360"><a href="#cb103-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent) <span class="sc">+</span></span>
<span id="cb103-361"><a href="#cb103-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatter plot with regression line (Happiness Score &amp; Dystopia Residual)"</span>)</span>
<span id="cb103-362"><a href="#cb103-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-363"><a href="#cb103-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-364"><a href="#cb103-364" aria-hidden="true" tabindex="-1"></a>All continents act pretty the same regarding dystopia residual.</span>
<span id="cb103-365"><a href="#cb103-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-366"><a href="#cb103-366" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction using Regression Models</span></span>
<span id="cb103-367"><a href="#cb103-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-368"><a href="#cb103-368" aria-hidden="true" tabindex="-1"></a>In this section, we will implement several machine learning algorithms to predict happiness score. First, we should split our dataset into training and test set. Our dependent variable is happiness score, and the independent variables are family, economy, life expectancy, trust, freedom, generosity, and dystopia residual.</span>
<span id="cb103-369"><a href="#cb103-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-370"><a href="#cb103-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-371"><a href="#cb103-371" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the dataset into the Training set and Test set</span></span>
<span id="cb103-372"><a href="#cb103-372" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb103-373"><a href="#cb103-373" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> happy[<span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb103-374"><a href="#cb103-374" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">sample.split</span>(dataset<span class="sc">$</span>Happiness.Score, <span class="at">SplitRatio =</span> <span class="fl">0.8</span>)</span>
<span id="cb103-375"><a href="#cb103-375" aria-hidden="true" tabindex="-1"></a>training_set <span class="ot">=</span> <span class="fu">subset</span>(dataset, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-376"><a href="#cb103-376" aria-hidden="true" tabindex="-1"></a>test_set <span class="ot">=</span> <span class="fu">subset</span>(dataset, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-377"><a href="#cb103-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-378"><a href="#cb103-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-379"><a href="#cb103-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-380"><a href="#cb103-380" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting Multiple Linear Regression to the Training set</span></span>
<span id="cb103-381"><a href="#cb103-381" aria-hidden="true" tabindex="-1"></a>regressor_lm <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> Happiness.Score <span class="sc">~</span> .,</span>
<span id="cb103-382"><a href="#cb103-382" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> training_set)</span>
<span id="cb103-383"><a href="#cb103-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-384"><a href="#cb103-384" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regressor_lm)</span>
<span id="cb103-385"><a href="#cb103-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-386"><a href="#cb103-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-387"><a href="#cb103-387" aria-hidden="true" tabindex="-1"></a>The summary shows that all independent variables have a significant impact, and adjusted R squared is 1! As we discussed, it is clear that there is a linear correlation between dependent and independent variables. Again, I should mention that the sum of the independent variables is equal to the dependent variable which is the happiness score. This is the justification for having an adjusted R squared equals to 1. As a result, I guess Multiple Linear Regression will predict happiness scores with 100 % accuracy!</span>
<span id="cb103-388"><a href="#cb103-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-389"><a href="#cb103-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-390"><a href="#cb103-390" aria-hidden="true" tabindex="-1"></a><span class="do">####### Predicting the Test set results</span></span>
<span id="cb103-391"><a href="#cb103-391" aria-hidden="true" tabindex="-1"></a>y_pred_lm <span class="ot">=</span> <span class="fu">predict</span>(regressor_lm, <span class="at">newdata =</span> test_set)</span>
<span id="cb103-392"><a href="#cb103-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-393"><a href="#cb103-393" aria-hidden="true" tabindex="-1"></a>Pred_Actual_lm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">Prediction =</span> y_pred_lm, <span class="at">Actual =</span> test_set<span class="sc">$</span>Happiness.Score))</span>
<span id="cb103-394"><a href="#cb103-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-395"><a href="#cb103-395" aria-hidden="true" tabindex="-1"></a>gg.lm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Pred_Actual_lm, <span class="fu">aes</span>(Actual, Prediction )) <span class="sc">+</span></span>
<span id="cb103-396"><a href="#cb103-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb103-397"><a href="#cb103-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multiple Linear Regression"</span>, <span class="at">x =</span> <span class="st">"Actual happiness score"</span>,</span>
<span id="cb103-398"><a href="#cb103-398" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted happiness score"</span>) <span class="sc">+</span></span>
<span id="cb103-399"><a href="#cb103-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> (<span class="dv">15</span>)), </span>
<span id="cb103-400"><a href="#cb103-400" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">10</span>)))</span>
<span id="cb103-401"><a href="#cb103-401" aria-hidden="true" tabindex="-1"></a>gg.lm</span>
<span id="cb103-402"><a href="#cb103-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-403"><a href="#cb103-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-404"><a href="#cb103-404" aria-hidden="true" tabindex="-1"></a>As we expected, actual versus predicted plot shows the accuracy of our model.</span>
<span id="cb103-405"><a href="#cb103-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-406"><a href="#cb103-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-407"><a href="#cb103-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting Multiple Linear Regression to the Training set</span></span>
<span id="cb103-408"><a href="#cb103-408" aria-hidden="true" tabindex="-1"></a>regressor_lm_2 <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> happy<span class="sc">$</span>Happiness.Score <span class="sc">~</span> happy<span class="sc">$</span>Trust<span class="sc">+</span>happy<span class="sc">$</span>Life.Expectancy<span class="sc">+</span> happy<span class="sc">$</span>Generosity <span class="sc">+</span> happy<span class="sc">$</span>Economy<span class="sc">+</span> happy<span class="sc">$</span>Family <span class="sc">+</span> happy<span class="sc">$</span>Freedom<span class="sc">+</span>happy<span class="sc">$</span>Dystopia.Residual,</span>
<span id="cb103-409"><a href="#cb103-409" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> training_set)</span>
<span id="cb103-410"><a href="#cb103-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-411"><a href="#cb103-411" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regressor_lm_2)</span>
<span id="cb103-412"><a href="#cb103-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-413"><a href="#cb103-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-414"><a href="#cb103-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE, error=FALSE}</span></span>
<span id="cb103-415"><a href="#cb103-415" aria-hidden="true" tabindex="-1"></a><span class="do">####### Predicting the Test set results</span></span>
<span id="cb103-416"><a href="#cb103-416" aria-hidden="true" tabindex="-1"></a>y_pred_lm <span class="ot">=</span> <span class="fu">predict</span>(regressor_lm_2, <span class="at">newdata =</span> test_set)</span>
<span id="cb103-417"><a href="#cb103-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-418"><a href="#cb103-418" aria-hidden="true" tabindex="-1"></a>Pred_Actual_lm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">Prediction =</span> y_pred_lm, <span class="at">Actual =</span> test_set<span class="sc">$</span>Happiness.Score))</span>
<span id="cb103-419"><a href="#cb103-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-420"><a href="#cb103-420" aria-hidden="true" tabindex="-1"></a>gg.lm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Pred_Actual_lm, <span class="fu">aes</span>(Actual, Prediction )) <span class="sc">+</span></span>
<span id="cb103-421"><a href="#cb103-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb103-422"><a href="#cb103-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multiple Linear Regression"</span>, <span class="at">x =</span> <span class="st">"Actual happiness score"</span>,</span>
<span id="cb103-423"><a href="#cb103-423" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Predicted happiness score"</span>) <span class="sc">+</span></span>
<span id="cb103-424"><a href="#cb103-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> (<span class="dv">15</span>)), </span>
<span id="cb103-425"><a href="#cb103-425" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Helvetica"</span>, <span class="at">size =</span> (<span class="dv">10</span>)))</span>
<span id="cb103-426"><a href="#cb103-426" aria-hidden="true" tabindex="-1"></a>gg.lm</span>
<span id="cb103-427"><a href="#cb103-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-428"><a href="#cb103-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-429"><a href="#cb103-429" aria-hidden="true" tabindex="-1"></a>\</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>