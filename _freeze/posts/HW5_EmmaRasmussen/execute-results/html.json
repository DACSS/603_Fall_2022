{
  "hash": "ae84261a269b6e8b08ec12044ce59a43",
  "result": {
    "markdown": "---\ntitle: \"Homework 5\"\ndate: \"12/1/2022\"\nformat:\n  html:\n    toc: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(alr4)\nlibrary(smss)\nlibrary(stats)\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(stargazer): there is no package called 'stargazer'\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(house.selling.price.2)\nhead(house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      P    S Be Ba New\n1  48.5 1.10  3  1   0\n2  55.0 1.01  3  2   0\n3  68.0 1.45  3  2   0\n4 137.0 2.40  3  3   0\n5 309.4 3.30  4  3   1\n6  17.5 0.40  1  1   0\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(P~ S + Be + Ba + New, data=house.selling.price.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n##1a. \n\nBeds would be deleted first in backwards elimintation because it has the highest p-value.\n\n##1b. \n\nFor forward selection, size would be added first because it has the strongest correlation with price according the the correlation matrix.\n\n##1c. \n\nThe BEDS variable is likely captured in the model by size and baths, so once all are included it is no longer significant. \n\n##1d. \n\nUsing software with these four predictors, find the model that would be selected using each criterion:\n\n::: {.cell}\n\n```{.r .cell-code}\n#All variables\nsummary(lm(P~ S + Be + Ba + New, data=house.selling.price.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_a<-lm(P~ S + Be + Ba + New, data=house.selling.price.2)\n\n#All variables, and interaction term\nsummary(lm(P~ S + Be + Ba + New + S*New, data=house.selling.price.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New + S * New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.258  -8.823   0.561  11.581  39.564 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -30.214     11.461  -2.636 0.009926 ** \nS             58.874      5.361  10.982  < 2e-16 ***\nBe            -3.884      3.647  -1.065 0.289895    \nBa            19.840      5.192   3.821 0.000249 ***\nNew          -35.838     13.650  -2.625 0.010223 *  \nS:New         31.449      7.560   4.160 7.45e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.03 on 87 degrees of freedom\nMultiple R-squared:  0.8906,\tAdjusted R-squared:  0.8843 \nF-statistic: 141.7 on 5 and 87 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_b<-lm(P~ S + Be + Ba + New + S*New, data=house.selling.price.2)\n\n#Beds removed, with interatction\nsummary(lm(P~ S + Ba + New + S*New, data=house.selling.price.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Ba + New + S * New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-35.319  -8.329   0.140  11.705  42.302 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -39.088      7.874  -4.964 3.35e-06 ***\nS             55.496      4.325  12.831  < 2e-16 ***\nBa            21.041      5.072   4.149 7.69e-05 ***\nNew          -35.661     13.660  -2.611   0.0106 *  \nS:New         30.855      7.545   4.089 9.54e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.04 on 88 degrees of freedom\nMultiple R-squared:  0.8892,\tAdjusted R-squared:  0.8842 \nF-statistic: 176.5 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_c<-lm(P~ S + Ba + New + S*New, data=house.selling.price.2)\n\n#Beds removed, no interaction\nsummary(lm(P~ S + Ba + New, data=house.selling.price.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nBa            20.072      5.495   3.653 0.000438 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_d<-lm(P~ S + Ba + New, data=house.selling.price.2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstargazer(fit_a, fit_b, fit_c, fit_d, type= \"text\", style=\"apsr\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in stargazer(fit_a, fit_b, fit_c, fit_d, type = \"text\", style = \"apsr\"): could not find function \"stargazer\"\n```\n:::\n:::\n\n\n\n###R2 \n\nThe model with the highest R-squared is fit_b (all variables, and the interaction term between size and new)\n\nlm(P~ S + Be + Ba + New + S*New)\n\n###Adjusted R2 \n\nThe model with the highest adjusted R-squared is  also fit_b (but not by much, essentially the same R-squared as the same model without the BEDS variable, so I am skeptical this variable is useful)\n\nlm(P~ S + Be + Ba + New + S*New)\n\n###PRESS\n\n::: {.cell}\n\n```{.r .cell-code}\nPRESS(fit_a)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(fit_a): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(fit_b)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(fit_b): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(fit_c)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(fit_c): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(fit_d)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(fit_d): could not find function \"PRESS\"\n```\n:::\n:::\n\nThe model with the lowest PRESS statistic is fit_c (with the interaction term but no BEDS variable)\nlm(P~ S + Ba + New + S*New)\n\n###AIC \n\nBecause all models have 93 observations, we can compare AIC and BIC. The model that minimizes AIC is fit_c but fit_b is not much worse.\n\nlm(P~ S + Ba + New + S*New)\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(fit_a)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.6225\n```\n:::\n\n```{.r .cell-code}\nAIC(fit_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 775.7515\n```\n:::\n\n```{.r .cell-code}\nAIC(fit_c)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 774.9558\n```\n:::\n\n```{.r .cell-code}\nAIC(fit_d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 789.1366\n```\n:::\n:::\n\n\n\n###BIC \n\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(fit_a)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 805.8181\n```\n:::\n\n```{.r .cell-code}\nBIC(fit_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 793.4797\n```\n:::\n\n```{.r .cell-code}\nBIC(fit_c)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.1514\n```\n:::\n\n```{.r .cell-code}\nBIC(fit_d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 801.7996\n```\n:::\n:::\n\n The model that minimizes BIC is fit_c.\n lm(P~ S + Ba + New + S*New)\n \n##1e. \n\nI prefer fit_c lm(P~ S + Ba + New + S*New) because it performs the best in terms of PRESS, AIC, and BIC, and about the same as the best one for adjusted R-squared. Because we have multiple variables included in the model I prefer to use adjusted R-squared over R-squared.\n\n##2a. \n\n(Data file: trees from base R)\nFrom the documentation:\n“This data set provides measurements of the diameter, height and volume of timber in 31 felled black cherry trees. Note that the diameter (in inches) is erroneously labeled Girth in the data. It is measured at 4 ft 6 in above the ground.”\n\nTree volume estimation is a big deal, especially in the lumber industry. Use the trees data to build a basic model of tree volume prediction. In particular, \n\nfit a multiple regression model with  the Volume as the outcome and Girth  and Height as the explanatory variables\nRun regression diagnostic plots on the model. Based on the plots, do you think any of the regression assumptions is violated?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(trees)\nhead(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Girth Height Volume\n1   8.3     70   10.3\n2   8.6     65   10.3\n3   8.8     63   10.2\n4  10.5     72   16.4\n5  10.7     81   18.8\n6  10.8     83   19.7\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(Volume ~ Height + Girth, data=trees))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Height + Girth, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \nGirth         4.7082     0.2643  17.816  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_trees<-lm(Volume ~ Height + Girth, data=trees)\n```\n:::\n\n##2b. \n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow= c(2,3)); plot(fit_trees, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_EmmaRasmussen_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\nConstant variance (of residuals) appears to be violated from these plots (Residuals vs Fitted is funnel shaped and Scale Location is not linear)\n\n##3a. \n\n::: {.cell}\n\n```{.r .cell-code}\ndata(florida)\nhead(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Gore   Bush Buchanan\nALACHUA   47300  34062      262\nBAKER      2392   5610       73\nBAY       18850  38637      248\nBRADFORD   3072   5413       65\nBREVARD   97318 115185      570\nBROWARD  386518 177279      789\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(Buchanan~ Bush, data=florida))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Buchanan ~ Bush, data = florida)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-907.50  -46.10  -29.19   12.26 2610.19 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 4.529e+01  5.448e+01   0.831    0.409    \nBush        4.917e-03  7.644e-04   6.432 1.73e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 353.9 on 65 degrees of freedom\nMultiple R-squared:  0.3889,\tAdjusted R-squared:  0.3795 \nF-statistic: 41.37 on 1 and 65 DF,  p-value: 1.727e-08\n```\n:::\n\n```{.r .cell-code}\nfit_florida<- (lm(Buchanan~ Bush, data=florida))\npar(mfrow= c(2,3)); plot(fit_florida, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_EmmaRasmussen_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nPalm Beach (and Dade) County appears to be an outlier. Cooks distance is greater than 1, and it has high leverage.\n##3b. \n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(log(Buchanan)~ log(Bush), data=florida))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(Buchanan) ~ log(Bush), data = florida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.96075 -0.25949  0.01282  0.23826  1.66564 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.57712    0.38919  -6.622 8.04e-09 ***\nlog(Bush)    0.75772    0.03936  19.251  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4673 on 65 degrees of freedom\nMultiple R-squared:  0.8508,\tAdjusted R-squared:  0.8485 \nF-statistic: 370.6 on 1 and 65 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit_florida2<- (lm(log(Buchanan)~ log(Bush), data=florida))\npar(mfrow= c(2,3)); plot(fit_florida2, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_EmmaRasmussen_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\nPalm beach could still be an potential outlier according to these plots, but the magnitude is less strong than in the previous plots. \n",
    "supporting": [
      "HW5_EmmaRasmussen_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}