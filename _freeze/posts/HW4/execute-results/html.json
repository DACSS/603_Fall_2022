{
  "hash": "d2a903a09f0ee7ace0242d53e6548770",
  "result": {
    "markdown": "---\ntitle: \"Homework 4\"\nauthor: \"HW4\"\ndescription: \"HW4\"\ndate: \"11/11/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - desriptive statistics \n  - probability\n---\n\n\n# Question 1\n\n## a\n\nFor recent data in Jacksonville, Florida, on y = selling price of home (in dollars), x1 = size of home (in square feet), and x2 = lot size (in square feet), the prediction equation is \ny^ = ???10,536 + 53.8x1 + 2.84x2.\n\nA particular home of 1240 square feet on a lot of 18,000 square feet sold for $145,000. Find the predicted selling price and the residual, and interpret.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n-10536+53.8*1240+2.84*18000 \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 107296\n```\n:::\n:::\n\n$107,297 is the predictive price.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n145000-107296\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37704\n```\n:::\n:::\n\nThe  House was overpaid by 37,704.\n\n\nB.For fixed lot size, how much is the house selling price predicted to increase for each square-foot increase in home size? Why?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx1240 = 53.8*(1240) + 2.84*(18000) - 10536\nx1241 = 53.8*(1241) + 2.84*(18000) - 10536\nx1242 = 53.8*(1242) + 2.84*(18000) - 10536\nx1241-x1240\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 53.8\n```\n:::\n:::\n\n$53.8 \n\n\n::: {.cell}\n\n```{.r .cell-code}\n53.8/2.84\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18.94366\n```\n:::\n:::\n\nThe Lot Size is 19 Square Feet \n\n\n\n\n\nAccording to this prediction equation, for fixed home size, how much would lot size need to increase to have the same impact as a one-square-foot increase in home size?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\ndata(\"salary\")\n\"Female\" <- salary %>%\n  filter(sex == \"Female\")\n\"Male\" <- salary %>%\n  filter(sex == \"Male\")\nt.test(Female$salary, Male$salary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  Female$salary and Male$salary\nt = -1.7744, df = 21.591, p-value = 0.09009\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -7247.1471   567.8539\nsample estimates:\nmean of x mean of y \n 21357.14  24696.79 \n```\n:::\n:::\n\n\nBased on the T test we can conclude that it's a Null Hypothesis. \n\nB.Run a multiple linear regression with salary as the outcome variable and everything else as predictors, including sex. Assuming no interactions between sex and the other predictors, obtain a 95% confidence interval for the difference in salary between males and females.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\"Fit\" <- lm(salary ~ rank + sex + degree + ysdeg + year, data = salary)\nsummary(Fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ rank + sex + degree + ysdeg + year, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15746.05     800.18  19.678  < 2e-16 ***\nrankAssoc    5292.36    1145.40   4.621 3.22e-05 ***\nrankProf    11118.76    1351.77   8.225 1.62e-10 ***\nsexFemale    1166.37     925.57   1.260    0.214    \ndegreePhD    1388.61    1018.75   1.363    0.180    \nysdeg        -124.57      77.49  -1.608    0.115    \nyear          476.31      94.91   5.018 8.65e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nconfint(Fit, level = .95)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %      97.5 %\n(Intercept) 14134.4059 17357.68946\nrankAssoc    2985.4107  7599.31080\nrankProf     8396.1546 13841.37340\nsexFemale    -697.8183  3030.56452\ndegreePhD    -663.2482  3440.47485\nysdeg        -280.6397    31.49105\nyear          285.1433   667.47476\n```\n:::\n:::\n\n\n\n\n\n\n\n\nC.Interpret your finding for each predictor variable; discuss (a) statistical significance, (b) interpretation of the coefficient / slope in relation to the outcome variable and other variables\n\n\nThe only predictive variables are Rank and Year according to the model.\n\n\nChange the baseline category for the rank variable. Interpret the coefficients related to rank again.\n\n::: {.cell}\n\n```{.r .cell-code}\n\"relevel_sex\" <- relevel(salary$sex, ref = \"Female\")\n\n\"New_Fit\" <- lm(salary ~ rank + relevel_sex + degree + ysdeg + year, data = salary)\nsummary(New_Fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ rank + relevel_sex + degree + ysdeg + year, \n    data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     16912.42     816.44  20.715  < 2e-16 ***\nrankAssoc        5292.36    1145.40   4.621 3.22e-05 ***\nrankProf        11118.76    1351.77   8.225 1.62e-10 ***\nrelevel_sexMale -1166.37     925.57  -1.260    0.214    \ndegreePhD        1388.61    1018.75   1.363    0.180    \nysdeg            -124.57      77.49  -1.608    0.115    \nyear              476.31      94.91   5.018 8.65e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nWhen using Relevel, we see a significant change in the coefficient, the coefficient of Gender is negative showing a negative relationship. \n\n\nFinkelstein (1980), in a discussion of the use of regression in discrimination cases, wrote, \"[a] variable may reflect a position or status bestowed by the employer, in which case if there is discrimination in the award of the position or status, the variable may be 'tainted.' \" Thus, for example, if discrimination is at work in promotion of faculty to higher ranks, using rank to adjust salaries before comparing the sexes may not be acceptable to the courts. \n\nExclude the variable rank, refit, and summarize how your findings changed, if they did.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\"Fit_No_Rank\" <- lm(salary ~ sex + degree + ysdeg + year, data = salary)\nsummary(Fit_No_Rank)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + ysdeg + year, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8146.9 -2186.9  -491.5  2279.1 11186.6 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 17183.57    1147.94  14.969  < 2e-16 ***\nsexFemale   -1286.54    1313.09  -0.980 0.332209    \ndegreePhD   -3299.35    1302.52  -2.533 0.014704 *  \nysdeg         339.40      80.62   4.210 0.000114 ***\nyear          351.97     142.48   2.470 0.017185 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3744 on 47 degrees of freedom\nMultiple R-squared:  0.6312,\tAdjusted R-squared:  0.5998 \nF-statistic: 20.11 on 4 and 47 DF,  p-value: 1.048e-09\n```\n:::\n:::\n\n\nWhen Rank is excluded from Predictor variables,variables degree, ysdeg, and year all find an increase in significance. \n\n\n\n\n\n\n\n\nEveryone in this dataset was hired the year they earned their highest degree. It is also known that a new Dean was appointed 15 years ago, and everyone in the dataset who earned their highest degree 15 years ago or less than that has been hired by the new Dean. Some people have argued that the new Dean has been making offers that are a lot more generous to newly hired faculty than the previous one and that this might explain some of the variation in Salary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary$New_Hire <- ifelse(salary$ysdeg <= 15, 1, 0)\n\nNew_Dean <- lm(salary ~ New_Hire + sex + degree , data = salary)\nsummary(New_Dean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ New_Hire + sex + degree, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8260.4 -3557.7  -462.6  3563.2 12098.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    28663       1155  24.821  < 2e-16 ***\nNew_Hire       -7418       1306  -5.679 7.74e-07 ***\nsexFemale      -2716       1433  -1.896    0.064 .  \ndegreePhD      -1227       1372  -0.895    0.375    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4558 on 48 degrees of freedom\nMultiple R-squared:  0.4416,\tAdjusted R-squared:  0.4067 \nF-statistic: 12.65 on 3 and 48 DF,  p-value: 3.231e-06\n```\n:::\n:::\n\n\n\nThe current Model actually shows that New Hires are actually being paid. So being a new hire does not explain the difference.\n\n\n\n\n\n\n\n\n##QUESTION 3\n\n\n\nA.Using the house.selling.price data, run and report regression results modeling y = selling price (in dollars) in terms of size of home (in square feet) and whether the home is new (1 = yes; 0 = no). In particular, for each variable; discuss statistical significance and interpret the meaning of the coefficient.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"smss\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\ndata(\"house.selling.price\")\nPrice_Model <- lm(Price ~ Size + New, data = house.selling.price)\nsummary(Price_Model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Price ~ Size + New, data = house.selling.price)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-205102  -34374   -5778   18929  163866 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -40230.867  14696.140  -2.738  0.00737 ** \nSize           116.132      8.795  13.204  < 2e-16 ***\nNew          57736.283  18653.041   3.095  0.00257 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 53880 on 97 degrees of freedom\nMultiple R-squared:  0.7226,\tAdjusted R-squared:  0.7169 \nF-statistic: 126.3 on 2 and 97 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nB.Report and interpret the prediction equation, and form separate equations relating selling price to size for new and for not new homes.\n\nPrice Increases are done by 116.32 for every additional square foot.\n\n\nFind the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.\n\n\n\n# New Home\n\n::: {.cell}\n\n```{.r .cell-code}\n116.132*(3000) + 17505.416\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 365901.4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n116.132*(3000) - 40230.867\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 308165.1\n```\n:::\n:::\n\n\n\n\n\n\n\n\nD.Fit another model, this time with an interaction term allowing interaction between size and new, and report the regression results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNew_Price_Model <- lm(Price ~ Size + New + Size*New, data = house.selling.price)\nsummary(New_Price_Model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Price ~ Size + New + Size * New, data = house.selling.price)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-175748  -28979   -6260   14693  192519 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -22227.808  15521.110  -1.432  0.15536    \nSize           104.438      9.424  11.082  < 2e-16 ***\nNew         -78527.502  51007.642  -1.540  0.12697    \nSize:New        61.916     21.686   2.855  0.00527 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 52000 on 96 degrees of freedom\nMultiple R-squared:  0.7443,\tAdjusted R-squared:  0.7363 \nF-statistic: 93.15 on 3 and 96 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n\nE.Report the lines relating the predicted selling price to the size for homes that are (i) new, (ii) not new.\n\n\nThe New Size variable has a high significance and Positive Coefficient.This shows both variables together are is a much better combination.\n\n\n\nF. Find the predicted selling price for a home of 3000 square feet that is (i) new, (ii) not new.\n\n::: {.cell}\n\n```{.r .cell-code}\n104.438*(3000) + 61.916*(3000) - 100755.31\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 398306.7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n104.438*(3000) - 22227.808\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 291086.2\n```\n:::\n:::\n\n\n\n\nG.Find the predicted selling price for a home of 1500 square feet that is (i) new, (ii) not new. Comparing to (F), explain how the difference in predicted selling prices changes as the size of home increases.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# New Home\n104.438*(1500) + 61.916*(1500) - 100755.31\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 148775.7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Old Home \n104.438*(1500) - 22227.808\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 134429.2\n```\n:::\n:::\n\n\n\nNewer and Larger homes are the most expensive whereas old smaller houses are least Expensive.\n\n\n3H.Do you think the model with interaction or the one without it represents the relationship of size and new to the outcome price? What makes you prefer one model over another?\n\n\nThe second model I think is better as it has more variability and accounts for the fact that combining Size and New is much better, the signifiance is greatly improved.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}