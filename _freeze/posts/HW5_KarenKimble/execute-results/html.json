{
  "hash": "e1060db8975e949f9d2ba12ebda6023e",
  "result": {
    "markdown": "---\ntitle: \"DACSS 603 HW 5\"\nauthor: \"Karen Kimble\"\ndesription: \"Homework 5 for DACSS 603\"\ndate: \"12/9/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategory: HW5\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setup\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(plyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n------------------------------------------------------------------------------\nYou have loaded plyr after dplyr - this is likely to cause problems.\nIf you need functions from both plyr and dplyr, please load plyr first, then dplyr:\nlibrary(plyr); library(dplyr)\n------------------------------------------------------------------------------\n\nAttaching package: 'plyr'\n\nThe following objects are masked from 'package:dplyr':\n\n    arrange, count, desc, failwith, id, mutate, rename, summarise,\n    summarize\n\nThe following object is masked from 'package:purrr':\n\n    compact\n```\n:::\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n:::\n\n\n## Question 1\n\n### Part A\n\nThe first variable to be deleted would be beds because it has the largest p-value, and backward elimination begins with deleting the variable with the largest p-value.\n\n### Part B\n\nThe first variable added in forward selection would be size because it has the smallest p-value.\n\n### Part C\n\nBeds has such a large p-value despite its correlation with price because it also has strong correlations with other variables. This may cause multicollinearity.\n\n### Part D\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model 1\n\nmodel <- lm(P ~ . , data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nmodel1 <- step(model)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in terms(object): object 'model' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model1): object 'model1' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Model 2\n\nmodel <- lm(P ~ . , data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nmodel2 <- step(model, direction = c(\"forward\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in terms(object): object 'model' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model2): object 'model2' not found\n```\n:::\n:::\n\n\nBased on R-squared, we would want to pick Model 2 since it has a higher R-squared. This model includes all four predictor variables and was picked using forward selection. However, if judging by the Adjusted R-squared criteria, we would want to pick Model 1 since that has a higher Adjusted R-squared. Model 1 was chosen using backward eliminiation and does not include the Bed variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculating PRESS\n\nPRESS <- function(linear.model) {\n\n  pr <- residuals(linear.model)/(1-lm.influence(linear.model)$hat)\n\n  PRESS <- sum(pr^2)\n  \n  return(PRESS)\n}\n\nPRESS(model1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in residuals(linear.model): object 'model1' not found\n```\n:::\n\n```{.r .cell-code}\nPRESS(model2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in residuals(linear.model): object 'model2' not found\n```\n:::\n:::\n\n\nFor the PRESS criteria, the model we would want to pick is Model 1, which was found using backward elimination and only includes New, Bath, and Size as predictor variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(model1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(model1): object 'model1' not found\n```\n:::\n\n```{.r .cell-code}\nAIC(model2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(model2): object 'model2' not found\n```\n:::\n:::\n\n\nJudging by the AIC, Model 1 is a better fit because it has a lower AIC.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(model1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(model1): object 'model1' not found\n```\n:::\n\n```{.r .cell-code}\nBIC(model2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(model2): object 'model2' not found\n```\n:::\n:::\n\n\nModel 1 is also a better fit from the BIC criteria because it also has a lower BIC. Overall, judging by all five criteria, Model 1 would be the best fit since it has better results in four out of the five.\n\n### Part E\n\nAs stated before, Model 1 has better results in four out of the five criteria (Adjusted R-Squared, PRESS, AIC, and BIC). Thus, the model I would prefer overall is Model 1, which omitted the Bed variable. The Bed variable also had an extremely high p-value compared to the other variables, so it would make sense to construct a model without it.\n\n## Question 2\n\n### Part A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Volume ~ Girth + Height, data = trees)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### Part B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(model)\n```\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n:::\n\n\nThere are some regression assumptions that are violated because of the data present in the plots. In the Residuals vs. Fitted plot, the line is not linear, indicating that the variances of the error terms are not equal and there may not be a linear relationship. The Scale-Location plot also shows a non-linear line, indicating that the assumption of constant variance is violated. The other two plots, Normal Q-Q and Residuals vs. Leverage, are normal.\n\n## Question 3\n\n### Part A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Buchanan ~ Bush, data = florida)\nplot(model)\n```\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n:::\n\n\nPalm Beach is an outlier based on the diagnostic plots for the model because, while all the other data points are fairly close together, the Palm Beach data point is extremely far in each plot. Additionally, in the Residuals vs. Leverage plot, the Palm Beach point is outside of Cook's distance, meaning it is an outlier with extreme influence on the data.\n\n### Part B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(log(Buchanan) ~ log(Bush), data = florida)\nplot(model)\n```\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_KarenKimble_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n:::\n\n\nThe findings do change somewhat because in the new model using logs, the Palm Beach data point is now inside Cook's distance, meaning it has less influence over the data and is less of an outlier. The distance between Palm Beach and the other data points has been reduced, but it still seems to remain somewhat of an outlier but much less than in the previous model.\n\n\n\n\n",
    "supporting": [
      "HW5_KarenKimble_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}