{
  "hash": "85d7f6135da8a92dfc687a16d857abbe",
  "result": {
    "markdown": "---\ntitle: \"Homework 4 Solution\"\nauthor: \"Dane Shelton\"\ndesription: \"Multiple Linear Regression\"\ndate: \"11/14/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw4\n  - shelton\n---\n\n\n\n\n\n## Homework 4\n\n:::panel-tabset\n\n## Q1\n\n### (a)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(pred_1 <- -10536 + 53.8*(1240) + 2.84*(18000))\n## [1] 107296\n\n(resid_1 <- 145000 - pred_1)\n## [1] 37704\n```\n:::\n\n\n- The model provided predicts the selling price of a 1,240-sqft house build on a 18,000-sqft lot to be $107,296.\n\n- The residual **(Actual-Predicted)** for this prediction is $37,704. The large positive value indicated the model under-predicts selling price for this house. \n\n- The high residual could be due to a competitive market (cash offers, bidding, etc.), location, or even amenities/renovations within the house, all confounders the model doesn't account for.\n\n### (b)\n\n- When lot size is fixed, the model predicts selling price to increase $53.80 for each 1-sqft increase in house size.\n\n### (c)\n\n- $53.8/2.84 = 18.94$ For fixed home size, lot size would need to increase by 18.94-sqft to have the same effect as a one unit increase in home size.\n\n## Q2\n\n### (a)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary <- alr4::salary\n\n(by_sex <- t.test(formula=`salary`~`sex`, data=salary))\n## \n## \tWelch Two Sample t-test\n## \n## data:  salary by sex\n## t = 1.7744, df = 21.591, p-value = 0.09009\n## alternative hypothesis: true difference in means between group Male and group Female is not equal to 0\n## 95 percent confidence interval:\n##  -567.8539 7247.1471\n## sample estimates:\n##   mean in group Male mean in group Female \n##             24696.79             21357.14\n```\n:::\n\nAt `alpha=0.05` we do not have sufficient evidence to reject the null hypothesis, **H0: There is no difference in Male and Female mean salaries**. We cannot conclude a difference exists between male and female salaries.\n\n\n### (b)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary_1 <- lm(salary ~.,\n               data = salary)\nsummary(salary_1)\n## \n## Call:\n## lm(formula = salary ~ ., data = salary)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -4045.2 -1094.7  -361.5   813.2  9193.1 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 15746.05     800.18  19.678  < 2e-16 ***\n## degreePhD    1388.61    1018.75   1.363    0.180    \n## rankAssoc    5292.36    1145.40   4.621 3.22e-05 ***\n## rankProf    11118.76    1351.77   8.225 1.62e-10 ***\n## sexFemale    1166.37     925.57   1.260    0.214    \n## year          476.31      94.91   5.018 8.65e-06 ***\n## ysdeg        -124.57      77.49  -1.608    0.115    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 2398 on 45 degrees of freedom\n## Multiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \n## F-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n\nprint('95% Confidence Interval:')\n## [1] \"95% Confidence Interval:\"\n\n(confint.lm(salary_1, level = 0.95))\n##                  2.5 %      97.5 %\n## (Intercept) 14134.4059 17357.68946\n## degreePhD    -663.2482  3440.47485\n## rankAssoc    2985.4107  7599.31080\n## rankProf     8396.1546 13841.37340\n## sexFemale    -697.8183  3030.56452\n## year          285.1433   667.47476\n## ysdeg        -280.6397    31.49105\n```\n:::\n\n\nWe can see the results of our hypothesis test in **(a)** are confirmed by the confidence interval for `sexFemale` which contains 0.\n\n### (c)\n\n**degreePhD: 1388.61, p-value 0.180** \n\n- `degree` is a categorical variable with 2 levels: Masters and PhD. Our coefficient of 1388.61 suggests that with all other variables held constant, the model finds the difference in mean salary between PhD recipients and Masters recipients at the university to be $1388.61, with faculty holding a PhD earning more.\n\n- The p-value of 0.180 indicates that the variable is not significant at the `alpha= .05` level, we cannot conclude that degree level is useful in predicting `salary` at the university *(H0: B slope degreePhD = 0)*. There is not a significant difference between salary of Masters and Phd faculty.\n\n\n**rankAssoc: 5292.36, p-value .00003**\n\n- `rank` is a categorical variable with 3 levels: `Asst`,`Assoc`, `Prof`, representing the rank of a faculty member. `Asst` is the base category in this model, so our coefficient of 5292.36 suggests that with all other variables held constant, there is a $5,292.36 difference in mean salary between Assistant and Associate professors on campus, with associate professors earning more.\n\n- the p-value is far below our default `alpha=0.05`. We can reject the null hypothesis that the effect is 0, and conclude that there is a difference between the salaries of the groups `Asst` and `Assoc`, the variable is significant in predicting `salary`.\n\n**rankProf: 11118.76, p-value: < 0.005**\n\n- A coefficient of 11118.76 suggests that with all other variables held constant, there is a $11,118.76 difference in mean salary between Assistant and full Professors on campus, with full Professors earning more.\n\n- the p-value is far below our default `alpha=0.05`. We can reject the null hypothesis that the effect is 0, and conclude that there is a difference between the salaries of the groups `Asst` and `Prof`, the variable is significant in predicting `salary`.\n\n**sexFemale: 1166.37, p-value 0.214**\n\n- `sex` is a categorical varible with two levels: `Male` and `Female`. A coefficient of 1166.37 indicated that with all other variables held constant, the model observed a $1,166.37 difference in mean salary between males and females, with females earning more.\n\n- the p-value of 0.214  is greater than our alpha value, indicating this variable is not useful in predicting `salary` of faculty members. We cannot conclude there is a significant difference between earnings of different `sex` levels.\n\n**year: 476.31, p-value < .0005**\n\n- `year` is a continuous variable describing the number of years a faculty member has spent at their current rank. A coefficient of 476.31 suggests that with all other variables held constant, a 1 year increase in experience at a particular `rank` will result in a $476.31 increase in predicted salary.\n\n- the p-value is far below our default `alpha=0.05`. We can reject the null hypothesis that the effect is 0, and conclude the variable is significant in predicting `salary`.\n\n**ysdeg: -124.57, p-value 0.115**\n\n- `ysdeg` is a continuous variable describing the number of years since a faculty member earned their highest degree. A coefficient of -124.57 suggests that with all other variables held constant, a 1 year increase in years since highest degree earned will result in a $124.57 decrease in predicted salary.\n\n- the p-value of 0.115  is greater than our alpha value, indicating this variable is not useful in predicting `salary` of faculty members. We cannot conclude there is a significant relationship between `salary` and `ysdeg`.\n\n### (d)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrank_redo<- salary %>%\n              mutate(rank=relevel(rank, ref = 'Prof'))\n \n# refit model\nsalary_2 <- lm(salary ~.,\n               data = rank_redo)\nsummary(salary_2)\n## \n## Call:\n## lm(formula = salary ~ ., data = rank_redo)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -4045.2 -1094.7  -361.5   813.2  9193.1 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  26864.81    1375.29  19.534  < 2e-16 ***\n## degreePhD     1388.61    1018.75   1.363    0.180    \n## rankAsst    -11118.76    1351.77  -8.225 1.62e-10 ***\n## rankAssoc    -5826.40    1012.93  -5.752 7.28e-07 ***\n## sexFemale     1166.37     925.57   1.260    0.214    \n## year           476.31      94.91   5.018 8.65e-06 ***\n## ysdeg         -124.57      77.49  -1.608    0.115    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 2398 on 45 degrees of freedom\n## Multiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \n## F-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n\n\n- While the difference in predicted mean `salary` remains the same for the `Assist` group, after changing the reference level of the variable from `Assistant` to `Professor`, the relationship between full professors and associate professors has changed. Associate professors are seen to make $5,826.40 less than full professors, a 534 dollar increase (in value) from the model where `Assistants` are used the point of reference.\n\n### (e)\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary_3 <- lm(salary ~ . - rank,\n               data = salary)\nsummary(salary_3)\n## \n## Call:\n## lm(formula = salary ~ . - rank, data = salary)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -8146.9 -2186.9  -491.5  2279.1 11186.6 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) 17183.57    1147.94  14.969  < 2e-16 ***\n## degreePhD   -3299.35    1302.52  -2.533 0.014704 *  \n## sexFemale   -1286.54    1313.09  -0.980 0.332209    \n## year          351.97     142.48   2.470 0.017185 *  \n## ysdeg         339.40      80.62   4.210 0.000114 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 3744 on 47 degrees of freedom\n## Multiple R-squared:  0.6312,\tAdjusted R-squared:  0.5998 \n## F-statistic: 20.11 on 4 and 47 DF,  p-value: 1.048e-09\n```\n:::\n\n- While `sex` is still insignificant in the model for predicting salary, we see the value of the coefficient change sign, along with `ysdeg`. \n\n- Two variables are now considered significant that were previously in predicting `salary` when `rank` was included in the model, `ysdeg` and `degree`.\n\n### (f)\n\n::: {.cell}\n\n```{.r .cell-code}\ndean_edit <- salary %>%\n              mutate(dean = \n                       case_when(`ysdeg` > 15 ~ 'Old',\n                                 `ysdeg` <= 15 ~ 'New'))\nsalary_4 <- lm(salary ~ . - rank - ysdeg,\n               data = dean_edit)\nsummary(salary_4)\n## \n## Call:\n## lm(formula = salary ~ . - rank - ysdeg, data = dean_edit)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -10740.1  -2550.1     -3.3   1942.4  11718.3 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  18148.9     1188.2  15.274  < 2e-16 ***\n## degreePhD    -1186.6     1191.2  -0.996 0.324267    \n## sexFemale     -523.5     1355.1  -0.386 0.701017    \n## year           531.4      130.2   4.082 0.000172 ***\n## deanOld       4449.8     1347.2   3.303 0.001834 ** \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 3958 on 47 degrees of freedom\n## Multiple R-squared:  0.5878,\tAdjusted R-squared:  0.5527 \n## F-statistic: 16.75 on 4 and 47 DF,  p-value: 1.338e-08\n```\n:::\n\n\n- I removed `rank` and `ysdeg` as both could  exhibit multicollinearity with the hiring of the new Dean. Knowing the `dean` appointed newer graduates upon their appointment would allow `ysdeg` to predict `dean` for those with under 15 years of their degree; also one can progress through `ranks` within 15 years so this could correlate with `dean` also.\n\n- With a coefficient for `deanOld` of around 4500, the model actually predicts that those hired by the `Old` dean have a higher mean `salary` as a group compared to those hired by the `New` dean, contrary to the suggested hypothesis.\n\n## Q3\n\n### (a)\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"house.selling.price\")\nhouse <- house.selling.price\n\nhouse_1 <- lm(Price ~ Size+New, data=house)\nsummary(house_1)\n## \n## Call:\n## lm(formula = Price ~ Size + New, data = house)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -205102  -34374   -5778   18929  163866 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -40230.867  14696.140  -2.738  0.00737 ** \n## Size           116.132      8.795  13.204  < 2e-16 ***\n## New          57736.283  18653.041   3.095  0.00257 ** \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 53880 on 97 degrees of freedom\n## Multiple R-squared:  0.7226,\tAdjusted R-squared:  0.7169 \n## F-statistic: 126.3 on 2 and 97 DF,  p-value: < 2.2e-16\n```\n:::\n\n**Size: 116.132, p-value < .005**\n\n- `Size` is a continuous variable with a positive coefficient of 116.132 suggesting that for every one sqft increase, predicted `Price` will increase by $116.13, `New` held constant.\n\n**New: 57736.28, p-value < .005**\n\n- `New` is a categorical variable with two levels, `new=1` and `old=0`. The coefficient of 57736.28 suggests that as a group, our model predicts new houses to have a mean selling price that is $57,736.28 greater than old houses of the same size.\n\n**Both variables are significant at `alpha=0.05`, indicating that they are useful in predicting `price` for our data, their effect has a magnitude different from zero.**\n\n### (b)\n\nThe full prediction equation follows the form $Price = -40230.867 + 116.132*Size + 57736.28*New$\n\nInterpretation of variables, coefficients, and p-values are in (a).\n\n**New Homes:** $Price = -40230.867 + 116.132*Size + 57736.28$\n\n**Old Homes:** $Price = -40230.867 + 116.132*Size$\n\n### (c)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_3000 <- data.frame(`Size`=3000,`New`=1)\nnew_pred <- predict(house_1, newdata=new_3000)\nprint(c('New 3000 sqft House:',new_pred))\n##                                             1 \n## \"New 3000 sqft House:\"     \"365900.183656625\"\n\nold_3000 <- data.frame(`Size`=3000,`New`=0)\nold_pred <- predict(house_1, newdata=old_3000)\nprint(c('Old 3000 sqft House:',old_pred))\n##                                             1 \n## \"Old 3000 sqft House:\"     \"308163.900855831\"\n```\n:::\n\n\n\n### (d)\n\n::: {.cell}\n\n```{.r .cell-code}\nhouse_2 <- lm(Price ~ Size+New+ Size*New, data=house)\nsummary(house_2)\n## \n## Call:\n## lm(formula = Price ~ Size + New + Size * New, data = house)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -175748  -28979   -6260   14693  192519 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -22227.808  15521.110  -1.432  0.15536    \n## Size           104.438      9.424  11.082  < 2e-16 ***\n## New         -78527.502  51007.642  -1.540  0.12697    \n## Size:New        61.916     21.686   2.855  0.00527 ** \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 52000 on 96 degrees of freedom\n## Multiple R-squared:  0.7443,\tAdjusted R-squared:  0.7363 \n## F-statistic: 93.15 on 3 and 96 DF,  p-value: < 2.2e-16\n```\n:::\n\n### (e)\n\nThe full prediction equation follows the form $Price = -22227.808 + 104.438*Size -78527.502*New + 61.916*Size:New$\n\nInterpretation of variables, coefficients, and p-values are in (a).\n\n**New Homes:** $Price = -22227.808 + 104.438*Size -78527.502 + 61.916*Size$\n\n**Old Homes:** $Price = -22227.808 + 104.438*Size$\n\n### (f)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_3000_int <- data.frame(`Size`=3000,`New`=1)\nnew_pred_int <- predict(house_2, newdata=new_3000_int)\nprint(c('New 3000 sqft House:',new_pred_int))\n##                                             1 \n## \"New 3000 sqft House:\"     \"398307.512638058\"\n\nold_3000_int <- data.frame(`Size`=3000,`New`=0)\nold_pred_int <- predict(house_2, newdata=old_3000_int)\nprint(c('Old 3000 sqft House:',old_pred_int))\n##                                             1 \n## \"Old 3000 sqft House:\"     \"291087.363770394\"\n```\n:::\n\n\n### (g)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_1500_int <- data.frame(`Size`=1500,`New`=1)\nnew_pred_int2 <- predict(house_2, newdata=new_1500_int)\nprint(c('New 1500 sqft House:',new_pred_int2))\n##                                             1 \n## \"New 1500 sqft House:\"     \"148776.101180188\"\n\nold_1500_int <- data.frame(`Size`=1500,`New`=0)\nold_pred_int2 <- predict(house_2, newdata=old_1500_int)\nprint(c('Old 1500 sqft House:',old_pred_int2))\n##                                             1 \n## \"Old 1500 sqft House:\"     \"134429.777919781\"\n```\n:::\n\n\n- The difference in price between old and new homes increases with an increase in size. The impact of New has a different magnitude at different sizes.\n\n### (h)\n\n- I would select the model with an interaction term has it has a larger Adjusted R-sq value as well as a smaller Residual Standard Error value, indicating a slighly better fit than the model without interactions.\n\n\n\nEND TABS\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}