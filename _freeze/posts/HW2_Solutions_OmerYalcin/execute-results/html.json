{
  "hash": "7185d4f58c1b0681167cbeb09996d5de",
  "result": {
    "markdown": "---\ntitle: \"Homework 2\"\nauthor: \"Omer Yalcin\"\ndescription: \"The second homework on hypothesis testing and confidence intervals\"\ndate: \"11/01/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: false \n    code-copy: true\n    code-tools: true\ncategories:\n  - hw2\n  - hypothesis testing\n  - confidence intervals\n---\n\n\nPlease check your answers against the solutions.\n\n## Question 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbypass_n = 539\nangio_n = 847\n\nbypass_sample_mean = 19\nangio_sample_mean = 18\n\nbypass_sample_sd = 10\nangio_sample_sd = 9\n\nbypass_se = bypass_sample_sd/sqrt(bypass_n)\nangio_se = angio_sample_sd/sqrt(angio_n)\n\nbypass_me = qt(0.95, df = bypass_n - 1)*bypass_se\nangio_me = qt(0.95, df = angio_n - 1)*angio_se\n```\n:::\n\n\nThe confidence intervals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(bypass_sample_mean + c(-bypass_me, bypass_me))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18.29029 19.70971\n```\n:::\n\n```{.r .cell-code}\nprint(angio_sample_mean + c(-angio_me, angio_me))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.49078 18.50922\n```\n:::\n:::\n\n\nThe size of the confidence intervals, which is twice the margin of error:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n2 * bypass_me\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.419421\n```\n:::\n\n```{.r .cell-code}\n2 * angio_me\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.018436\n```\n:::\n:::\n\n\nThe confidence interval for angiography is narrower.\n\n## Question 2\n\none-step solution:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 1031\nk = 567\nprop.test(k, n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\t1-sample proportions test with continuity correction\n\ndata:  k out of n, null probability 0.5\nX-squared = 10.091, df = 1, p-value = 0.00149\nalternative hypothesis: true p is not equal to 0.5\n95 percent confidence interval:\n 0.5189682 0.5805580\nsample estimates:\n        p \n0.5499515 \n```\n:::\n:::\n\n\nAlternatively:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_hat <- k/n # point estimate\nse = sqrt((p_hat*(1-p_hat))/n) # standard error\ne = qnorm(0.975)*se # margin of error\np_hat + c(-e, e) # confidence interval \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5195839 0.5803191\n```\n:::\n:::\n\n\nAlternatively, we can use the exact binomial test. In large samples like the one we have, the results should essentially be the same as prop.test().\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom.test(k, n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tExact binomial test\n\ndata:  k and n\nnumber of successes = 567, number of trials = 1031, p-value = 0.001478\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.5189927 0.5806243\nsample estimates:\nprobability of success \n             0.5499515 \n```\n:::\n:::\n\n## Question 3\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrange = 200-30\npopulation_sd = range/4\n```\n:::\n\n\nRemember:\n\n$$CI_{95} = \\bar x \\pm z \\frac{s}{\\sqrt n}$$\n(We can use $z$ because we assume population standard deviation is known.)\n\nWe want the number $n$ that ensures:\n\n$$ z \\frac{s}{\\sqrt n} = 5 $$\n$$ zs = 5 \\sqrt n$$\n$$ \\frac{zs}{5} = \\sqrt n$$\n$$  (\\frac{zs}{5})^2 = n$$\n\nIn our case:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nz = qnorm(.975)\ns = population_sd\nn = ((z *s) / 5)^2\nprint(n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 277.5454\n```\n:::\n:::\n\n\nRounding up, we need a sample of 278.\n\n\n## Question 4\n\nWe can write a function to find the t-statistic, and then do all the tests in a, b, and c using that.\n\n$$t = \\frac{\\bar x - \\mu}{s / \\sqrt n}$$\n\nwhere $\\bar x$ is them sample mean, $\\mu$ is the hypothesizes population mean, $s$ is the sample standard deviation, and $n$ is the sample size.\n\nWriting this in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_t_stat <- function(x_bar, mu, sd, n){\n  return((x_bar - mu) / (sd / sqrt(n)))\n}\n```\n:::\n\n\n\nFind the t-statistic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_stat <- get_t_stat(x_bar = 410, mu = 500, sd = 90, n = 9)\n```\n:::\n\n\n### A\n\nTwo-tailed test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 9\npval_two_tail = 2*pt(t_stat, df = n-1)\npval_two_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01707168\n```\n:::\n:::\n\n\nWe can reject the hypothesis that population mean is 500.\n\n### B\n\n\n::: {.cell}\n\n```{.r .cell-code}\npval_lower_tail = pt(t_stat, df = n-1)\npval_lower_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.008535841\n```\n:::\n:::\n\n\nWe can reject the hypothesis that population mean is greater than 500.\n\n### C\n\n\n::: {.cell}\n\n```{.r .cell-code}\npval_upper_tail = pt(t_stat, df = n-1, lower.tail=FALSE)\npval_upper_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9914642\n```\n:::\n:::\n\n\nWe fail to reject the hypothesis that population mean is less than 500.\n\nAlternatively for C, we could just subtract the answer in B from 1:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pval_lower_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9914642\n```\n:::\n:::\n\n\n\n## Question 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_jones = ((519.5 - 500)/ 10)\nt_smith = ((519.7 - 500)/ 10)\ncat(\"t value for Jones:\", t_jones, '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nt value for Jones: 1.95 \n```\n:::\n\n```{.r .cell-code}\ncat(\"t value for Smith:\", t_smith, '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nt value for Smith: 1.97 \n```\n:::\n\n```{.r .cell-code}\ncat('p value for Jones:', round(2*pt(t_jones, df = 999, lower.tail=FALSE), 4), '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\np value for Jones: 0.0515 \n```\n:::\n\n```{.r .cell-code}\ncat('p value for Smith:', round(2*pt(t_smith, df = 999, lower.tail=FALSE), 4), '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\np value for Smith: 0.0491 \n```\n:::\n:::\n\n\nAt 0.05 level Smith's result is statistically significant but Jones's is not.\nThe result show the arbitrariness of the 0.05 demarcation line and the importance of reporting actual p-values to better make sense of results.\n\n## Question 6:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngas_taxes <- c(51.27, 47.43, 38.89, 41.95, 28.61, 41.29, 52.19, 49.48, 35.02, 48.13, 39.28, 54.41, 41.66, 30.28, 18.49, 38.72, 33.41, 45.02)\n\nt.test(gas_taxes, mu = 45, alternative = 'less')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  gas_taxes\nt = -1.8857, df = 17, p-value = 0.03827\nalternative hypothesis: true mean is less than 45\n95 percent confidence interval:\n     -Inf 44.67946\nsample estimates:\nmean of x \n 40.86278 \n```\n:::\n:::\n\n\n\nIn the one sided test, we are able to reject the null in favor of the alternative that the gas taxes are less than 45 cents.\n\nNote that a two-sided test at the same level would not have resulted in the rejection of the null.\n\nHowever, a two-sided 90% confidence interval gives the same upper bound, since now there is a 5% rejection are on two sides: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(gas_taxes, mu = 45, alternative = 'two.sided', conf.level = 0.9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  gas_taxes\nt = -1.8857, df = 17, p-value = 0.07654\nalternative hypothesis: true mean is not equal to 45\n90 percent confidence interval:\n 37.04610 44.67946\nsample estimates:\nmean of x \n 40.86278 \n```\n:::\n:::",
    "supporting": [
      "HW2_Solutions_OmerYalcin_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}