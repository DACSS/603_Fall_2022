{
  "hash": "343335832d4ddbc1f0eaf1576042b97d",
  "result": {
    "markdown": "---\ntitle: \"Homework 5\"\nauthor: \"Caleb Hill\"\ndesription: \"The fifth homework on regressions\"\ndate: \"12/08/2022\"\nformat:\n  html: \n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n  - regression\n---\n\n\n# Question 1\n\nFirst, let's load the relevant libraries and set all the graph themes to minimal.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nPlease cite as: \n\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n```\n:::\n:::\n\n\n## A\n\nVariables `Beds` would be removed first. It's P-value does not meet statistically significant threshold.\n\n## B\n\nFor the opposite reason, `Size` would be added first.\n\n## C\n\n`Beds` is most likely auto-correlated with `Size`, as bedrooms make up a substantial amount of square footage in a house, driving up the price. However, that is not the only factor if pricing, as is most likely why the number -- which can be high -- does not necessarily mean we see an improved price. Conversely, this is not the case for bathrooms.\n\n## D\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(house.selling.price.2)\nmodel_1 <- lm(P ~ S + Ba, data = house.selling.price.2)\nplot(model_1)\n```\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\nstargazer(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n% Table created by stargazer v.5.2.3 by Marek Hlavac, Social Policy Institute. E-mail: marek.hlavac at gmail.com\n% Date and time: Fri, Dec 09, 2022 - 6:39:51 PM\n\\begin{table}[!htbp] \\centering \n  \\caption{} \n  \\label{} \n\\begin{tabular}{@{\\extracolsep{5pt}}lc} \n\\\\[-1.8ex]\\hline \n\\hline \\\\[-1.8ex] \n & \\multicolumn{1}{c}{\\textit{Dependent variable:}} \\\\ \n\\cline{2-2} \n\\\\[-1.8ex] & P \\\\ \n\\hline \\\\[-1.8ex] \n S & 63.863$^{***}$ \\\\ \n  & (4.840) \\\\ \n  & \\\\ \n Ba & 22.448$^{***}$ \\\\ \n  & (6.130) \\\\ \n  & \\\\ \n Constant & $-$49.752$^{***}$ \\\\ \n  & (9.183) \\\\ \n  & \\\\ \n\\hline \\\\[-1.8ex] \nObservations & 93 \\\\ \nR$^{2}$ & 0.833 \\\\ \nAdjusted R$^{2}$ & 0.829 \\\\ \nResidual Std. Error & 18.267 (df = 90) \\\\ \nF Statistic & 224.114$^{***}$ (df = 2; 90) \\\\ \n\\hline \n\\hline \\\\[-1.8ex] \n\\textit{Note:}  & \\multicolumn{1}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\\\ \n\\end{tabular} \n\\end{table} \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPRESS <- function(model) {\n  i <- residuals(model)/(1 - lm.influence(model)$hat)\n  sum(i^2)\n}\n\nPRESS(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 34174.5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::glance(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squa…¹ sigma stati…²  p.value    df logLik   AIC   BIC devia…³\n      <dbl>        <dbl> <dbl>   <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>   <dbl>\n1     0.833        0.829  18.3    224. 1.12e-35     2  -401.  809.  819.  30033.\n# … with 2 more variables: df.residual <int>, nobs <int>, and abbreviated\n#   variable names ¹​adj.r.squared, ²​statistic, ³​deviance\n```\n:::\n:::\n\n\nNote: observation #5 is an outlier and violates many of these diagnostic plots. If we log transform either P or S, observation #7 does the same. Therefore, we will keep the model as-is and not transform it.\n\nR2 = 0.83\nAdjusted R2 = 0.83\nPRESS = 34.174.5\nAIC = 809.23\nBIC = 819.36\n\n## E\n\nI chose this model as the other two variables `Beds` and `New` either do not meet the P-value threshold or have a low correlation to `Price.` The other two variables have a high correlation with `Price.`\n\n# Question 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(trees)\nhead(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Girth Height Volume\n1   8.3     70   10.3\n2   8.6     65   10.3\n3   8.8     63   10.2\n4  10.5     72   16.4\n5  10.7     81   18.8\n6  10.8     83   19.7\n```\n:::\n:::\n\n\n## A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_q2 <- lm(Volume ~ Girth + Height, data = trees)\n```\n:::\n\n\nFitted.\n\n## B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(model_q2)\n```\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n:::\n\n\nBoth of the Residuals vs. Fitted plots are violated, as they form a U-shape instead of a horizontal line; Cook's Distance plot is violated as row 31 is outside of the 0.5 dotted line. The Normal Q-Q plot seems fine. The Scale Location plot does not look good, as it has a U-shape as well.\n\n# Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(florida)\nhead(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Gore   Bush Buchanan\nALACHUA   47300  34062      262\nBAKER      2392   5610       73\nBAY       18850  38637      248\nBRADFORD   3072   5413       65\nBREVARD   97318 115185      570\nBROWARD  386518 177279      789\n```\n:::\n:::\n\n\n## A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_q3a <- lm(Buchanan ~ Bush, data = florida)\nplot(model_q3a)\n```\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-9-4.png){width=672}\n:::\n:::\n\n\nYes, Palm Beach County is an outlier. This is especially apparent with Cook's Distance plot, as it is outside the 1.0 dotted line.\n\n## B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_q3b <- lm(log(Buchanan) ~ log(Bush), data = florida)\nplot(model_q3b)\n```\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_CalebHill_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n:::\n\n\nThe findings do change, as all observations that violated the tests are now within the lines/meet assumptions.\n\n",
    "supporting": [
      "HW5_CalebHill_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}