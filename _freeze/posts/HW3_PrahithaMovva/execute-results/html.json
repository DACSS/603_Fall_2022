{
  "hash": "9823a77b35d13188b3e1e891e9bf8d80",
  "result": {
    "markdown": "---\ntitle: \"Homework 3 - Prahitha Movva\"\nauthor: \"Prahitha Movva\"\ndescription: \"The third homework\"\ndate: \"10/31/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw3\n  - regression\n  - correlation\n  - covariance\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(stats)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo=TRUE, warning=FALSE)\n```\n:::\n\n\n\n## Question 1\n\n### 1.1.1\n\nThe predictor is ppgdp and the response is fertility because we are studying the dependence of fertility on ppgdp.\n\n### 1.1.2\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=UN11, aes(x=ppgdp, y=fertility))+geom_point()\n```\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThere are very few observations with gross national product per person between 20,000 and 100,000 when compared to those below 20,000 (in addition to the huge dip in fertility). Since the above graph does not seem to exhibit a linear relationship, it is not plausible for it to have a straight-line mean function.\n\n### 1.1.3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=UN11, aes(x=log(ppgdp), y=log(fertility)))+geom_point()\n```\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe can see that as log(ppgdp) increases, log(fertility) decreases linearly. So, we can say that the relationship between these two variables is linear and a simple linear regression model would be plausible.\n\n\n## Question 2\n\n### a\n\nThe slope gets divided by 1.33 due to the conversion from US Dollar to British Pound. So the slope of the British prediction equation will be ~25% less than the US prediction equation. We can also observe this from the below graph, where the British equation is represented in red and the US in blue.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUN11$british.ppgdp <- UN11$ppgdp/1.33\n\nggplot() +\n  geom_smooth(data=UN11, aes(x = british.ppgdp, y = fertility), \n              method = \"lm\", se = FALSE, color = \"red\") + \n  geom_smooth(data=UN11, aes(x = ppgdp, y = fertility), \n              method = \"lm\", se = FALSE, color = \"blue\") + \n  geom_point(data=UN11, aes(x = british.ppgdp, y = fertility), color = \"red\") + \n  geom_point(data=UN11, aes(x = ppgdp, y = fertility), color = \"blue\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### b\n\nThe correlation between the explanatory variable and the response will not change as both will increase 1.33x\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUN11$british.ppgdp <- UN11$ppgdp/1.33\n\ncor(UN11$british.ppgdp, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n\n```{.r .cell-code}\ncor(UN11$ppgdp, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n:::\n\n\n\n## Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(water)\npairs(water)\n```\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nFrom the matrix, we can see that the first three locations - APMAM, APSAB and APSLAKE - are strongly correlated with each other. Similarly, the next three location - OPBPC, OPRC and OPSLAKE - are also correlated with each other. However, the first three locations do not share a strong correlation with the response - BSAAM, whereas the next three locations do. This implies that using one of the last three locations will give a better fit/ predictions for the stream runoff volume. On close inspection, we can further say that OPSLAKE might be a better choice among the last three locations to predict BSAAM.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(water$BSAAM ~ water$OPBPC, data=water))$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7792942\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(water$BSAAM ~ water$OPRC, data=water))$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8419507\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(water$BSAAM ~ water$OPSLAKE, data=water))$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8777515\n```\n:::\n:::\n\n\n\n## Question 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Rateprof)\nhead(Rateprof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gender numYears numRaters numCourses pepper discipline              dept\n1   male        7        11          5     no        Hum           English\n2   male        6        11          5     no        Hum Religious Studies\n3   male       10        43          2     no        Hum               Art\n4   male       11        24          5     no        Hum           English\n5   male       11        19          7     no        Hum           Spanish\n6   male       10        15          9     no        Hum           Spanish\n   quality helpfulness  clarity easiness raterInterest sdQuality sdHelpfulness\n1 4.636364    4.636364 4.636364 4.818182      3.545455 0.5518564     0.6741999\n2 4.318182    4.545455 4.090909 4.363636      4.000000 0.9020179     0.9341987\n3 4.790698    4.720930 4.860465 4.604651      3.432432 0.4529343     0.6663898\n4 4.250000    4.458333 4.041667 2.791667      3.181818 0.9325048     0.9315329\n5 4.684211    4.684211 4.684211 4.473684      4.214286 0.6500112     0.8200699\n6 4.233333    4.266667 4.200000 4.533333      3.916667 0.8632717     1.0327956\n  sdClarity sdEasiness sdRaterInterest\n1 0.5045250  0.4045199       1.1281521\n2 0.9438798  0.5045250       1.0744356\n3 0.4129681  0.5407021       1.2369438\n4 0.9990938  0.5882300       1.3322506\n5 0.5823927  0.6117753       0.9749613\n6 0.7745967  0.6399405       0.6685579\n```\n:::\n\n```{.r .cell-code}\nrates <- Rateprof %>%\n  select(quality, helpfulness, clarity, easiness, raterInterest)\npairs(rates)\n```\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nAll of them have a positive correlation but with different magnitudes. Quality, helpfulness and clarity seem to have a linear relationship with one another with a strong positive correlation. Quality, with easiness and rater interest has a positive correlation but is weak (weaker for rater interest). The plot for easiness and rater interest seems flat amongst all, implying almost no (very weak) correlation.\n\n\n## Question 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(student.survey)\npi.clean <- as.numeric(student.survey$pi)\nre.clean <- as.numeric(student.survey$re)\nmodel.i <- lm(pi.clean ~ re.clean, data=student.survey)\nsummary(model.i)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pi.clean ~ re.clean, data = student.survey)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.81243 -0.87160  0.09882  1.12840  3.09882 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   0.9308     0.4252   2.189   0.0327 *  \nre.clean      0.9704     0.1792   5.416 1.22e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.345 on 58 degrees of freedom\nMultiple R-squared:  0.3359,\tAdjusted R-squared:  0.3244 \nF-statistic: 29.34 on 1 and 58 DF,  p-value: 1.221e-06\n```\n:::\n\n```{.r .cell-code}\nmodel.ii <- lm(hi ~ tv, data = student.survey)\nsummary(model.ii)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = student.survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n:::\n\n\n### a\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=student.survey, aes(x=re, y=pi)) +\n  geom_jitter(data=student.survey, aes(x=re, y=pi), color=\"blue\") +\n  geom_abline(intercept=0.9308, slope=0.9704) +\n  geom_smooth(method='lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nFrom the above visualization, we can also say that as religiosity increases, political ideology becomes more conservative.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=student.survey, aes(x=tv, y=hi)) +\n  geom_point(data=student.survey, aes(x=tv, y=hi), color=\"blue\") +\n  geom_abline(intercept=3.441353, slope=-0.018305) +\n  geom_smooth(method='lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_PrahithaMovva_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nFrom the above visualization, we can say that as the number of hours of TV watching increases, the high school GPA of the student decreases.\n\n### b\n\nIn (i), ~33.6% of the variance in political ideology is explained by religiosity and with 1 unit increase in religiosity, political ideology increases approximately by 0.97 units. We can also see that the p-value for (i) is way below the significance threshold of 0.05 and is therefore statistically significant. Similarly, in (ii), only ~7.2% of the variance in high school GPA is explained by the hours of TV watching. As expected, the p-value for (ii) is less than the usual 0.05 significance threshold but is close to it so it does not exhibit strong statistical significance.\n",
    "supporting": [
      "HW3_PrahithaMovva_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}