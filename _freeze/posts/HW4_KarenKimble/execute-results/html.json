{
  "hash": "a8c7d3f7f84a0b063a62f7a2a650d770",
  "result": {
    "markdown": "---\ntitle: \"DACSS 603 HW 4\"\nauthor: \"Karen Kimble\"\ndesription: \"Homework 4 for DACSS 603\"\ndate: \"11/14/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategory: HW4\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setup\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n:::\n\n\n## Question 1\n\n### Part A\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predicted\n\ny = -10536 + (53.8 * 1240) + (2.84 * 18000)\n\ny\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 107296\n```\n:::\n\n```{.r .cell-code}\n145000 - y\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37704\n```\n:::\n:::\n\n\nThe predicted selling price is 107,296 dollars but the actual selling price was 145,000 dollars, resulting in a residual of 37,704. This means that the predictor model underestimated the selling price by over 37,000 dollars.\n\n### Part B\n\nFor a fixed lot size, the house selling price is predicted to increase by 53.8 for each square foot increase in home size. This is because 53.8 is the coefficient for the square foot variable, meaning that the model estimates this amount of increase for each additional unit of x.\n\n### Part C\n\n\n::: {.cell}\n\n```{.r .cell-code}\n53.8/2.84\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18.94366\n```\n:::\n:::\n\n\nFor a fixed home size, the lot size would need to increase by about 18.94 square feet in order to have an equivalent impact as an additional square foot of home size.\n\n## Question 2\n\n### Part A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(salary ~ sex, data = salary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  salary by sex\nt = 1.7744, df = 21.591, p-value = 0.09009\nalternative hypothesis: true difference in means between group Male and group Female is not equal to 0\n95 percent confidence interval:\n -567.8539 7247.1471\nsample estimates:\n  mean in group Male mean in group Female \n            24696.79             21357.14 \n```\n:::\n:::\n\n\nThe p-value from the t-test 0.09, greater than a 0.05 significance level. This indicates that there is not statistically significant evidence to reject the hypothesis that the mean salary for men and women are the same.\n\n### Part B\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(salary ~ sex + degree + rank + year + ysdeg, data = salary)\nconfint(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 2.5 %      97.5 %\n(Intercept) 14134.4059 17357.68946\nsexFemale    -697.8183  3030.56452\ndegreePhD    -663.2482  3440.47485\nrankAssoc    2985.4107  7599.31080\nrankProf     8396.1546 13841.37340\nyear          285.1433   667.47476\nysdeg        -280.6397    31.49105\n```\n:::\n:::\n\n\nThe confidence interval for sex means that there is 95% confidence that the true difference in mean salaries for men and women lie between -697.82 and 3,030.56.\n\n### Part C\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + rank + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15746.05     800.18  19.678  < 2e-16 ***\nsexFemale    1166.37     925.57   1.260    0.214    \ndegreePhD    1388.61    1018.75   1.363    0.180    \nrankAssoc    5292.36    1145.40   4.621 3.22e-05 ***\nrankProf    11118.76    1351.77   8.225 1.62e-10 ***\nyear          476.31      94.91   5.018 8.65e-06 ***\nysdeg        -124.57      77.49  -1.608    0.115    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThe above results show that the p-value for the variable of sex is larger than the significance level of 0.05, meaning there is still no statistically significant evidence to reject the hypothesis that the mean salaries for men and women are the same. When the individual is female, the model predicts the salary increases by 1,166.37.\n\nFor the degree level, there is also not statistically significant evidence to reject the hypothesis that the mean salaries for those with a master's degree and a PhD are the same, since the p-value is larger than 0.05. The model predicts that when an individual has a PhD, their predicted salary increases by 1,388.61.\n\nFor the rank variable, there is statistically significant evidence to reject the hypothesis that the salaries for ranks Associate, Assistant, and Professor are the same. The p-values for both Associate and Professor rankings are extremely small and less than the significance level of 0.05. THe model predicts that faculty with an Associate ranking have a salary increase by 5,292.36, and faculty with a Professor ranking have a salary increase by 111,118.76.\n\nThe p-value for the variable of the amount of years in the current rank is also extremely small and less than the 0.05 significance level, meaning that there is statistically significant evidence to reject the hypothesis that the amount of years does not affect salary amount. For each additional year spent in the current rank, the model predicts a salary increase of 476.31.\n\nLastly, the p-value for the amount of years since the highest degree is larger than the signficiance level 0.05. There is no statistically significant evidence to reject the hypothesis that the amount of years since highest degree has no impact on salary amount. The model predicts that for each additional year since the highest degree, the salary decreases by 124.57.\n\n### Part D\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary$rank <- relevel(salary$rank, ref = 'Prof')\nmodel <- lm(salary ~ sex + degree + rank + year + ysdeg, data = salary)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + rank + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  26864.81    1375.29  19.534  < 2e-16 ***\nsexFemale     1166.37     925.57   1.260    0.214    \ndegreePhD     1388.61    1018.75   1.363    0.180    \nrankAsst    -11118.76    1351.77  -8.225 1.62e-10 ***\nrankAssoc    -5826.40    1012.93  -5.752 7.28e-07 ***\nyear           476.31      94.91   5.018 8.65e-06 ***\nysdeg         -124.57      77.49  -1.608    0.115    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nAfter changing the baseline category, the model shows that for faculty with the ranks of Assistant and Associate, the p-value is still extremely small and shows significant evidence to reject the hypothesis that the salaries for ranks Assistant, Associate, and Professor are the same. The model indicates that for those in the rank Assistant, their predicted salary decreases by 111,118.76. When Assistant is the baseline category, the model predicts a salary decrease if 5,826.40 when the faculty is ranked Associate.\n\n### Part E\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(salary ~ sex + degree + year + ysdeg, data = salary)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8146.9 -2186.9  -491.5  2279.1 11186.6 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 17183.57    1147.94  14.969  < 2e-16 ***\nsexFemale   -1286.54    1313.09  -0.980 0.332209    \ndegreePhD   -3299.35    1302.52  -2.533 0.014704 *  \nyear          351.97     142.48   2.470 0.017185 *  \nysdeg         339.40      80.62   4.210 0.000114 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3744 on 47 degrees of freedom\nMultiple R-squared:  0.6312,\tAdjusted R-squared:  0.5998 \nF-statistic: 20.11 on 4 and 47 DF,  p-value: 1.048e-09\n```\n:::\n:::\n\n\nAfter excluding rank, all variables except for sex have statistically significant p-values. Though the p-value for the year variable increased, it still reamined under the 0.05 significance level. The variables degree and ysdeg now have p-values less than the significant 0.05 level when they were much higher in the previous model. Removing the rank variable resulted in new coefficients for all variables as well.\n\n### Part F\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary$appointed <- ifelse(salary$year > 15, c(\"0\"), c(\"1\"))\nmodel <- lm(salary ~ sex + degree + appointed, data = salary)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + appointed, data = salary)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-11079.0  -4093.5   -333.7   3348.9  16842.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  29712.6     2593.2  11.458 2.45e-15 ***\nsexFemale    -2504.7     1793.8  -1.396   0.1691    \ndegreePhD      541.4     1640.5   0.330   0.7428    \nappointed1   -6005.5     2692.8  -2.230   0.0304 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5610 on 48 degrees of freedom\nMultiple R-squared:  0.1541,\tAdjusted R-squared:  0.1012 \nF-statistic: 2.915 on 3 and 48 DF,  p-value: 0.04371\n```\n:::\n:::\n\n\nMulticollinearity would be a concern in this case because multiple variables are related due to the appointment of the new Dean. If the Dean only hired those who recently got their degree, then that means the variables year and years since highest degree are related--only those hired within the past 15 years would also have gotten their degree within 15 years. Thus, I omitted these two variables and created the variable \"appointed\", with 1 indicating that the faculty member was appointed by the new dean and 0 indicating that they were not. The results from the model don't support the hypothesis that the new Dean's appointees are making higher salaries than those who were are not. The model predicts a salary decrease of 6,005 when the faculty member is appointed by the new Dean. If the people hired by the new Dean were making more money, this predictiin would be an increase.\n\n## Question 3\n\n### Part A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Price ~ Size + New, data = house.selling.price)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + appointed, data = salary)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-11079.0  -4093.5   -333.7   3348.9  16842.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  29712.6     2593.2  11.458 2.45e-15 ***\nsexFemale    -2504.7     1793.8  -1.396   0.1691    \ndegreePhD      541.4     1640.5   0.330   0.7428    \nappointed1   -6005.5     2692.8  -2.230   0.0304 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5610 on 48 degrees of freedom\nMultiple R-squared:  0.1541,\tAdjusted R-squared:  0.1012 \nF-statistic: 2.915 on 3 and 48 DF,  p-value: 0.04371\n```\n:::\n:::\n\n\nFor the variable size, the p-value is extremely small and less than the significance level of 0.05, meaning that there is statistically significant evidence to reject the hypothesis that the size of the house does not affect price. The coefficient of size indicates that for each additional square foot, the model predicts the price to increase by 116.132.\n\nThe p-value for the variable new is also smaller than the significance level of 0.05, so there is statistically significant evidence to reject the hypothesis that new houses have the same mean price as old houses. The coefficient of new means that for a house that is new, the price is predicted to increase by 57,736.283.\n\n### Part B\n\nThe prediction equation is: y = -40,230.867 + 116.132x1 + 57,736.283x2 (with x1 being the square feet of the house and x2 being whether the house is old or new)\n\nThis means that when the house has 0 square feet and is not new, the price would be predicted to be -40,230.867 (or the y-intercept).\n\nThe equation for not new homes: y = -40,230.867 + 116.132x1\n\nThe last part of the prediction equation is omitted since not new homes are equal to 0, cancelling out the last component.\n\nThe equation for new homes: y = -40,230.867 + 116.132x1 + 57,736.283x2\n\n### Part C\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# New\n\n-40230.867 + (116.132 * 3000) + (57636.283 * 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 365801.4\n```\n:::\n:::\n\n\nThe predicted price of a new home with 3,000 square feet is $365,801.40.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Not new\n\n-40230.867 + (116.132 * 3000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 308165.1\n```\n:::\n:::\n\n\nThe predicted price of a not new home with 3,000 square feet is $308,165.10.\n\n### Part D\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Price ~ Size + New + Size*New, data = house.selling.price)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + appointed, data = salary)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-11079.0  -4093.5   -333.7   3348.9  16842.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  29712.6     2593.2  11.458 2.45e-15 ***\nsexFemale    -2504.7     1793.8  -1.396   0.1691    \ndegreePhD      541.4     1640.5   0.330   0.7428    \nappointed1   -6005.5     2692.8  -2.230   0.0304 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5610 on 48 degrees of freedom\nMultiple R-squared:  0.1541,\tAdjusted R-squared:  0.1012 \nF-statistic: 2.915 on 3 and 48 DF,  p-value: 0.04371\n```\n:::\n:::\n\n\nThe coefficients changed for both variables with the new model. The coefficient for size indicates that for each additional square foot, the price of the home is predicted to increase by 104.438. For new, when the house is new, the price of the home is expected to decrease by 78527.502--now it is a negative relationship when in the previous model it was positive. The interaction coefficient is 61.916, meaning that for each additional square foot when the house is new, the price is predicted to increase by 61.916. The size variable's p-value is still below the 0.05 significance level. However, the p-value for the variable new is above the 0.05 significance level, indicating that there is now no statistically significant evidence to reject the hypothesis that the mean prices for new houses and old houses (regardless of size) are the same. The interaction term's p-value is smaller than the 0.05 significance level, meaning that there is statistically significant evidence to reject the hypothesis that the price of a new house doesn't depend on its size and vice versa.\n\n### Part E\n\nEquation for a new house: y = -22,2227.808 + 104.438x1 - 78,527.502x2 + 61.916(x1)(x2)\n\nEquation for a not new house: y = -22,2227.808 + 104.438x1\n\nAgain, removed the last two terms of this equation since not new is equal to 0 and would therefore cancel out the last two terms.\n\n### Part F\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# New\n\n-22227.808 + (104.438 * 3000) - (78527.502 * 1) + (61.916 * 3000 * 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 398306.7\n```\n:::\n:::\n\n\nThe predicted price for a new house with 3,000 square feet with the new equation is $398,306.70.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Not New\n\n-22227.808 + (104.438 * 3000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 291086.2\n```\n:::\n:::\n\n\nThe predicted price for a not new house with 3,000 square feet with the new equation is $291,086.19.\n\n### Part G\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# New\n\n-22227.808 + (104.438 * 1500) - (78527.502 * 1) + (61.916 * 1500 * 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 148775.7\n```\n:::\n:::\n\n\nThe predicted price for a new house with 1,500 square feet is $148,775.70.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Not new\n\n-22227.808 + (104.438 * 1500)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 134429.2\n```\n:::\n:::\n\n\nThe predicted price for a not new house with 1,500 square feet is 134,429.20.\n\n### Part H\n\nI think the model with the interaction term better represents the relationship of size to the outcome of price, both from the results in the summary and from my own limited knowledge about housing. The regression results from the interaction model showed that the interaction term was statistically significant, indicating strong evidence that the price of a home does depend on size, but whether or not the house is new affects the magnitude of this effect. Also, I think when people buy homes they care both about size and about whether or not the house is new. Additionally, when the interaction model calculated the price of homes for both 3,000 square feet and 1,500 square feet when the house is both new and old, there is a dramatic difference in how much the price increased in the new house with the additional square footage than the not new house.\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}