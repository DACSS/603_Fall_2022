{
  "hash": "492d38be4effecf8b0607aff161736a7",
  "result": {
    "markdown": "---\ntitle: \"Homework 3 - Emily Duryea\"\nauthor: \"Emily Duryea\"\ndescription: \"The third homework assignment for DACSS 603\"\ndate: \"10/31/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw3\n  - Emily Duryea\n---\n\n\n# Homework 3\n\n## Question 1\n\nUnited Nations (Data file: UN11in alr4)\n\nThe data in the file UN11 contains several variables, including ppgdp, the gross national product per person in U.S. dollars, and fertility, the birth rate per 1000 females, both from the year 2009. The data are for 199 localities, mostly UN member countries, but also other areas such as Hong Kong that are not independent countries. The data were collected from the United Nations (2011). We will study the dependence of fertility on ppgdp.\n\n### 1.1.1\n\nQuestion: Identify the predictor and the response.\n\nAnswer: The predictor is ppgdp, and the response is ferility, since we are looking at how ppgdp (the independent variable) is affecting fertility (dependent variable).\n\n### 1.1.2\n\nQuestion: Draw the scatterplot of fertility on the vertical axis versus ppgdp on the horizontal axis and summarize the information in this graph. Does a straight-line mean function seem to be plausible for a summary of this graph?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importing needed libraries\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\n# Importing the UN11 dataset\ndata(UN11)\n\n# Creating a scatterplot\nggplot(data = UN11, aes(x = ppgdp, y = fertility)) +\n  geom_point(color = 'black') +\n  labs(title = \"PPGDP and Fertility\")\n```\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nAnswer: This graph does not look like it could represented by a linear function. Rather, it looks like it would be represented by a nonlinear (curvilinear) function.\n\n### 1.1.3\n\nQuestion: Draw the scatterplot of log(fertility) versus log(ppgdp) using natural logarithms. Does the simple linear regression model seem plausible for a summary of this graph? If you use a different base of logarithms, the shape of the graph won't change, but the values on the axes will change.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating a scatterplot\nggplot(data = UN11, aes(x = log(ppgdp), y = log(fertility))) +\n  geom_point(color = 'black') +\n  geom_smooth(method = lm) +\n  labs(title = \"PPGDP and Fertility\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nAnswer: After taking the logarithm of each variable, based on the graph, it is now plausible to use a simple linear regression.\n\n## Question 2\n\nAnnual income, in dollars, is an explanatory variable in a regression analysis. For a British version of the report on the analysis, all responses are converted to British pounds sterling (1 pound equals about 1.33 dollars, as of 2016).\n\n### Part A\n\nQuestion: How, if at all, does the slope of the prediction equation change?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating a variable for the British pound\nUN11$Britishpound <- 1.33*UN11$ppgdp\n\n# Examining the slope\nsummary(lm(fertility ~ Britishpound, UN11))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = fertility ~ Britishpound, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9006 -0.8801 -0.3547  0.6749  3.7585 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   3.178e+00  1.048e-01  30.331  < 2e-16 ***\nBritishpound -2.407e-05  3.500e-06  -6.877  7.9e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.206 on 197 degrees of freedom\nMultiple R-squared:  0.1936,\tAdjusted R-squared:  0.1895 \nF-statistic: 47.29 on 1 and 197 DF,  p-value: 7.903e-11\n```\n:::\n\n```{.r .cell-code}\nggplot(data = UN11, aes(x = log(Britishpound), y = log(fertility))) +\n  geom_point(color = 'black') +\n  geom_smooth(method = lm) +\n  labs(title = \"British Pound and Fertility\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Comparing the slope\nsummary(lm(fertility ~ ppgdp, UN11))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = fertility ~ ppgdp, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9006 -0.8801 -0.3547  0.6749  3.7585 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.178e+00  1.048e-01  30.331  < 2e-16 ***\nppgdp       -3.201e-05  4.655e-06  -6.877  7.9e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.206 on 197 degrees of freedom\nMultiple R-squared:  0.1936,\tAdjusted R-squared:  0.1895 \nF-statistic: 47.29 on 1 and 197 DF,  p-value: 7.903e-11\n```\n:::\n:::\n\n\nAnswer: The slope has changed slightly due to the 1.33 increase adjustment for British pounds, but according to the results of the summary function, the adjusted R-squared is the same for both (0.1895).\n\n### Part B\n\nQuestion: How, if at all, does the correlation change?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Finding the correlation with US dollars\ncor(UN11$ppgdp, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n\n```{.r .cell-code}\n# Finding the correlation with British pounds\ncor(UN11$Britishpound, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n:::\n\n\nAnswer: The correlations of fertility with US dollars AND British pounds are the same, because, although British pounds are of a different value from US dollars, the values are multiplied by a constant (1.33).\n\n## Question 3\n\nWater runoff in the Sierras (Data file: water in alr4)\n\nCan Southern California's water supply in future years be predicted from past data? One factor affecting water availability is stream runoff. If runoff could be predicted, engineers, planners, and policy makers could do their jobs more efficiently. The data file contains 43 years' worth of precipitation measurements taken at six sites in the Sierra Nevada mountains (labeled APMAM, APSAB, APSLAKE, OPBPC, OPRC, and OPSLAKE) and stream runoff volume at a site near Bishop, California, labeled BSAAM. Draw the scatterplot matrix for these data and summarize the information available from these plots. (Hint: Use the pairs() function.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading dataset\ndata(water)\n\n# Creating scatterplots\npairs(water)\n```\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Conducting regression analysis\nwater1 <- lm(BSAAM ~ APMAM + APSAB + APSLAKE + OPBPC + OPRC + OPSLAKE, data = water)\nsummary(water1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = BSAAM ~ APMAM + APSAB + APSLAKE + OPBPC + OPRC + \n    OPSLAKE, data = water)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-12690  -4936  -1424   4173  18542 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15944.67    4099.80   3.889 0.000416 ***\nAPMAM         -12.77     708.89  -0.018 0.985725    \nAPSAB        -664.41    1522.89  -0.436 0.665237    \nAPSLAKE      2270.68    1341.29   1.693 0.099112 .  \nOPBPC          69.70     461.69   0.151 0.880839    \nOPRC         1916.45     641.36   2.988 0.005031 ** \nOPSLAKE      2211.58     752.69   2.938 0.005729 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7557 on 36 degrees of freedom\nMultiple R-squared:  0.9248,\tAdjusted R-squared:  0.9123 \nF-statistic: 73.82 on 6 and 36 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nAnswer: This graph does not look like it could represented by a linear function. Rather, it looks like it would be represented by a nonlinear (curvilinear) function.\n\n## Question 4\n\nProfessor ratings (Data file: Rateprof in alr4)\n\nIn the website and online forum RateMyProfessors.com, students rate and comment on their instructors. Launched in 1999, the site includes millions of ratings on thousands of instructors. The data file includes the summaries of the ratings of 364 instructors at a large campus in the Midwest (Bleske-Rechek and Fritsch, 2011). Each instructor included in the data had at least 10 ratings over a several year period. Students provided ratings of 1--5 on quality, helpfulness, clarity, easiness of instructor's courses, and raterInterest in the subject matter covered in the instructor's courses. The data file provides the averages of these five ratings. Create a scatterplot matrix of these five variables. Provide a brief description of the relationships between the five ratings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importing dataset\ndata(Rateprof)\n\n# Creating a subset of the dataset with the five variables of interest\nRateprof5 <- Rateprof %>% select(quality, helpfulness, clarity, easiness, raterInterest)\n\n# Creating the scatterplots\npairs(Rateprof5)\n```\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nAnswer: All 5 of the variables of interest have positive correlations. However, some relationships are stronger than others. Quality, helpfulness, and clarity all have stronger positive relationships, while easiness and raterInterest are very weak positive relationships.\n\n## Question 5\n\nFor the student.survey data file in the smss package, conduct regression analyses relating (by convention, y denotes the outcome variable, x denotes the explanatory variable) (i) y = political ideology and x = religiosity, (ii) y = high school GPA and x = hours of TV watching. (You can use ?student.survey in the R console, after loading the package, to see what each variable means.)\n\n### Part A\n\nQuestion: Graphically portray how the explanatory variable relates to the outcome variable in each of the two cases\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importing dataset\ndata(student.survey)\nstudentsurvey <- student.survey\n\n# Creating subset of data with variables needed\nstudentsurvey <- studentsurvey %>%\n  select(hi, tv, pi, re)\n\n# Creating a plot to compare political ideology with religious service attendance\nplot(pi ~ re, data = studentsurvey)\n```\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Creating a plot comparing High School GPA (hi) and average number of hours watching tb a week (tv)\nggplot(data = studentsurvey, aes(x = tv, y = hi)) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](Homework3_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\nAnswer: Based on the plots generated, religious service attendance is correlated with conservatism, and hours of TV watched per week has a negative relationship with high school GPA.\n\n### Part B\n\nQuestion: Summarize and interpret results of inferential analyses.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Changing the pi variable to a numeric one\nstudentsurvey$pi <- as.numeric(studentsurvey$pi)\n\n# Removing ordering from the re variable\nlevels(studentsurvey$re) <- c(\"N\", \"O\", \"M\", \"E\")\nstudentsurvey$re <- factor(studentsurvey$re, ordered = FALSE)\n\n# Conducting regression analyses for pi and re\nsummary(lm(pi ~ re, studentsurvey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pi ~ re, data = studentsurvey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.8889 -0.5172 -0.2667  1.2040  2.7333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.2667     0.3394   6.678 1.18e-08 ***\nreO           0.2506     0.4181   0.599 0.551374    \nreM           2.1619     0.6017   3.593 0.000691 ***\nreE           2.6222     0.5543   4.731 1.56e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.315 on 56 degrees of freedom\nMultiple R-squared:  0.3872,\tAdjusted R-squared:  0.3544 \nF-statistic:  11.8 on 3 and 56 DF,  p-value: 4.282e-06\n```\n:::\n\n```{.r .cell-code}\n# Conducting regression analyses for hi and tv\nsummary(lm(hi ~ tv, studentsurvey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = studentsurvey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n:::\n\n\nAnswer: According to this dataset, people who attended religious services most weeks or every week are significantly more likely to report as conservative (p \\< 0.001). Additionally, people who watch less hours of tv are significantly more likely to have a higher GPA (p \\< 0.05).\n",
    "supporting": [
      "Homework3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}