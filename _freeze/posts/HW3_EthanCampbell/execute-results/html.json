{
  "hash": "cb1b438194753972eaa5bda485cb6b92",
  "result": {
    "markdown": "---\ntitle: \"Homework 3\"\nauthor: \"Ethan Campbell\"\ndesription: \"Homework 3\"\ndate: \"10/27/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw3\n---\n\n---\ntitle: \"Homework 3\"\nformat: html\neditor: visual\n---\n\n\n# Question 1\n\nUnited Nations (Data file: UN11in alr4) The data in the file UN11 contains several variables, including ppgdp, the gross national product per person in U.S. dollars, and fertility, the birth rate per 1000 females, both from the year 2009. The data are for 199 localities, mostly UN member countries, but also other areas such as Hong Kong that are not independent countries. The data were collected from the United Nations (2011). We will study the dependence of fertility on ppgdp.\n\n### 1.1.1. \n\nIdentify the predictor and the response.\n\nThe predictor\n\n-   ppgdp\n\nThe response\n\n-   Fertitlity\n\nThe reason they are set up this way is because we are studying how ppgdp effects fertitlity this makes fertility dependent on ppgpd.\n\n## Reading in the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'alr4' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'car' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'effects' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyverse' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Attaching packages --------------------------------------- tidyverse 1.3.2 --\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nv ggplot2 3.3.6     v purrr   0.3.4\nv tibble  3.1.8     v dplyr   1.0.9\nv tidyr   1.2.0     v stringr 1.4.1\nv readr   2.1.2     v forcats 0.5.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tibble' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'stringr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'forcats' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\nx dplyr::recode() masks car::recode()\nx purrr::some()   masks car::some()\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n\n# reading data\ndata(\"UN11\")\n\n# taking a quick look at data\nhead(UN11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                region  group fertility   ppgdp lifeExpF pctUrban\nAfghanistan       Asia  other     5.968   499.0    49.49       23\nAlbania         Europe  other     1.525  3677.2    80.40       53\nAlgeria         Africa africa     2.142  4473.0    75.00       67\nAngola          Africa africa     5.135  4321.9    53.17       59\nAnguilla     Caribbean  other     2.000 13750.1    81.10      100\nArgentina   Latin Amer  other     2.172  9162.1    79.89       93\n```\n:::\n:::\n\n\n### 1.1.2 \n\nDraw the scatterplot of fertility on the vertical axis versus ppgdp on the horizontal axis and summarize the information in this graph. Does a straight-line mean function seem to be plausible for a summary of this graph?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pulling the two variables that are needed\nUN <- UN11 %>%\n  select(c(ppgdp, fertility))\n\nhead(UN)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              ppgdp fertility\nAfghanistan   499.0     5.968\nAlbania      3677.2     1.525\nAlgeria      4473.0     2.142\nAngola       4321.9     5.135\nAnguilla    13750.1     2.000\nArgentina    9162.1     2.172\n```\n:::\n\n```{.r .cell-code}\n# Creating the graph comparing the two variables\nggplot(data = UN, aes(x = ppgdp, y = fertility)) +\ngeom_point(color = 'blue') +\nlabs(title = \"Fertility compared to PPGDP\")\n```\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# function for ggplot regression plotting\n\nggplotRegression <- function (fit) {\n\nrequire(ggplot2)\n\nggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + \n  geom_point() +\n  stat_smooth(method = \"lm\", col = \"red\") +\n  labs(title = paste(\"Adj R2 = \",signif(summary(fit)$adj.r.squared, 5),\n                     \"Intercept =\",signif(fit$coef[[1]],5 ),\n                     \" Slope =\",signif(fit$coef[[2]], 5),\n                     \" P =\",signif(summary(fit)$coef[2,4], 5)))\n}\n\n# regression with a log \nA <- lm(fertility ~ ppgdp, data = UN)\n\nsummary(A)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = fertility ~ ppgdp, data = UN)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9006 -0.8801 -0.3547  0.6749  3.7585 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.178e+00  1.048e-01  30.331  < 2e-16 ***\nppgdp       -3.201e-05  4.655e-06  -6.877  7.9e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.206 on 197 degrees of freedom\nMultiple R-squared:  0.1936,\tAdjusted R-squared:  0.1895 \nF-statistic: 47.29 on 1 and 197 DF,  p-value: 7.903e-11\n```\n:::\n\n```{.r .cell-code}\n# Here we can see why we would need to make adjustments as you can not go below 0 fertility\n\nggplotRegression(lm(fertility ~ ppgdp, data = UN))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n### Solution\n\nBased on the points on this graph it does not appear to be linear and there appears to be bend within this information. To determine if we could use that function it would be best to run a log function on the x and y axis. Looking at the regression plotted above we can see that the relationship shows a decrease as ppgdp grows however, it reaches a point where it goes negative in fertility which is impossible. This is why I would recommend using a log function.\n\n### 1.1.3 \n\nDraw the scatterplot of log(fertility) versus log(ppgdp) using natural logarithms. Does the simple linear regression model seem plausible for a summary of this graph? If you use a different base of logarithms, the shape of the graph won't change, but the values on the axes will change.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating the graph comparing the two variables\nggplot(data = UN, aes(x = log(ppgdp), y = log(fertility))) +\ngeom_point(color = 'blue') +\n  geom_smooth(method = lm) +\nlabs(title = \"Fertility compared to PPGDP\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### Solution\n\nHere we use the log on both of the variables and we notice that it allows us to utilize the regression correctly. Now we can show the relationship between these two variables and the line is linear.\n\n# Question 2\n\nAnnual income, in dollars, is an explanatory variable in a regression analysis. For a British version of the report on the analysis, all responses are converted to British pounds sterling (1 pound equals about 1.33 dollars, as of 2016).\n\n### (a) \n\nHow, if at all, does the slope of the prediction equation change?\n\nYes, the slope will change by 1.33 since this is rate at which it is changing and the conversion between the two values. The US version will increase by 1.33 times compared to the British version.\n\n### (b) \n\nHow, if at all, does the correlation change?\n\nThe correlation should not change as the scale changes in relation to the amount.\n\n# Question 3\n\nWater runoff in the Sierras (Data file: water in alr4) Can Southern California's water supply in future years be predicted from past data? One factor affecting water availability is stream runoff. If runoff could be predicted, engineers, planners, and policy makers could do their jobs more efficiently. The data file contains 43 years' worth of precipitation measurements taken at six sites in the Sierra Nevada mountains (labeled APMAM, APSAB, APSLAKE, OPBPC, OPRC, and OPSLAKE) and stream runoff volume at a site near Bishop, California, labeled BSAAM. Draw the scatterplot matrix for these data and summarize the information available from these plots. (Hint: Use the pairs() function.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(water)\n\nhead(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM\n1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235\n2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567\n3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161\n4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094\n5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080\n6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594\n```\n:::\n\n```{.r .cell-code}\n# here is the pairs of each variable and we notice some correlation however, it is really hard to get a closer look here. \npairs(water,\n      bg = 'blue')\n```\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# creating the regression to look closer \nbsaam_water <- lm(BSAAM ~ APMAM + APSAB + APSLAKE + OPBPC + OPRC + OPSLAKE, data = water)\n\n# summary\nsummary(bsaam_water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = BSAAM ~ APMAM + APSAB + APSLAKE + OPBPC + OPRC + \n    OPSLAKE, data = water)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-12690  -4936  -1424   4173  18542 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15944.67    4099.80   3.889 0.000416 ***\nAPMAM         -12.77     708.89  -0.018 0.985725    \nAPSAB        -664.41    1522.89  -0.436 0.665237    \nAPSLAKE      2270.68    1341.29   1.693 0.099112 .  \nOPBPC          69.70     461.69   0.151 0.880839    \nOPRC         1916.45     641.36   2.988 0.005031 ** \nOPSLAKE      2211.58     752.69   2.938 0.005729 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7557 on 36 degrees of freedom\nMultiple R-squared:  0.9248,\tAdjusted R-squared:  0.9123 \nF-statistic: 73.82 on 6 and 36 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n### Solution\n\nHere we see that there are two variables that have a statistically significant relationship with BSAAM. These are OPRC and OPSLAKE each less than .05 however, questions regarding multicollinarity arise with this strong corrleation. The other variables such as the AP variables seem to also be correlated however, it does not appear as strongly as the two before. When looking at the range of residuals we notice a very large difference and this indicates that there may be some large and small outliers. This will effect the bests fitted line and lead to less robust analysis. When we are looking at the R\\^2 we notice it is very high which means it is fairly well fitted as it is close to 1.00.\n\n# Question 4\n\nProfessor ratings (Data file: Rateprof in alr4) In the website and online forum RateMyProfessors.com, students rate and comment on their instructors. Launched in 1999, the site includes millions of ratings on thousands of instructors. The data file includes the summaries of the ratings of 364 instructors at a large campus in the Midwest (Bleske-Rechek and Fritsch, 2011). Each instructor included in the data had at least 10 ratings over a several year period. Students provided ratings of 1--5 on quality, helpfulness, clarity, easiness of instructor's courses, and raterInterest in the subject matter covered in the instructor's courses. The data file provides the averages of these five ratings. Create a scatterplot matrix of these five variables. Provide a brief description of the relationships between the five ratings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Rateprof)\nhead(Rateprof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gender numYears numRaters numCourses pepper discipline              dept\n1   male        7        11          5     no        Hum           English\n2   male        6        11          5     no        Hum Religious Studies\n3   male       10        43          2     no        Hum               Art\n4   male       11        24          5     no        Hum           English\n5   male       11        19          7     no        Hum           Spanish\n6   male       10        15          9     no        Hum           Spanish\n   quality helpfulness  clarity easiness raterInterest sdQuality sdHelpfulness\n1 4.636364    4.636364 4.636364 4.818182      3.545455 0.5518564     0.6741999\n2 4.318182    4.545455 4.090909 4.363636      4.000000 0.9020179     0.9341987\n3 4.790698    4.720930 4.860465 4.604651      3.432432 0.4529343     0.6663898\n4 4.250000    4.458333 4.041667 2.791667      3.181818 0.9325048     0.9315329\n5 4.684211    4.684211 4.684211 4.473684      4.214286 0.6500112     0.8200699\n6 4.233333    4.266667 4.200000 4.533333      3.916667 0.8632717     1.0327956\n  sdClarity sdEasiness sdRaterInterest\n1 0.5045250  0.4045199       1.1281521\n2 0.9438798  0.5045250       1.0744356\n3 0.4129681  0.5407021       1.2369438\n4 0.9990938  0.5882300       1.3322506\n5 0.5823927  0.6117753       0.9749613\n6 0.7745967  0.6399405       0.6685579\n```\n:::\n\n```{.r .cell-code}\nRates <- Rateprof %>%\n  select(quality, helpfulness, clarity, easiness, raterInterest)\n\npairs(Rates)\n```\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Solution\n\nHere we see a vary of different strengths of correlations these will be discussed one by one. These range from very weak correlation to very strong correlation which is interesting to see. These are all linear and positive.\n\n**Quality \\~ Helpfulness -** Here we notice a strong correlation as the data is very linear. This data is also showing a very strong correlation in a positive direction.\n\n**Quality \\~ Clarity-** Here we notice a strong correlation that is positive and linear.\n\n**Quality \\~ Easiness-** Here we notice a weaker correlation compared to the last too but still a positive linear correlation.\n\n**Quality \\~ RaterInterest-** Here we notice a weak correlation but still a positive linear correlation.\n\n**Easiness \\~ RaterInterst -** Shows a very flat line which shows a very weak correlation.\n\n**Clarity \\~ Easiness-** Shows a weak linear correlation.\n\n# Question 5\n\nFor the student.survey data file in the smss package, conduct regression analyses relating (by convention, y denotes the outcome variable, x denotes the explanatory variable) (i) y = political ideology and x = religiosity, (ii) y = high school GPA and x = hours of TV watching.\n\n(You can use ?student.survey in the R console, after loading the package, to see what each variable means.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(student.survey)\nSS <- student.survey\nhead(SS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  subj ge ag  hi  co   dh   dr tv sp ne ah    ve pa           pi           re\n1    1  m 32 2.2 3.5    0  5.0  3  5  0  0 FALSE  r conservative   most weeks\n2    2  f 23 2.1 3.5 1200  0.3 15  7  5  6 FALSE  d      liberal occasionally\n3    3  f 27 3.3 3.0 1300  1.5  0  4  3  0 FALSE  d      liberal   most weeks\n4    4  f 35 3.5 3.2 1500  8.0  5  5  6  3 FALSE  i     moderate occasionally\n5    5  m 23 3.1 3.5 1600 10.0  6  6  3  0 FALSE  i very liberal        never\n6    6  m 39 3.5 3.5  350  3.0  4  5  7  0 FALSE  d      liberal occasionally\n     ab    aa    ld\n1 FALSE FALSE FALSE\n2 FALSE FALSE    NA\n3 FALSE FALSE    NA\n4 FALSE FALSE FALSE\n5 FALSE FALSE FALSE\n6 FALSE FALSE    NA\n```\n:::\n\n```{.r .cell-code}\n# getting the data that we will be working with and checking to see which each variable means\n#?student.survey\n\nSS <- SS %>%\n  select(hi, tv, pi, re)\n```\n:::\n\n\n### (a) Graphically portray how the explanatory variable relates to the outcome variable in each of the two cases\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plotting the comparison between political ideology and religiosity\nSS_plot <- plot(pi~re, data = SS)\n```\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# plotting the comparison between high school gpa and hours of tv watching\n\nggplot(data = SS, aes(x = tv, y = hi)) +\n  geom_point() +\n  geom_smooth(method = lm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_EthanCampbell_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# making a table comparing these variabels\nxtabs(~pi+re, SS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                       re\npi                      never occasionally most weeks every week\n  very liberal              3            5          0          0\n  liberal                   8           14          1          1\n  slightly liberal          2            1          1          2\n  moderate                  1            8          1          0\n  slightly conservative     1            1          2          2\n  conservative              0            0          2          2\n  very conservative         0            0          0          2\n```\n:::\n\n```{.r .cell-code}\nsummary(SS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       hi              tv                             pi                re    \n Min.   :2.000   Min.   : 0.000   very liberal         : 8   never       :15  \n 1st Qu.:3.000   1st Qu.: 3.000   liberal              :24   occasionally:29  \n Median :3.350   Median : 6.000   slightly liberal     : 6   most weeks  : 7  \n Mean   :3.308   Mean   : 7.267   moderate             :10   every week  : 9  \n 3rd Qu.:3.625   3rd Qu.:10.000   slightly conservative: 6                    \n Max.   :4.000   Max.   :37.000   conservative         : 4                    \n                                  very conservative    : 2                    \n```\n:::\n:::\n\n\n### (b) \n\nSummarize and interpret results of inferential analyses.\n\nHere we notice that the more conservative you are the more likely you are to visit religious service on more occasions. However, this is not a very significant trend and it is hard to say with the graph alone. When looking into the xtabs comparing these two results we notice a similar shift there tends to be a higher number of liberals in the never and occasionally sections and then as it gets into most weeks and every week that number drops off quickly and slowly increases on the conservative side.\n\nWe are also notice a very clear correlation with the hours of watching tv and the highschool gpa. Here we notice that the more hours spent watching tv the less likelu you are to have a higher gpa. There is a negative slope as it drops off between the 10-15 hour mark.\n",
    "supporting": [
      "HW3_EthanCampbell_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}