{
  "hash": "21ed07a4afcda8f606b996e2cd072ed8",
  "result": {
    "markdown": "---\ntitle: \"Final project\"\nauthor: \"Mani Kanta Gogula\"\ndescription: \"Final project\"\ndate: \"12/3/2022\"\nformat:\n  html:\n    df-print: paged\n    css: styles.css\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - final\n  - Heart Disease Prediction\n  - Mani Kanta Gogula\n---\n\n\n\n# Heart Disease in the United States:\n\nHeart disease is the leading cause of death for men, women, and people of most racial and ethnic groups in the United States.One person dies every 34 seconds in the United States from cardiovascular disease.About 697,000 people in the United States died from heart disease in 2020—that’s 1 in every 5 deaths.Heart disease cost the United States about $229 billion each year from 2017 to 2018.3 This includes the cost of health care services, medicines, and lost productivity due to death.\nCoronary heart disease is the most common type of heart disease, killing 382,820 people in 2020.\nAbout 20.1 million adults age 20 and older have CAD (about 7.2%).In 2020, about 2 in 10 deaths from CAD happen in adults less than 65 years old.Early Action Is Important for Heart Attack\nKnow the warning signs and symptoms of a heart attack.\nIn the United States, someone has a heart attack every 40 seconds.2\nEvery year, about 805,000 people in the United States have a heart attack.Of these,\n605,000 are a first heart attack\n200,000 happen to people who have already had a heart attack\nAbout 1 in 5 heart attacks are silent—the damage is done, but the person is not aware of it.\n\n::: {.cell}\n\n:::\n\n\n\n\n# Research :\n\n1. Examining the relationship between maximum heart rate one can achieve during excercise and likelihood of developing heart disease .\n\n2. Using Multiple logistic regression confounding effects of age and gender.\n\n# Loading Required Libraries and Reading the Dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(kableExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'kableExtra' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyverse' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Attaching packages --------------------------------------- tidyverse 1.3.2 --\nv ggplot2 3.4.0      v purrr   0.3.5 \nv tibble  3.1.8      v dplyr   1.0.10\nv tidyr   1.2.1      v stringr 1.5.0 \nv readr   2.1.3      v forcats 0.5.2 \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tibble' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'purrr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'stringr' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'forcats' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter()     masks stats::filter()\nx dplyr::group_rows() masks kableExtra::group_rows()\nx dplyr::lag()        masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'caret' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n\nAttaching package: 'caret'\n\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n:::\n\n```{.r .cell-code}\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GGally' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n```{.r .cell-code}\nlibrary(pROC)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'pROC' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nType 'citation(\"pROC\")' for a citation.\n\nAttaching package: 'pROC'\n\nThe following objects are masked from 'package:stats':\n\n    cov, smooth, var\n```\n:::\n\n```{.r .cell-code}\nlibrary(Metrics)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'Metrics' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Metrics'\n\nThe following object is masked from 'package:pROC':\n\n    auc\n\nThe following objects are masked from 'package:caret':\n\n    precision, recall\n```\n:::\n\n```{.r .cell-code}\nheart_disease_dataset <- read_csv(\"heart_cleveland_upload.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 297 Columns: 14\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\ndbl (14): age, sex, cp, trestbps, chol, fbs, restecg, thalach, exang, oldpea...\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(heart_disease_dataset)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"age\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cp\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"trestbps\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"chol\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fbs\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"restecg\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thalach\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"exang\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"oldpeak\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"slope\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ca\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"thal\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"condition\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"69\",\"2\":\"1\",\"3\":\"0\",\"4\":\"160\",\"5\":\"234\",\"6\":\"1\",\"7\":\"2\",\"8\":\"131\",\"9\":\"0\",\"10\":\"0.1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"69\",\"2\":\"0\",\"3\":\"0\",\"4\":\"140\",\"5\":\"239\",\"6\":\"0\",\"7\":\"0\",\"8\":\"151\",\"9\":\"0\",\"10\":\"1.8\",\"11\":\"0\",\"12\":\"2\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"66\",\"2\":\"0\",\"3\":\"0\",\"4\":\"150\",\"5\":\"226\",\"6\":\"0\",\"7\":\"0\",\"8\":\"114\",\"9\":\"0\",\"10\":\"2.6\",\"11\":\"2\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"65\",\"2\":\"1\",\"3\":\"0\",\"4\":\"138\",\"5\":\"282\",\"6\":\"1\",\"7\":\"2\",\"8\":\"174\",\"9\":\"0\",\"10\":\"1.4\",\"11\":\"1\",\"12\":\"1\",\"13\":\"0\",\"14\":\"1\"},{\"1\":\"64\",\"2\":\"1\",\"3\":\"0\",\"4\":\"110\",\"5\":\"211\",\"6\":\"0\",\"7\":\"2\",\"8\":\"144\",\"9\":\"1\",\"10\":\"1.8\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"64\",\"2\":\"1\",\"3\":\"0\",\"4\":\"170\",\"5\":\"227\",\"6\":\"0\",\"7\":\"2\",\"8\":\"155\",\"9\":\"0\",\"10\":\"0.6\",\"11\":\"1\",\"12\":\"0\",\"13\":\"2\",\"14\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n# Variable Description\n\nThere are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:\n\nAge: Age of subject\n\nSex: Gender of subject:\n0 = female 1 = male\n\nChest-pain type: Type of chest-pain experienced by the individual:\n1 = typical angina\n2 = atypical angina\n3 = non-angina pain\n4 = asymptomatic angina\n\nResting Blood Pressure: Resting blood pressure in mm Hg\n\nSerum Cholesterol: Serum cholesterol in mg/dl\n\nFasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar <= 120 mg/dl\n1 = fasting blood sugar > 120 mg/dl\n\nResting ECG: Resting electrocardiographic results\n0 = normal\n1 = ST-T wave abnormality\n2 = left ventricle hyperthrophy\n\nMax Heart Rate Achieved: Max heart rate of subject\n\nExercise Induced Angina:\n0 = no 1 = yes\n\nST Depression Induced by Exercise Relative to Rest: ST Depression of subject\n\nPeak Exercise ST Segment:\n1 = Up-sloaping\n2 = Flat\n3 = Down-sloaping\n\nNumber of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro\n\nThal: Form of thalassemia: 3\n3 = normal\n6 = fixed defect\n7 = reversible defect\n\nDiagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not:\n0 = absence\n1 = heart disease present\n\n# Hypothesis\n\nThe aging and elderly population are particularly susceptible to cardiovascular disease. Age is an independent risk factor for cardiovascular disease (CVD) in adults, but these risks are compounded by additional factors, including frailty, obesity, and diabetes. These factors are known to complicate and enhance cardiac risk factors that are associated with the onset of advanced age. Sex is another potential risk factor in aging adults, given that older females are reported to be at a greater risk for CVD than age-matched men. However, in both men and women, the risks associated with CVD increase with age, and these correspond to an overall decline in sex hormones, primarily of estrogen and testosterone. Despite this, hormone replacement therapies are largely shown to not improve outcomes in older patients and may also increase the risks of cardiac events in older adults. My Hypothesis for this project based on a reserach article. \n\n Does Sex/Gender Have an effect?\n\n\n# Renaming the columns\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames <- c(\"Age\",\n           \"Sex\",\n           \"Chest_Pain_Type\",\n           \"Resting_Blood_Pressure\",\n           \"Serum_Cholesterol\",\n           \"Fasting_Blood_Sugar\",\n           \"Resting_ECG\",\n           \"Max_Heart_Rate_Achieved\",\n           \"Exercise_Induced_Angina\",\n           \"ST_Depression_Exercise\",\n           \"Peak_Exercise_ST_Segment\",\n           \"Num_Major_Vessels_Flouro\",\n           \"Thalassemia\",\n           \"Diagnosis_Heart_Disease\")\n#Apply column names to the dataframe\ncolnames(heart_disease_dataset) <- names\n#Glimpse data to verify new column names are in place\nglimpse(heart_disease_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 297\nColumns: 14\n$ Age                      <dbl> 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~\n$ Sex                      <dbl> 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~\n$ Chest_Pain_Type          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ Resting_Blood_Pressure   <dbl> 160, 140, 150, 138, 110, 170, 145, 134, 150, ~\n$ Serum_Cholesterol        <dbl> 234, 239, 226, 282, 211, 227, 233, 234, 240, ~\n$ Fasting_Blood_Sugar      <dbl> 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~\n$ Resting_ECG              <dbl> 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~\n$ Max_Heart_Rate_Achieved  <dbl> 131, 151, 114, 174, 144, 155, 150, 145, 171, ~\n$ Exercise_Induced_Angina  <dbl> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ ST_Depression_Exercise   <dbl> 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~\n$ Peak_Exercise_ST_Segment <dbl> 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~\n$ Num_Major_Vessels_Flouro <dbl> 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~\n$ Thalassemia              <dbl> 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~\n$ Diagnosis_Heart_Disease  <dbl> 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~\n```\n:::\n:::\n\n\n# Variable Description\n\n There are 14 variables provided in the data set and the last one is the dependent variable that we want to be able to predict. Here is a summary of what the other variables mean:\n\nAge: Age of subject\n\nSex: Gender of subject:\n0 = female 1 = male\n\nChest-pain type: Type of chest-pain experienced by the individual:\n1 = typical angina\n2 = atypical angina\n3 = non-angina pain\n4 = asymptomatic angina\n\nResting Blood Pressure: Resting blood pressure in mm Hg\n\nSerum Cholesterol: Serum cholesterol in mg/dl\n\nFasting Blood Sugar: Fasting blood sugar level relative to 120 mg/dl: 0 = fasting blood sugar <= 120 mg/dl\n1 = fasting blood sugar > 120 mg/dl\n\nResting ECG: Resting electrocardiographic results\n0 = normal\n1 = ST-T wave abnormality\n2 = left ventricle hyperthrophy\n\nMax Heart Rate Achieved: Max heart rate of subject\n\nExercise Induced Angina:\n0 = no 1 = yes\n\nST Depression Induced by Exercise Relative to Rest: ST Depression of subject\n\nPeak Exercise ST Segment:\n1 = Up-sloaping\n2 = Flat\n3 = Down-sloaping\n\nNumber of Major Vessels (0-3) Visible on Flouroscopy: Number of visible vessels under flouro\n\nThal: Form of thalassemia: 3\n3 = normal\n6 = fixed defect\n7 = reversible defect\n\nDiagnosis of Heart Disease: Indicates whether subject is suffering from heart disease or not:\n0 = absence\n1 = heart disease present\n\n# Reading the Dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(heart_disease_dataset)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Age\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sex\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Chest_Pain_Type\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resting_Blood_Pressure\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Serum_Cholesterol\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fasting_Blood_Sugar\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resting_ECG\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Max_Heart_Rate_Achieved\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Exercise_Induced_Angina\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ST_Depression_Exercise\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Peak_Exercise_ST_Segment\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Num_Major_Vessels_Flouro\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Thalassemia\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Diagnosis_Heart_Disease\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"69\",\"2\":\"1\",\"3\":\"0\",\"4\":\"160\",\"5\":\"234\",\"6\":\"1\",\"7\":\"2\",\"8\":\"131\",\"9\":\"0\",\"10\":\"0.1\",\"11\":\"1\",\"12\":\"1\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"69\",\"2\":\"0\",\"3\":\"0\",\"4\":\"140\",\"5\":\"239\",\"6\":\"0\",\"7\":\"0\",\"8\":\"151\",\"9\":\"0\",\"10\":\"1.8\",\"11\":\"0\",\"12\":\"2\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"66\",\"2\":\"0\",\"3\":\"0\",\"4\":\"150\",\"5\":\"226\",\"6\":\"0\",\"7\":\"0\",\"8\":\"114\",\"9\":\"0\",\"10\":\"2.6\",\"11\":\"2\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"65\",\"2\":\"1\",\"3\":\"0\",\"4\":\"138\",\"5\":\"282\",\"6\":\"1\",\"7\":\"2\",\"8\":\"174\",\"9\":\"0\",\"10\":\"1.4\",\"11\":\"1\",\"12\":\"1\",\"13\":\"0\",\"14\":\"1\"},{\"1\":\"64\",\"2\":\"1\",\"3\":\"0\",\"4\":\"110\",\"5\":\"211\",\"6\":\"0\",\"7\":\"2\",\"8\":\"144\",\"9\":\"1\",\"10\":\"1.8\",\"11\":\"1\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"64\",\"2\":\"1\",\"3\":\"0\",\"4\":\"170\",\"5\":\"227\",\"6\":\"0\",\"7\":\"2\",\"8\":\"155\",\"9\":\"0\",\"10\":\"0.6\",\"11\":\"1\",\"12\":\"0\",\"13\":\"2\",\"14\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntail(heart_disease_dataset)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Age\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sex\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Chest_Pain_Type\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resting_Blood_Pressure\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Serum_Cholesterol\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fasting_Blood_Sugar\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resting_ECG\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Max_Heart_Rate_Achieved\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Exercise_Induced_Angina\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ST_Depression_Exercise\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Peak_Exercise_ST_Segment\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Num_Major_Vessels_Flouro\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Thalassemia\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Diagnosis_Heart_Disease\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"40\",\"2\":\"1\",\"3\":\"3\",\"4\":\"110\",\"5\":\"167\",\"6\":\"0\",\"7\":\"2\",\"8\":\"114\",\"9\":\"1\",\"10\":\"2.0\",\"11\":\"1\",\"12\":\"0\",\"13\":\"2\",\"14\":\"1\"},{\"1\":\"40\",\"2\":\"1\",\"3\":\"3\",\"4\":\"152\",\"5\":\"223\",\"6\":\"0\",\"7\":\"0\",\"8\":\"181\",\"9\":\"0\",\"10\":\"0.0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"2\",\"14\":\"1\"},{\"1\":\"39\",\"2\":\"1\",\"3\":\"3\",\"4\":\"118\",\"5\":\"219\",\"6\":\"0\",\"7\":\"0\",\"8\":\"140\",\"9\":\"0\",\"10\":\"1.2\",\"11\":\"1\",\"12\":\"0\",\"13\":\"2\",\"14\":\"1\"},{\"1\":\"35\",\"2\":\"1\",\"3\":\"3\",\"4\":\"120\",\"5\":\"198\",\"6\":\"0\",\"7\":\"0\",\"8\":\"130\",\"9\":\"1\",\"10\":\"1.6\",\"11\":\"1\",\"12\":\"0\",\"13\":\"2\",\"14\":\"1\"},{\"1\":\"35\",\"2\":\"0\",\"3\":\"3\",\"4\":\"138\",\"5\":\"183\",\"6\":\"0\",\"7\":\"0\",\"8\":\"182\",\"9\":\"0\",\"10\":\"1.4\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\"},{\"1\":\"35\",\"2\":\"1\",\"3\":\"3\",\"4\":\"126\",\"5\":\"282\",\"6\":\"0\",\"7\":\"2\",\"8\":\"156\",\"9\":\"1\",\"10\":\"0.0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"2\",\"14\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n# Structure of the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#structure of the dataset\nstr(heart_disease_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [297 x 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Age                     : num [1:297] 69 69 66 65 64 64 63 61 60 59 ...\n $ Sex                     : num [1:297] 1 0 0 1 1 1 1 1 0 1 ...\n $ Chest_Pain_Type         : num [1:297] 0 0 0 0 0 0 0 0 0 0 ...\n $ Resting_Blood_Pressure  : num [1:297] 160 140 150 138 110 170 145 134 150 178 ...\n $ Serum_Cholesterol       : num [1:297] 234 239 226 282 211 227 233 234 240 270 ...\n $ Fasting_Blood_Sugar     : num [1:297] 1 0 0 1 0 0 1 0 0 0 ...\n $ Resting_ECG             : num [1:297] 2 0 0 2 2 2 2 0 0 2 ...\n $ Max_Heart_Rate_Achieved : num [1:297] 131 151 114 174 144 155 150 145 171 145 ...\n $ Exercise_Induced_Angina : num [1:297] 0 0 0 0 1 0 0 0 0 0 ...\n $ ST_Depression_Exercise  : num [1:297] 0.1 1.8 2.6 1.4 1.8 0.6 2.3 2.6 0.9 4.2 ...\n $ Peak_Exercise_ST_Segment: num [1:297] 1 0 2 1 1 1 2 1 0 2 ...\n $ Num_Major_Vessels_Flouro: num [1:297] 1 2 0 1 0 0 0 2 0 0 ...\n $ Thalassemia             : num [1:297] 0 0 0 0 0 2 1 0 0 2 ...\n $ Diagnosis_Heart_Disease : num [1:297] 0 0 0 1 0 0 0 1 0 0 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   age = col_double(),\n  ..   sex = col_double(),\n  ..   cp = col_double(),\n  ..   trestbps = col_double(),\n  ..   chol = col_double(),\n  ..   fbs = col_double(),\n  ..   restecg = col_double(),\n  ..   thalach = col_double(),\n  ..   exang = col_double(),\n  ..   oldpeak = col_double(),\n  ..   slope = col_double(),\n  ..   ca = col_double(),\n  ..   thal = col_double(),\n  ..   condition = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n# Data Summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#summary of the dataset\nsummary(heart_disease_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Age             Sex         Chest_Pain_Type Resting_Blood_Pressure\n Min.   :29.00   Min.   :0.0000   Min.   :0.000   Min.   : 94.0         \n 1st Qu.:48.00   1st Qu.:0.0000   1st Qu.:2.000   1st Qu.:120.0         \n Median :56.00   Median :1.0000   Median :2.000   Median :130.0         \n Mean   :54.54   Mean   :0.6768   Mean   :2.158   Mean   :131.7         \n 3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:3.000   3rd Qu.:140.0         \n Max.   :77.00   Max.   :1.0000   Max.   :3.000   Max.   :200.0         \n Serum_Cholesterol Fasting_Blood_Sugar  Resting_ECG     Max_Heart_Rate_Achieved\n Min.   :126.0     Min.   :0.0000      Min.   :0.0000   Min.   : 71.0          \n 1st Qu.:211.0     1st Qu.:0.0000      1st Qu.:0.0000   1st Qu.:133.0          \n Median :243.0     Median :0.0000      Median :1.0000   Median :153.0          \n Mean   :247.4     Mean   :0.1448      Mean   :0.9966   Mean   :149.6          \n 3rd Qu.:276.0     3rd Qu.:0.0000      3rd Qu.:2.0000   3rd Qu.:166.0          \n Max.   :564.0     Max.   :1.0000      Max.   :2.0000   Max.   :202.0          \n Exercise_Induced_Angina ST_Depression_Exercise Peak_Exercise_ST_Segment\n Min.   :0.0000          Min.   :0.000          Min.   :0.0000          \n 1st Qu.:0.0000          1st Qu.:0.000          1st Qu.:0.0000          \n Median :0.0000          Median :0.800          Median :1.0000          \n Mean   :0.3266          Mean   :1.056          Mean   :0.6027          \n 3rd Qu.:1.0000          3rd Qu.:1.600          3rd Qu.:1.0000          \n Max.   :1.0000          Max.   :6.200          Max.   :2.0000          \n Num_Major_Vessels_Flouro  Thalassemia    Diagnosis_Heart_Disease\n Min.   :0.0000           Min.   :0.000   Min.   :0.0000         \n 1st Qu.:0.0000           1st Qu.:0.000   1st Qu.:0.0000         \n Median :0.0000           Median :0.000   Median :0.0000         \n Mean   :0.6768           Mean   :0.835   Mean   :0.4613         \n 3rd Qu.:1.0000           3rd Qu.:2.000   3rd Qu.:1.0000         \n Max.   :3.0000           Max.   :2.000   Max.   :1.0000         \n```\n:::\n:::\n\n\n# Dimension of the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndim(heart_disease_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 297  14\n```\n:::\n:::\n\n# Glimpse of the Dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#glimpse of the dataset\nglimpse(heart_disease_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 297\nColumns: 14\n$ Age                      <dbl> 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~\n$ Sex                      <dbl> 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~\n$ Chest_Pain_Type          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ Resting_Blood_Pressure   <dbl> 160, 140, 150, 138, 110, 170, 145, 134, 150, ~\n$ Serum_Cholesterol        <dbl> 234, 239, 226, 282, 211, 227, 233, 234, 240, ~\n$ Fasting_Blood_Sugar      <dbl> 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~\n$ Resting_ECG              <dbl> 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~\n$ Max_Heart_Rate_Achieved  <dbl> 131, 151, 114, 174, 144, 155, 150, 145, 171, ~\n$ Exercise_Induced_Angina  <dbl> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ ST_Depression_Exercise   <dbl> 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~\n$ Peak_Exercise_ST_Segment <dbl> 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~\n$ Num_Major_Vessels_Flouro <dbl> 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~\n$ Thalassemia              <dbl> 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~\n$ Diagnosis_Heart_Disease  <dbl> 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~\n```\n:::\n:::\n\n\nI also want to know the number of observations in the dependent variable column to understand if the dataset is relatively balanced.\n\nTo know this factor , I have removed null values if there is any in the dataset and have counted the Dependent variable Diagnosis_Heart_Disease .\n\n# Counting outcome variable \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Determine the number of values in each level of dependent variable\nheart_disease_dataset %>% \n  drop_na() %>%\n  group_by(Diagnosis_Heart_Disease) %>%\n  count() %>% \n  ungroup() %>%\n  kable(align = rep(\"c\", 2)) %>% kable_styling(\"full_width\" = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Diagnosis_Heart_Disease </th>\n   <th style=\"text-align:center;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 160 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 137 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nBy above result we can state that that there is no huge difference in the dependent variable of the dataset . Since the value 0 in the above result states that there is a no presence of heart disease and the value 1 states that patient is diagnoised with the heart disease.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Identify the different levels of Thalassemia\nheart_disease_dataset %>% \n  drop_na() %>%\n  group_by(Thalassemia) %>%\n  count() %>% \n  ungroup() %>%\n  kable(align = rep(\"c\", 2)) %>% kable_styling(\"full_width\" = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Thalassemia </th>\n   <th style=\"text-align:center;\"> n </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 164 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 115 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n# Removing Null values and Inapporpriate Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Drop NA's, convert to factors, lump target variable to 2 levels, remove \"?\", reorder variables\nheart_dataset_clean_tbl <- heart_disease_dataset %>% \n    drop_na() %>%\n    mutate_at(c(\"Resting_ECG\", \n                \"Fasting_Blood_Sugar\", \n                \"Sex\", \n                \"Diagnosis_Heart_Disease\", \n                \"Exercise_Induced_Angina\",\n                \"Peak_Exercise_ST_Segment\", \n                \"Chest_Pain_Type\"), as_factor) %>%\n    mutate(Num_Major_Vessels_Flouro = as.numeric(Num_Major_Vessels_Flouro)) %>%\n    mutate(Diagnosis_Heart_Disease = fct_lump(Diagnosis_Heart_Disease, other_level = \"1\")) %>% \n    filter(Thalassemia != \"?\") %>%\n    select(Age, \n           Resting_Blood_Pressure, \n           Serum_Cholesterol, \n           Max_Heart_Rate_Achieved, \n           ST_Depression_Exercise,\n           Num_Major_Vessels_Flouro,\n           everything())\n\n#Glimpse data\nheart_dataset_clean_tbl %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 297\nColumns: 14\n$ Age                      <dbl> 69, 69, 66, 65, 64, 64, 63, 61, 60, 59, 59, 5~\n$ Resting_Blood_Pressure   <dbl> 160, 140, 150, 138, 110, 170, 145, 134, 150, ~\n$ Serum_Cholesterol        <dbl> 234, 239, 226, 282, 211, 227, 233, 234, 240, ~\n$ Max_Heart_Rate_Achieved  <dbl> 131, 151, 114, 174, 144, 155, 150, 145, 171, ~\n$ ST_Depression_Exercise   <dbl> 0.1, 1.8, 2.6, 1.4, 1.8, 0.6, 2.3, 2.6, 0.9, ~\n$ Num_Major_Vessels_Flouro <dbl> 1, 2, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, ~\n$ Sex                      <fct> 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, ~\n$ Chest_Pain_Type          <fct> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ Fasting_Blood_Sugar      <fct> 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, ~\n$ Resting_ECG              <fct> 2, 0, 0, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, ~\n$ Exercise_Induced_Angina  <fct> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ~\n$ Peak_Exercise_ST_Segment <fct> 1, 0, 2, 1, 1, 1, 2, 1, 0, 2, 1, 0, 0, 0, 1, ~\n$ Thalassemia              <dbl> 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 2, 0, 0, 0, 2, ~\n$ Diagnosis_Heart_Disease  <fct> 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, ~\n```\n:::\n:::\n\n\n# Recoding the variables based on Data \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Select categorical vars, recode them to their character values, convert to long format\nhd_long_fact_tbl <- heart_dataset_clean_tbl  %>%\n  select(Sex,\n         Chest_Pain_Type,\n         Fasting_Blood_Sugar,\n         Resting_ECG,\n         Exercise_Induced_Angina,\n         Peak_Exercise_ST_Segment,\n         Thalassemia,\n         Diagnosis_Heart_Disease) %>%\n  mutate(Sex = recode_factor(Sex, `0` = \"female\", \n                                  `1` = \"male\" ),\n         Chest_Pain_Type = recode_factor(Chest_Pain_Type, `1` = \"typical\",   \n                                                          `2` = \"atypical\",\n                                                          `3` = \"non-angina\", \n                                                          `4` = \"asymptomatic\"),\n         Fasting_Blood_Sugar = recode_factor(Fasting_Blood_Sugar, `0` = \"<= 120 mg/dl\", \n                                                                  `1` = \"> 120 mg/dl\"),\n         Resting_ECG = recode_factor(Resting_ECG, `0` = \"normal\",\n                                                  `1` = \"ST-T abnormality\",\n                                                  `2` = \"LV hypertrophy\"),\n         Exercise_Induced_Angina = recode_factor(Exercise_Induced_Angina, `0` = \"no\",\n                                                                          `1` = \"yes\"),\n         Peak_Exercise_ST_Segment = recode_factor(Peak_Exercise_ST_Segment, `1` = \"up-sloaping\",\n                                                                            `2` = \"flat\",\n                                                                            `3` = \"down-sloaping\"),\n         Thalassemia = recode_factor(Thalassemia, `3` = \"normal\",\n                                                  `6` = \"fixed defect\",\n                                                  `7` = \"reversible defect\")) %>%\n  gather(key = \"key\", value = \"value\", -Diagnosis_Heart_Disease)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Unreplaced values treated as NA as `.x` is not compatible.\nPlease specify replacements exhaustively or supply `.default`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attributes are not identical across measure variables;\nthey will be dropped\n```\n:::\n\n```{.r .cell-code}\n#Visualize with bar plot\nhd_long_fact_tbl %>% \n  ggplot(aes(value)) +\n    geom_bar(aes(x        = value, \n                 fill     = Diagnosis_Heart_Disease), \n                 alpha    = .6, \n                 position = \"dodge\", \n                 color    = \"black\",\n                 width    = .8\n             ) +\n    labs(x = \"\",\n         y = \"\",\n         title = \"Scaled Effect of Categorical Variables\") +\n    theme(\n         axis.text.y  = element_blank(),\n         axis.ticks.y = element_blank()) +\n    facet_wrap(~ key, scales = \"free\", nrow = 4) +\n    scale_fill_manual(\n         values = c(\"#fde725ff\", \"#20a486ff\"),\n         name   = \"Heart\\nDisease\",\n         labels = c(\"No HD\", \"Yes HD\"))\n```\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Must gather() data first in order to facet wrap by key \n#(default gather call puts all var names into new key col)\nhd_long_cont_tbl <- heart_dataset_clean_tbl  %>%\n  select(Age,\n         Resting_Blood_Pressure,\n         Serum_Cholesterol,\n         Max_Heart_Rate_Achieved,\n         ST_Depression_Exercise,\n         Num_Major_Vessels_Flouro,\n         Diagnosis_Heart_Disease) %>% \n  gather(key   = \"key\", \n         value = \"value\",\n         -Diagnosis_Heart_Disease)\n\n#Visualize numeric variables as boxplots\nhd_long_cont_tbl %>% \n  ggplot(aes(y = value)) +\n       geom_boxplot(aes(fill = Diagnosis_Heart_Disease),\n                      alpha  = .6,\n                      fatten = .7) +\n        labs(x = \"\",\n             y = \"\",\n             title = \"Boxplots for Numeric Variables\") +\n      scale_fill_manual(\n            values = c(\"#fde725ff\", \"#20a486ff\"),\n            name   = \"Heart\\nDisease\",\n            labels = c(\"No HD\", \"Yes HD\")) +\n      theme(\n         axis.text.x  = element_blank(),\n         axis.ticks.x = element_blank()) +\n      facet_wrap(~ key, \n                 scales = \"free\", \n                 ncol   = 2) \n```\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nThe faceted plots for categorical and numeric variables suggest the following conditions are associated with increased prevalence of heart disease (note: this does not mean the relationship is causal).\n\nAsymptomatic angina chest pain (relative to typical angina chest pain, atypical angina pain, or non-angina pain)\nPresence of exercise induced angina\nLower fasting blood sugar\nFlat or down-sloaping peak exercise ST segment\nPresence of left ventricle hypertrophy\nMale\nHigher thelassemia score\nHigher age\nLower max heart rate achieved\nHigher resting blood pressure\nHigher cholesterol\nHigher ST depression induced by exercise relative to rest\n\nAge, blood pressure, cholesterol, and sex all point in the right direction based on what we generally know about the world around us. This provides a nice phase gate to let us proceed with the analysis.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nage.plot <- ggplot(heart_disease_dataset, mapping = aes(x = Age, fill = Diagnosis_Heart_Disease)) +\n  geom_histogram() +\n  facet_wrap(vars(Diagnosis_Heart_Disease)) +\n  labs(title = \"Prevelance of Heart Disease Across Age\", x = \"Age (years)\", y = \"Count\", fill = \"Heart Disease\")\n\nage.plot\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nHighly correlated variables can lead to overly complicated models or wonky predictions. The ggcorr() function from GGally package provides a nice, clean correlation matrix of the numeric variables. The default method is Pearson which I use here first. Pearson isn’t ideal if the data is skewed or has a lot of outliers so I’ll check using the rank-based Kendall method as well.\n\n# Correlation Analysis\n \nCorrelation analysis allows us to obtain an understanding on relationship and direction between features. Example +0.8 indicates very strong positive relationship while 0 indicates no relationship.\n\nTwo methods i.e. Pearson and Kendall are used for the correlation analysis in this study.\n\n# Correlation between the variables\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(GGally)\n#Correlation matrix using Pearson method, default method is Pearson\nheart_disease_dataset %>% ggcorr(high       = \"#20a486ff\",\n                                   low        = \"#fde725ff\",\n                                   label      = TRUE, \n                                   hjust      = 0.99, \n                                   size       = 3, \n                                   label_size = 3,\n                                   nbreaks    = 5\n                                              ) +\n  labs(title = \"Correlation Matrix\",\n  subtitle = \"Pearson Method Using Pairwise Obervations\")\n```\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Correlation matrix using Kendall method\nheart_disease_dataset %>% ggcorr(method     = c(\"pairwise\", \"kendall\"),\n                                   high       = \"#20a486ff\",\n                                   low        = \"#fde725ff\",\n                                   label      = TRUE, \n                                   hjust      = .99, \n                                   size       = 3, \n                                   label_size = 3,\n                                   nbreaks    = 5\n                                   ) +\n  labs(title = \"Correlation Matrix\",\n  subtitle = \"Kendall Method Using Pairwise Observations\")\n```\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\nBased on Pearson and Kendall’s correlation result, the factors that showed correlation >= 40% with the target feature are: Chest Pain type, Num of Major Vessels, Exercise Induced Angina, and ST Depression.\n\nThere are very minor differences between the Pearson and Kendall results. No variables appear to be highly correlated (i.e. > 50%) As such, it seems reasonable to keep all the original 14 variables as we proceed into the modeling section.Some additional steps can be used in the modelling stage to identify the statitically significant features\n\n\n# Regression Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_model <- lm(data = heart_disease_dataset, Diagnosis_Heart_Disease ~.,)\nsummary(linear_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Diagnosis_Heart_Disease ~ ., data = heart_disease_dataset)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.95099 -0.21719 -0.04465  0.19177  0.88874 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)              -0.0505202  0.3027180  -0.167 0.867577    \nAge                      -0.0012505  0.0027322  -0.458 0.647534    \nSex                       0.1483876  0.0490138   3.027 0.002693 ** \nChest_Pain_Type           0.0826754  0.0241094   3.429 0.000696 ***\nResting_Blood_Pressure    0.0021831  0.0012512   1.745 0.082106 .  \nSerum_Cholesterol         0.0003295  0.0004153   0.794 0.428151    \nFasting_Blood_Sugar      -0.0955640  0.0596062  -1.603 0.109993    \nResting_ECG               0.0329834  0.0212532   1.552 0.121797    \nMax_Heart_Rate_Achieved  -0.0026911  0.0011311  -2.379 0.018014 *  \nExercise_Induced_Angina   0.1334793  0.0505880   2.639 0.008787 ** \nST_Depression_Exercise    0.0315276  0.0230370   1.369 0.172221    \nPeak_Exercise_ST_Segment  0.0646453  0.0423642   1.526 0.128142    \nNum_Major_Vessels_Flouro  0.1437419  0.0250276   5.743 2.39e-08 ***\nThalassemia               0.1228227  0.0257060   4.778 2.85e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3482 on 283 degrees of freedom\nMultiple R-squared:  0.5352,\tAdjusted R-squared:  0.5139 \nF-statistic: 25.07 on 13 and 283 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n# Model Evaluation and Dianostic Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,3)); plot(linear_model, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nAccording to the diagnostic plots, none of the models seem to fit super well. There are violations of assumptions in models. so I will be doing logistic regression to get a better model and check the accuracy.\n\n\n\n# Modelling\n\n# Data Preparation For Modelling\n\nThe plan is to split up the original data set to form a training group (70%) and testing group (30%). The training group will be used to fit the model while the testing group will be used to evaluate predictions. The initial_split() function creates a split object which is just an efficient way to store both the training and testing sets. The training() and testing() functions are used to extract the appropriate dataframes out of the split object when needed.\n\nCreate Logistic Regression Model\n\nLogistic regression is a form of regression analysis. A binary logistic regression is used when the target feature is a dichotomy, having only two values, for example, 0 or 1, or Yes or No.  In this project, it is used to compute the prediction of the presence of heart disease. It can be used to predict what conditions that could likely cause the presence of heart disease.The R function glm(), for generalized linear model, can be used to compute logistic regression. We need to specify the option family = binomial, which tells to R that we want to fit logistic regression.\n\n# Logistic Regression Assumptions\n\nThe first assumption is that there is a linear relationship between continuous independent variables and the logit of the outcome variable.\n\nIndependence of errors requires that there be no dependence between samples in the model, i.e. using the same individuals at different times.\n\nMulticollinearity refers to a relationship (correlation) between the independent variables and must be excluded from logistic regression models\n\n# Partitioning the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(100)\ntrainDataIndex <- createDataPartition(heart_disease_dataset$Diagnosis_Heart_Disease, p=0.7, list = F)  # 70% training data\ntrainData <- heart_disease_dataset[trainDataIndex, ]\ntestData <- heart_disease_dataset[-trainDataIndex, ]\n```\n:::\n\n\n# Multiple logistic regression\n\nThe multiple logistic regression is used to predict the probability of class membership based on multiple predictor variables, as follow:\n\n# Model 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# using glm function from base R and specify the family argument as binomial\nmodel <- glm(data = heart_disease_dataset, Diagnosis_Heart_Disease ~.,, family = \"binomial\" )\n\n\n\n# extract the model summary\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Diagnosis_Heart_Disease ~ ., family = \"binomial\", \n    data = heart_disease_dataset)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.8042  -0.5263  -0.1860   0.4161   2.3676  \n\nCoefficients:\n                          Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -5.118417   2.729300  -1.875  0.06074 .  \nAge                      -0.014057   0.024036  -0.585  0.55866    \nSex                       1.319688   0.486718   2.711  0.00670 ** \nChest_Pain_Type           0.578582   0.191335   3.024  0.00250 ** \nResting_Blood_Pressure    0.024182   0.010727   2.254  0.02418 *  \nSerum_Cholesterol         0.004816   0.003775   1.276  0.20202    \nFasting_Blood_Sugar      -0.991868   0.554947  -1.787  0.07389 .  \nResting_ECG               0.246117   0.185238   1.329  0.18396    \nMax_Heart_Rate_Achieved  -0.021183   0.010275  -2.062  0.03923 *  \nExercise_Induced_Angina   0.915651   0.414003   2.212  0.02699 *  \nST_Depression_Exercise    0.249909   0.212418   1.176  0.23940    \nPeak_Exercise_ST_Segment  0.582699   0.362317   1.608  0.10778    \nNum_Major_Vessels_Flouro  1.267008   0.265723   4.768 1.86e-06 ***\nThalassemia               0.714003   0.202068   3.533  0.00041 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 409.95  on 296  degrees of freedom\nResidual deviance: 203.86  on 283  degrees of freedom\nAIC: 231.86\n\nNumber of Fisher Scoring iterations: 6\n```\n:::\n:::\n\n\nFrom the output above, the coefficients table shows the beta coefficient estimates and their significance levels. Columns are:\n\nEstimate: the intercept (b0) and the beta coefficient estimates associated to each predictor variable\n\nStd.Error: the standard error of the coefficient estimates. This represents the accuracy of the coefficients. The larger the standard error, the less confident we are about the estimate.\n\nz value: the z-statistic, which is the coefficient estimate (column 2) divided by the standard error of the estimate (column 3)\n\nPr(>|z|): The p-value corresponding to the z-statistic. The smaller the p-value, the more significant the estimate is.\n\n# Hypothesis Evaluation\n\nWe have a  p-value of less than 0.05 significance level. So we reject the null hypothesis and conclude that Sex and Diagnosis_Heart_disease have a significant relationship.\n \n\n# Interpretation : \n\nIt can be seen only sex, chest pain type, resting blood pressure, maximum heart rate reached during exercise, and exercise induced angina are significantly associated with the outcome.And the other variables like Age, serum cholesterol, and fasting blood sugar were found to be insignificant predictors of the outcome of the data i.e Diagnosis_heart_disease.\n\nThe coefficient estimate of the variable Chest_Pain_Type is   0.578582, which is positive. This means that an increase in chest_Pain_Type is associated with increase in the probability of being heart disease. However the coefficient for the variable Fasting_Blood_Sugar is -0.991868, which is negative. This means that an increase in Fasting_Blood_Sugar will be associated with a decreased probability of being heart disease positive.Similarly the other variables like Thalassemia, which is positive with 0.714 that means that an increase in Thalassemia is associated with the increase in the probability of the heart disease.Variable Peak_Exercise_ST_Segment which is positive with 0.582699, and an increase in Peak_Exercise_ST_Segment is associated with the increase in the probabality of the heart disease.\n\nAn important concept to understand, for interpreting the logistic beta coefficients, is the odds ratio. An odds ratio measures the association between a predictor variable (x) and the outcome variable (y). It represents the ratio of the odds that an event will occur (event = 1) given the presence of the predictor x (x = 1), compared to the odds of the event occurring in the absence of that predictor (x = 0).\n\nFor a given predictor (say x1), the associated beta coefficient (b1) in the logistic regression function corresponds to the log of the odds ratio for that predictor.\n\nIf the odds ratio is 2, then the odds that the event occurs (event = 1) are two times higher when the predictor x is present (x = 1) versus x is absent (x = 0).\n\nFor example, the regression coefficient Chest_Pain_Type is   0.578582. This indicate that one unit increase in the Chest_Pain_Type concentration will increase the odds of heart disease by exp(0.57) 1.7 times.\n\nFrom the logistic regression results, it can be noticed that some variables - serum cholesterol, and fasting blood sugar and age - are not statistically significant. Keeping them in the model may contribute to overfitting. Therefore, they should be eliminated.\n\n# Model 2\n\n So I'm running again the multiple logistic regression using significant variables and removing variables which are statistically not significant. Below is my second model with the variables which are significant. i.e Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi \n \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogitmod2 <- glm(Diagnosis_Heart_Disease ~ Chest_Pain_Type+Resting_Blood_Pressure+Exercise_Induced_Angina+Num_Major_Vessels_Flouro+Thalassemia, family = \"binomial\", data=heart_disease_dataset)\n\nsummary(logitmod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Diagnosis_Heart_Disease ~ Chest_Pain_Type + Resting_Blood_Pressure + \n    Exercise_Induced_Angina + Num_Major_Vessels_Flouro + Thalassemia, \n    family = \"binomial\", data = heart_disease_dataset)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.6485  -0.5736  -0.3053   0.5457   2.4856  \n\nCoefficients:\n                          Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -5.675942   1.349495  -4.206 2.60e-05 ***\nChest_Pain_Type           0.574750   0.178033   3.228 0.001245 ** \nResting_Blood_Pressure    0.017156   0.009169   1.871 0.061338 .  \nExercise_Induced_Angina   1.321728   0.367050   3.601 0.000317 ***\nNum_Major_Vessels_Flouro  1.183047   0.213516   5.541 3.01e-08 ***\nThalassemia               1.013251   0.175363   5.778 7.56e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 409.95  on 296  degrees of freedom\nResidual deviance: 235.66  on 291  degrees of freedom\nAIC: 247.66\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npred <- predict(logitmod2, newdata = testData, type = \"response\")\n\n# Measure the accuracy of prediction in the test data\n# The common practice is to take the probability cutoff as 0.5.\n# If the probability of Y is > 0.5, then it can be classified an event (presence of heart disease).\n# So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative\n\ny_pred_num <- ifelse(pred > 0.5, 1, 0)\ny_pred <- factor(y_pred_num, levels=c(0, 1))\ny_act <- testData$Diagnosis_Heart_Disease\n\n# Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)\nmean(y_pred == y_act)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8426966\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# get the predicted probability in our dataset using the predict() function\n# We include the argument type=”response” in order to get our prediction.\npred_prob <- predict(logitmod2, heart_disease_dataset, type=\"response\")\n\n# create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame\nheart_disease_dataset$pred_Diagnosis_Heart_Disease <- ifelse(pred_prob >= 0.5, 1, 0)\n\n# create a newdata data frame to save a new case information\nnewdata <- data.frame(Resting_Blood_Pressure=100, Exercise_Induced_Angina=2, Thalassemia=0,Chest_Pain_Type=0, Num_Major_Vessels_Flouro=4)\n\n# predict probability for this new case and print out the predicted value\np_new <- predict(logitmod2, newdata, type=\"response\")\np_new\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1 \n0.9681783 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# load Metrics package\nlibrary(Metrics)\n\n# calculate auc, accuracy, clasification error\nauc <- auc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease) \naccuracy <- accuracy(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease)\nclassification_error <- ce(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease) \n\n# print out the metrics on to screen\nprint(paste(\"AUC=\", auc))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AUC= 0.838959854014598\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Accuracy=\", accuracy))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Accuracy= 0.841750841750842\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Classification Error=\", classification_error))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Classification Error= 0.158249158249158\"\n```\n:::\n\n```{.r .cell-code}\n# confusion matrix\ntable(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease, dnn=c(\"True Status\", \"Predicted Status\")) # confusion matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Predicted Status\nTrue Status   0   1\n          0 140  20\n          1  27 110\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(roc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease),print.auc=TRUE,legacy.axes=T)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting levels: control = 0, case = 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting direction: controls < cases\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n# Model 3\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogitmod3 <- glm(Diagnosis_Heart_Disease ~ Chest_Pain_Type+Exercise_Induced_Angina+Thalassemia, family = \"binomial\", data=heart_disease_dataset)\n\nsummary(logitmod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Diagnosis_Heart_Disease ~ Chest_Pain_Type + Exercise_Induced_Angina + \n    Thalassemia, family = \"binomial\", data = heart_disease_dataset)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.2599  -0.6121  -0.4437   0.7150   2.4528  \n\nCoefficients:\n                        Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -2.9575     0.4240  -6.975 3.07e-12 ***\nChest_Pain_Type           0.6889     0.1694   4.066 4.78e-05 ***\nExercise_Induced_Angina   1.2391     0.3353   3.696 0.000219 ***\nThalassemia               1.0621     0.1585   6.700 2.09e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 409.95  on 296  degrees of freedom\nResidual deviance: 279.17  on 293  degrees of freedom\nAIC: 287.17\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npred <- predict(logitmod3, newdata = testData, type = \"response\")\n\n# Measure the accuracy of prediction in the test data\n# The common practice is to take the probability cutoff as 0.5.\n# If the probability of Y is > 0.5, then it can be classified an event (presence of heart disease).\n# So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative\n\ny_pred_num <- ifelse(pred > 0.5, 1, 0)\ny_pred <- factor(y_pred_num, levels=c(0, 1))\ny_act <- testData$Diagnosis_Heart_Disease\n\n\n# Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)\nmean(y_pred == y_act)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7752809\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# get the predicted probability in our dataset using the predict() function\n# We include the argument type=”response” in order to get our prediction.\npred_prob <- predict(logitmod3, heart_disease_dataset, type=\"response\")\n\n# create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame\nheart_disease_dataset$pred_Diagnosis_Heart_Disease_2 <- ifelse(pred_prob >= 0.5, 1, 0)\n\n# create a newdata data frame to save a new case information\nnewdata <- data.frame( Exercise_Induced_Angina=2, Thalassemia=0,Chest_Pain_Type=0)\n\n# predict probability for this new case and print out the predicted value\np_new <- predict(logitmod3, newdata, type=\"response\")\np_new\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1 \n0.3824118 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# load Metrics package\nlibrary(Metrics)\n\n# calculate auc, accuracy, classification error\nauc <- auc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_2) \naccuracy <- accuracy(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_2)\nclassification_error <- ce(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_2) \n\n# print out the metrics on to screen\nprint(paste(\"AUC=\", auc))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AUC= 0.806660583941606\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Accuracy=\", accuracy))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Accuracy= 0.808080808080808\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Classification Error=\", classification_error))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Classification Error= 0.191919191919192\"\n```\n:::\n\n```{.r .cell-code}\n# confusion matrix\ntable(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease, dnn=c(\"True Status\", \"Predicted Status\")) # confusion matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Predicted Status\nTrue Status   0   1\n          0 140  20\n          1  27 110\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(roc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_2),print.auc=TRUE,legacy.axes=T)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting levels: control = 0, case = 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting direction: controls < cases\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n#Model 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogitmod4 <- glm(Diagnosis_Heart_Disease ~Resting_Blood_Pressure+Num_Major_Vessels_Flouro+Thalassemia, family = \"binomial\", data=heart_disease_dataset)\n\nsummary(logitmod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Diagnosis_Heart_Disease ~ Resting_Blood_Pressure + \n    Num_Major_Vessels_Flouro + Thalassemia, family = \"binomial\", \n    data = heart_disease_dataset)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.8472  -0.5522  -0.4629   0.6345   2.1491  \n\nCoefficients:\n                          Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -3.558096   1.165384  -3.053  0.00226 ** \nResting_Blood_Pressure    0.012531   0.008666   1.446  0.14815    \nNum_Major_Vessels_Flouro  1.204857   0.196336   6.137 8.42e-10 ***\nThalassemia               1.175053   0.160420   7.325 2.39e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 409.95  on 296  degrees of freedom\nResidual deviance: 272.39  on 293  degrees of freedom\nAIC: 280.39\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npred <- predict(logitmod4, newdata = testData, type = \"response\")\n\n# Measure the accuracy of prediction in the test data\n# The common practice is to take the probability cutoff as 0.5.\n# If the probability of Y is > 0.5, then it can be classified an event (presence of heart disease).\n# So if pred is greater than 0.5, it is positive(heart disease =yes) else it is negative\n\ny_pred_num <- ifelse(pred > 0.5, 1, 0)\ny_pred <- factor(y_pred_num, levels=c(0, 1))\ny_act <- testData$Diagnosis_Heart_Disease\n\n\n# Result : Prediction Accuracy (Proportion of predicted target that matches with actual target)\nmean(y_pred == y_act)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.752809\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# get the predicted probability in our dataset using the predict() function\n# We include the argument type=”response” in order to get our prediction.\n\npred_prob <- predict(logitmod4, heart_disease_dataset, type=\"response\")\n\n# create a decision rule using probability 0.5 as cutoff and save the predicted decision into the main data frame\nheart_disease_dataset$pred_Diagnosis_Heart_Disease_3 <- ifelse(pred_prob >= 0.5, 1, 0)\n\n# create a newdata data frame to save a new case information\nnewdata <- data.frame( Resting_Blood_Pressure=160,Num_Major_Vessels_Flouro=2,Thalassemia=2)\n\n# predict probability for this new case and print out the predicted value\np_new <- predict(logitmod4, newdata, type=\"response\")\np_new\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        1 \n0.9610853 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# load Metrics package\nlibrary(Metrics)\n\n# calculate auc, accuracy, clasification error\nauc <- auc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_3) \naccuracy <- accuracy(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_3)\nclassification_error <- ce(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_3) \n\n# print out the metrics on to screen\nprint(paste(\"AUC=\", auc))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"AUC= 0.792084854014598\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Accuracy=\", accuracy))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Accuracy= 0.791245791245791\"\n```\n:::\n\n```{.r .cell-code}\nprint(paste(\"Classification Error=\", classification_error))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Classification Error= 0.208754208754209\"\n```\n:::\n\n```{.r .cell-code}\n# confusion matrix\ntable(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease, dnn=c(\"True Status\", \"Predicted Status\")) # confusion matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Predicted Status\nTrue Status   0   1\n          0 140  20\n          1  27 110\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(roc(heart_disease_dataset$Diagnosis_Heart_Disease,heart_disease_dataset$pred_Diagnosis_Heart_Disease_3),print.auc=TRUE,legacy.axes=T)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting levels: control = 0, case = 1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nSetting direction: controls < cases\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_ManiKanta__files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nPlease cite as: \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n```\n:::\n\n```{.r .cell-code}\nstargazer(logitmod2, logitmod3,logitmod4, type = \"text\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n======================================================\n                              Dependent variable:     \n                         -----------------------------\n                            Diagnosis_Heart_Disease   \n                            (1)       (2)       (3)   \n------------------------------------------------------\nChest_Pain_Type          0.575***  0.689***           \n                          (0.178)   (0.169)           \n                                                      \nResting_Blood_Pressure    0.017*               0.013  \n                          (0.009)             (0.009) \n                                                      \nExercise_Induced_Angina  1.322***  1.239***           \n                          (0.367)   (0.335)           \n                                                      \nNum_Major_Vessels_Flouro 1.183***            1.205*** \n                          (0.214)             (0.196) \n                                                      \nThalassemia              1.013***  1.062***  1.175*** \n                          (0.175)   (0.159)   (0.160) \n                                                      \nConstant                 -5.676*** -2.958*** -3.558***\n                          (1.349)   (0.424)   (1.165) \n                                                      \n------------------------------------------------------\nObservations                297       297       297   \nLog Likelihood           -117.832  -139.584  -136.197 \nAkaike Inf. Crit.         247.665   287.169   280.394 \n======================================================\nNote:                      *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\n\n# Model Evaluation and Diagnostics\n\nA logistic regression models has been built and the coefficients have been examined. However, some critical questions remain.\n\nWhich model among all the models is good?\n\nWhcih Predictors are most important?\n\nAre the Predictions Accurate?\n\nTo answer these critical Questions We perform Model Evaluation Techniques:\n Likelihood Ratio Test (Goodness of fit)\n Varaible Importance\n\n\n#1. Likelihood Ratio Test (Goodness of fit) :\n\nA logistic regression is said to provide a better fit to the data if it demonstrates an improvement over a model with fewer predictors. This is performed using the likelihood ratio test, which compares the likelihood of the data under the full model against the likelihood of the data under a model with fewer predictors. Removing predictor variables from a model will almost always make the model fit less well (i.e. a model will have a lower log likelihood), but it is necessary to test whether the observed difference in model fit is statistically significant. Given that H0 holds that the reduced model is true, a p-value for the overall model fit statistic that is less than 0.05 would compel us to reject the null hypothesis. It would provide evidence against the reduced model in favor of the current model. The likelihood ratio test can be performed in R using the lrtest() function from the lmtest package or using the anova() function in base.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(model,logitmod2, test =\"Chisq\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Resid. Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Deviance\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chi)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"283\",\"2\":\"203.8609\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"291\",\"2\":\"235.6646\",\"3\":\"-8\",\"4\":\"-31.80371\",\"5\":\"0.0001009902\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlibrary(lmtest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'lmtest' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'zoo' was built under R version 4.1.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n```{.r .cell-code}\nlrtest(logitmod2,logitmod3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"#Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LogLik\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Df\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Chisq\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chisq)\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"6\",\"2\":\"-117.8323\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"NA\",\"_rn_\":\"1\"},{\"1\":\"4\",\"2\":\"-139.5844\",\"3\":\"-2\",\"4\":\"43.50422\",\"5\":\"3.574191e-10\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThe structure of this output:\n\nHere, we see each model listed out, followed by a table that shows each model’s degrees of freedom and loglikelihood. To the right of these values, we are given the degrees of freedom of our test statistic, the value of our test statistic, and then our p-value.   \n\nFrom the output we can see that the p-value of the likelihood ratio test is 0.000101. Since this is less than .05, we would reject the null hypothesis.\n\nThus, we would conclude that the model 3 with reduced predictors offers a significant improvement in fit over the model with just reduced predictors comapring with the model 2.\n\n\n# Variable Importance\n\nTo assess the relative importance of individual predictors in the model, we can also look at the absolute value of the t-statistic for each model parameter. This technique is utilized by the varImp function in the caret package for general and generalized linear models.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarImp(logitmod2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Overall\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3.228334\",\"_rn_\":\"Chest_Pain_Type\"},{\"1\":\"1.871053\",\"_rn_\":\"Resting_Blood_Pressure\"},{\"1\":\"3.600954\",\"_rn_\":\"Exercise_Induced_Angina\"},{\"1\":\"5.540799\",\"_rn_\":\"Num_Major_Vessels_Flouro\"},{\"1\":\"5.778032\",\"_rn_\":\"Thalassemia\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nvarImp(logitmod3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Overall\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4.066296\",\"_rn_\":\"Chest_Pain_Type\"},{\"1\":\"3.695847\",\"_rn_\":\"Exercise_Induced_Angina\"},{\"1\":\"6.699872\",\"_rn_\":\"Thalassemia\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nvarImp(logitmod4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Overall\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.446081\",\"_rn_\":\"Resting_Blood_Pressure\"},{\"1\":\"6.136708\",\"_rn_\":\"Num_Major_Vessels_Flouro\"},{\"1\":\"7.324856\",\"_rn_\":\"Thalassemia\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n\n# Model Comparison:\n\nIn the first Model, I have performed mutliple logistic regression with all the predictor valuables in the data to predict heart disease. \n\nBased on the first model , I found the variables which are statistically significant and which are not statistically significant.Variable which are statistically significant are Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemi .\n\nIn the third model , I have used all the predictors which are statistically significant and found the AUC of 84%. Later in the third model , I have used three variables which are statistically significant i.e.Chest_Pain_Type,Excercise_Induced_Angin as a predictor variables and found the AUC of 80.6%.\n\nRest three statistically significant variables :Resting_Blood_Pressure,Num_Major_Vessels_Flouro,Thalassemia are executed in this model and found the AUC of 79.2%\n\nBased on all these models, We can infer that the model with all the variables which are statistically significant are the best predictors to classify the patient for the heart disease diagnosis.\nThis model has an AUC of 84%\n\n# Conclusion\n\nAfter doing this analysis, I can conclude that the variables in data are not much correlated and there are more categorical variables.\n\nThe best Logistic model with dependent variable as Diagonsis-heart_Disease is Chest_Pain_Type,Resting_Blood_Pressure,Exercise_Induced_Angina,Num_Major_Vessels_Flouro,Thalassemia .Here we observed that accuracy, specificity, and sensitivity are good in their scores. The predictions on test data with this model are very good compared to any other logistic models.\n\n\n\n# References:\n\n1.EwR] Hanck, C., Arnold, M., Gerber, A. & Schmelzer, M. (2021) Introduction to Econometrics with R. (https://www.econometrics-with-r.org/)\n\n2.https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6616540/\n\n3.LSR] Navarro, Danielle. Learning Statistics with R. (freely available at https://learningstatisticswithr.com/)\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "Final_Project_ManiKanta__files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}