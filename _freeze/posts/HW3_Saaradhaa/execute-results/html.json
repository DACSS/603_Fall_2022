{
  "hash": "20da2715abc9df70bddda95a6dd4c72e",
  "result": {
    "markdown": "---\ntitle: \"Homework 3\"\nauthor: \"Saaradhaa M\"\ndate: \"10/28/2022\"\nformat: \n  html:\n    df-print: paged\n    toc: true\n    code-copy: true\n    code-tools: true\n    css: \"styles.css\"\ncategories:\n  - hw3\n---\n\n\n# Qn 1.1.1\n\nThe predictor is `ppgdp` and the response is `fertility`.\n\n# Qn 1.1.2\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries.\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.4 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n\n# load dataset.\ndata(UN11)\n\n# draw scatterplot.\nscatterplot(fertility ~ ppgdp, UN11)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nNo, the graph seems curvilinear.\n\n# Qn 1.1.3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# draw scatterplot.\nscatterplot (log(fertility) ~ log(ppgdp), UN11)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nYes, the simple linear regression model now seems plausible.\n\n# Qn 2a\n\nWe can test this using the UN11 dataset since `ppgdp` is in US dollars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create new variable.\nUN11$british <- 1.33*UN11$ppgdp\n\n# check slope.\nsummary(lm(fertility ~ british, UN11))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = fertility ~ british, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9006 -0.8801 -0.3547  0.6749  3.7585 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.178e+00  1.048e-01  30.331  < 2e-16 ***\nbritish     -2.407e-05  3.500e-06  -6.877  7.9e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.206 on 197 degrees of freedom\nMultiple R-squared:  0.1936,\tAdjusted R-squared:  0.1895 \nF-statistic: 47.29 on 1 and 197 DF,  p-value: 7.903e-11\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(fertility ~ ppgdp, UN11))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = fertility ~ ppgdp, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9006 -0.8801 -0.3547  0.6749  3.7585 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.178e+00  1.048e-01  30.331  < 2e-16 ***\nppgdp       -3.201e-05  4.655e-06  -6.877  7.9e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.206 on 197 degrees of freedom\nMultiple R-squared:  0.1936,\tAdjusted R-squared:  0.1895 \nF-statistic: 47.29 on 1 and 197 DF,  p-value: 7.903e-11\n```\n:::\n:::\n\n\nThe magnitude of the slope has reduced very slightly, although adjusted R\\^2 has not.\n\n# Qn 2b\n\nWe can test this too.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# correlation with US dollars.\ncor(UN11$ppgdp, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n\n```{.r .cell-code}\n# correlation with British pounds.\ncor(UN11$british, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n:::\n\n\nSince we multiplied by a constant, the correlation remains the same.\n\n# Qn 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load dataset.\ndata(water)\n\n# generate scatterplots.\npairs(water)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nStream runoff (BSAAM) seems to have a positive linear relationship with precipitation at OPSLAKE, OPRC and OPBPC; but not with precipitation at APMAM, APSAB or APSLAKE. Stream runoff also seems to be fairly constant (?) over the years.\n\n# Qn 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load dataset.\ndata(Rateprof)\n\n# create subset.\nrateprof <- Rateprof %>% select(quality, helpfulness, clarity, easiness, raterInterest)\n\n# generate scatterplots.\npairs(rateprof)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nQuality, helpfulness and clarity have the clearest linear relationships with one another. Easiness and raterInterest do not seem to have linear relationships with the other variables.\n\n# Qn 5a\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load dataset.\ndata(student.survey)\nglimpse(student.survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 60\nColumns: 18\n$ subj <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19…\n$ ge   <fct> m, f, f, f, m, m, m, f, m, m, m, f, m, m, f, f, f, m, m, f, f, f,…\n$ ag   <int> 32, 23, 27, 35, 23, 39, 24, 31, 34, 28, 23, 27, 36, 28, 28, 25, 4…\n$ hi   <dbl> 2.2, 2.1, 3.3, 3.5, 3.1, 3.5, 3.6, 3.0, 3.0, 4.0, 2.3, 3.5, 3.3, …\n$ co   <dbl> 3.5, 3.5, 3.0, 3.2, 3.5, 3.5, 3.7, 3.0, 3.0, 3.1, 2.6, 3.6, 3.5, …\n$ dh   <int> 0, 1200, 1300, 1500, 1600, 350, 0, 5000, 5000, 900, 253, 190, 245…\n$ dr   <dbl> 5.0, 0.3, 1.5, 8.0, 10.0, 3.0, 0.2, 1.5, 2.0, 2.0, 1.5, 3.0, 1.5,…\n$ tv   <dbl> 3, 15, 0, 5, 6, 4, 5, 5, 7, 1, 10, 14, 6, 3, 4, 7, 6, 5, 6, 25, 4…\n$ sp   <int> 5, 7, 4, 5, 6, 5, 12, 3, 5, 1, 15, 3, 15, 10, 3, 6, 7, 9, 12, 0, …\n$ ne   <int> 0, 5, 3, 6, 3, 7, 4, 3, 3, 2, 1, 7, 12, 1, 1, 1, 3, 6, 2, 0, 4, 7…\n$ ah   <int> 0, 6, 0, 3, 0, 0, 2, 1, 0, 1, 1, 0, 5, 2, 0, 0, 10, 10, 2, 2, 1, …\n$ ve   <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FA…\n$ pa   <fct> r, d, d, i, i, d, i, i, i, i, r, d, d, i, d, i, i, d, i, d, i, i,…\n$ pi   <ord> conservative, liberal, liberal, moderate, very liberal, liberal, …\n$ re   <ord> most weeks, occasionally, most weeks, occasionally, never, occasi…\n$ ab   <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FA…\n$ aa   <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FA…\n$ ld   <lgl> FALSE, NA, NA, FALSE, FALSE, NA, FALSE, FALSE, NA, FALSE, FALSE, …\n```\n:::\n\n```{.r .cell-code}\n# generate plots.\nboxplot(pi ~ re, student.survey)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nscatterplot(hi ~ tv, student.survey)\n```\n\n::: {.cell-output-display}\n![](HW3_Saaradhaa_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n-   Religiosity and conservatism seem to have a positive relationship.\n-   High school GPA and TV-watching seem to have a negative relationship.\n\n# Qn 5b\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# change pi to numeric variable.\nstudent.survey$pi <- as.numeric(student.survey$pi)\n\n# removing ordering in re and rename it.\nlevels(student.survey$re) <- c(\"N\", \"O\", \"M\", \"E\")\nstudent.survey$re <- factor(student.survey$re, ordered = FALSE)\n\n# run regression models.\nsummary(lm(pi ~ re, student.survey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pi ~ re, data = student.survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.8889 -0.5172 -0.2667  1.2040  2.7333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   2.2667     0.3394   6.678 1.18e-08 ***\nreO           0.2506     0.4181   0.599 0.551374    \nreM           2.1619     0.6017   3.593 0.000691 ***\nreE           2.6222     0.5543   4.731 1.56e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.315 on 56 degrees of freedom\nMultiple R-squared:  0.3872,\tAdjusted R-squared:  0.3544 \nF-statistic:  11.8 on 3 and 56 DF,  p-value: 4.282e-06\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(hi ~ tv, student.survey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = student.survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n:::\n\n\n-   Those who attended religious services most weeks/every week were significantly more likely to be conservative than those who never did, *p* \\< .001. There was no significant difference in political ideology between those who occasionally attended religious services and those who never did.\n-   Watching less hours of TV per week was associated with higher high-school GPAs, *p* \\< .05. That being said, as the R^2^ is fairly low, hours of TV watching is not a great predictor of high school GPA.\n",
    "supporting": [
      "HW3_Saaradhaa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}