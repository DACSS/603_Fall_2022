{
  "hash": "dda7371d16194109734e2fdb4f4fc461",
  "result": {
    "markdown": "---\ntitle: \"Final Project Part 2\"\nauthor: \"Ken Docekal\"\ndesription: \"Part 2 Analysis\"\ndate: \"11/12/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - finalpart2\n  - descriptive statistics \n  - analysis\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(readxl)\n\n\nstatedata <- read.csv(\"_data/correlatesofstatepolicyprojectv1_10.csv\")\n```\n:::\n\n\n\n\n#Expanded Data Description\n\n\n###Variables and missing data\n\nSpecifying variables for relevance and data availability\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatedata1 = subset(statedata, select = c(state, year, policypriorityscore, econdev, pldvpag, urbrenen, nonwhite, soc_capital_ma, evangelical_pop, pc_inc_ann, gini_coef, hsdiploma, co2emissions, ideo,st_ec, st_soc,  pop_annual))\n```\n:::\n\n\n\n\nWe transform co2 emission variable from raw tons to ton per state resident \n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatedata1$co2 <- statedata1$co2emissions / statedata1$pop_annual\n```\n:::\n\n\n\n\nCreating data subset with new variables, removing pre-transformation and aggregate population measures \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd = subset(statedata1, select = c(state, year, policypriorityscore, econdev, pldvpag, urbrenen, nonwhite, soc_capital_ma, evangelical_pop, pc_inc_ann, gini_coef, hsdiploma, co2, ideo,st_ec, st_soc))\n```\n:::\n\n\n\nDue to additional missing observations we will set the new data range as 1980 to 2000.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nview(sd)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsd1 <- subset(sd, year>1979 & year<2001, na.rm = TRUE ) \n```\n:::\n\n\n\n\nNAs are reduced as listwise removal of observations that are missing completely at random analysis will be unbiased\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    state                year      policypriorityscore    econdev     \n Length:5967        Min.   :1900   Min.   :-0.230      Min.   :0.000  \n Class :character   1st Qu.:1929   1st Qu.:-0.045      1st Qu.:0.000  \n Mode  :character   Median :1958   Median : 0.003      Median :0.000  \n                    Mean   :1958   Mean   : 0.000      Mean   :0.112  \n                    3rd Qu.:1987   3rd Qu.: 0.055      3rd Qu.:0.000  \n                    Max.   :2016   Max.   : 0.199      Max.   :1.000  \n                                   NA's   :4767        NA's   :1067   \n    pldvpag          urbrenen         nonwhite     soc_capital_ma  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.005   Min.   :-2.913  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.088   1st Qu.:-0.452  \n Median :1.0000   Median :0.0000   Median :0.166   Median : 0.169  \n Mean   :0.6065   Mean   :0.4282   Mean   :0.197   Mean   : 0.204  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.283   3rd Qu.: 0.841  \n Max.   :1.0000   Max.   :1.0000   Max.   :0.768   Max.   : 3.087  \n NA's   :1067     NA's   :1067     NA's   :4067    NA's   :4623    \n evangelical_pop   pc_inc_ann      gini_coef        hsdiploma    \n Min.   : 1.10   Min.   :  122   Min.   :0.2314   Min.   : 0.00  \n 1st Qu.:10.20   1st Qu.: 1421   1st Qu.:0.4277   1st Qu.:74.70  \n Median :14.60   Median : 4016   Median :0.4700   Median :78.70  \n Mean   :18.93   Mean   :11010   Mean   :0.4838   Mean   :77.72  \n 3rd Qu.:26.00   3rd Qu.:18765   3rd Qu.:0.5493   3rd Qu.:82.40  \n Max.   :74.00   Max.   :73105   Max.   :0.7474   Max.   :91.80  \n NA's   :4017    NA's   :1776    NA's   :1104     NA's   :4355   \n      co2            ideo            st_ec            st_soc      \n Min.   :0      Min.   :-0.581   Min.   :-0.215   Min.   :-0.371  \n 1st Qu.:0      1st Qu.:-0.224   1st Qu.:-0.087   1st Qu.:-0.171  \n Median :0      Median :-0.145   Median :-0.017   Median :-0.002  \n Mean   :0      Mean   :-0.140   Mean   :-0.016   Mean   :-0.026  \n 3rd Qu.:0      3rd Qu.:-0.063   3rd Qu.: 0.024   3rd Qu.: 0.116  \n Max.   :0      Max.   : 0.455   Max.   : 0.192   Max.   : 0.363  \n NA's   :3825   NA's   :4169     NA's   :5920     NA's   :5920    \n```\n:::\n\n```{.r .cell-code}\nsummary(sd1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    state                year      policypriorityscore    econdev      \n Length:1071        Min.   :1980   Min.   :-0.22959    Min.   :0.0000  \n Class :character   1st Qu.:1985   1st Qu.:-0.03723    1st Qu.:0.0000  \n Mode  :character   Median :1990   Median : 0.01445    Median :0.0000  \n                    Mean   :1990   Mean   : 0.00926    Mean   :0.2943  \n                    3rd Qu.:1995   3rd Qu.: 0.06381    3rd Qu.:1.0000  \n                    Max.   :2000   Max.   : 0.19866    Max.   :1.0000  \n                                   NA's   :121         NA's   :21      \n    pldvpag        urbrenen       nonwhite        soc_capital_ma   \n Min.   :0.00   Min.   :0.00   Min.   :0.008276   Min.   :-2.9133  \n 1st Qu.:1.00   1st Qu.:0.00   1st Qu.:0.086113   1st Qu.:-0.4193  \n Median :1.00   Median :1.00   Median :0.165753   Median : 0.2357  \n Mean   :0.86   Mean   :0.68   Mean   :0.190408   Mean   : 0.3108  \n 3rd Qu.:1.00   3rd Qu.:1.00   3rd Qu.:0.269196   3rd Qu.: 1.0615  \n Max.   :1.00   Max.   :1.00   Max.   :0.713008   Max.   : 3.0868  \n NA's   :21     NA's   :21     NA's   :21         NA's   :255      \n evangelical_pop   pc_inc_ann      gini_coef        hsdiploma    \n Min.   : 1.10   Min.   : 7005   Min.   :0.4518   Min.   : 0.00  \n 1st Qu.:10.30   1st Qu.:13387   1st Qu.:0.5124   1st Qu.:73.90  \n Median :14.40   Median :17910   Median :0.5494   Median :77.10  \n Mean   :19.36   Mean   :18525   Mean   :0.5447   Mean   :76.22  \n 3rd Qu.:26.10   3rd Qu.:22760   3rd Qu.:0.5713   3rd Qu.:80.80  \n Max.   :74.00   Max.   :41920   Max.   :0.6951   Max.   :91.80  \n NA's   :21                                       NA's   :14     \n      co2                 ideo              st_ec             st_soc       \n Min.   :6.608e-06   Min.   :-0.58064   Min.   :-0.2145   Min.   :-0.3715  \n 1st Qu.:1.455e-05   1st Qu.:-0.21875   1st Qu.:-0.0867   1st Qu.:-0.1708  \n Median :1.906e-05   Median :-0.14242   Median :-0.0167   Median :-0.0016  \n Mean   :2.391e-05   Mean   :-0.13955   Mean   :-0.0157   Mean   :-0.0256  \n 3rd Qu.:2.695e-05   3rd Qu.:-0.06557   3rd Qu.: 0.0244   3rd Qu.: 0.1157  \n Max.   :1.308e-04   Max.   : 0.45454   Max.   : 0.1916   Max.   : 0.3627  \n                     NA's   :30         NA's   :1024      NA's   :1024     \n```\n:::\n:::\n\n\n\nExcluding District of Columbia, Alaska, Hawaii to further reduce NAs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsdd <- subset(sd1, state != \"District of Columbia\", na.rm = TRUE ) \n\nsda <- subset(sdd, state != \"Alaska\", na.rm = TRUE ) \n\nsd2 <- subset(sda, state != \"Hawaii\", na.rm = TRUE ) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(sd2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    state                year      policypriorityscore    econdev      \n Length:1008        Min.   :1980   Min.   :-0.22959    Min.   :0.0000  \n Class :character   1st Qu.:1985   1st Qu.:-0.03902    1st Qu.:0.0000  \n Mode  :character   Median :1990   Median : 0.01239    Median :0.0000  \n                    Mean   :1990   Mean   : 0.00680    Mean   :0.2817  \n                    3rd Qu.:1995   3rd Qu.: 0.06281    3rd Qu.:1.0000  \n                    Max.   :2000   Max.   : 0.18716    Max.   :1.0000  \n                                   NA's   :96                          \n    pldvpag          urbrenen         nonwhite        soc_capital_ma   \n Min.   :0.0000   Min.   :0.0000   Min.   :0.008276   Min.   :-2.9133  \n 1st Qu.:1.0000   1st Qu.:0.0000   1st Qu.:0.084359   1st Qu.:-0.4193  \n Median :1.0000   Median :1.0000   Median :0.150717   Median : 0.2357  \n Mean   :0.8958   Mean   :0.7083   Mean   :0.178788   Mean   : 0.3108  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:0.265522   3rd Qu.: 1.0615  \n Max.   :1.0000   Max.   :1.0000   Max.   :0.540415   Max.   : 3.0868  \n                                                      NA's   :192      \n evangelical_pop   pc_inc_ann      gini_coef        hsdiploma    \n Min.   : 1.10   Min.   : 7005   Min.   :0.4518   Min.   :64.30  \n 1st Qu.:10.30   1st Qu.:13144   1st Qu.:0.5122   1st Qu.:73.90  \n Median :14.50   Median :17694   Median :0.5491   Median :76.80  \n Mean   :19.65   Mean   :18259   Mean   :0.5431   Mean   :76.44  \n 3rd Qu.:29.50   3rd Qu.:22444   3rd Qu.:0.5695   3rd Qu.:80.80  \n Max.   :74.00   Max.   :41920   Max.   :0.6557   Max.   :91.80  \n                                                                 \n      co2                 ideo              st_ec             st_soc       \n Min.   :7.336e-06   Min.   :-0.58064   Min.   :-0.2145   Min.   :-0.3715  \n 1st Qu.:1.458e-05   1st Qu.:-0.22117   1st Qu.:-0.0867   1st Qu.:-0.1708  \n Median :1.929e-05   Median :-0.14621   Median :-0.0167   Median :-0.0016  \n Mean   :2.368e-05   Mean   :-0.14554   Mean   :-0.0157   Mean   :-0.0256  \n 3rd Qu.:2.667e-05   3rd Qu.:-0.07135   3rd Qu.: 0.0244   3rd Qu.: 0.1157  \n Max.   :1.308e-04   Max.   : 0.36842   Max.   : 0.1916   Max.   : 0.3627  \n                                        NA's   :961       NA's   :961      \n```\n:::\n:::\n\n\n\n\n\n###Visual description \n\nMost explanatory variables like econdev, pldvpag, and urbrenen are dummy variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sd2, aes(x = econdev)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\nThe exception is policypriorityscore which is normally distributed. \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sd2, aes(x = policypriorityscore)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 96 rows containing non-finite values (stat_bin).\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\nControl variables  nonwhite, soc_capital_ma, evangelical_pop, pc_inc_ann, gini_coef, hsdiploma, and co2 are normally distributed\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(sd2$nonwhite)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$soc_capital_ma)\nhist(sd2$soc_capital_ma)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$evangelical_pop)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$pc_inc_ann)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-4.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$gini_coef)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-5.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$hsdiploma)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-6.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$co2)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-13-7.png){width=672}\n:::\n:::\n\n\n\n\n\nResponse variables are also linear but st_ec and st_soc are only avaliable for the year 2000\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(sd2$ideo)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$st_ec)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(sd2$st_soc)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n:::\n\n\n\nThe relationship between response st_ec and select explanatory and control variables in scatterplots:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = sd2, aes(x = econdev, y = st_ec)) +\n  geom_point() +\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing non-finite values (stat_smooth).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = sd2, aes(x = nonwhite, y = st_ec)) +\n  geom_point() +\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing non-finite values (stat_smooth).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = sd2, aes(x = co2, y = st_ec)) +\n  geom_point() +\n  geom_smooth(method = 'lm', se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing non-finite values (stat_smooth).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nWith log(co2):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = sd2, aes(x = log(co2), y = st_ec)) +\n  geom_point() +\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing non-finite values (stat_smooth).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 961 rows containing missing values (geom_point).\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n\nSimilar relationship with boxplots:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(st_ec ~ econdev, data = sd2)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(st_ec ~ nonwhite, data = sd2)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(st_ec ~ co2, data = sd2)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(st_ec ~ log(co2), data = sd2)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n\n\n# Hypothesis testing\n\n\n\nOur dataset now contains the following variables:\n\n\nYear  1935 - 2000\n\nState 1935 - 2000\n\n\nExplanatory-\n\nEcondev - Did State adopt Strategic Planning for Economic Development? 1981 – 1992\n\nPldvpag - Did State adopt Planning/Development Agency? 1935 – 1978\n\nUrbrenen - Did State adopt Urban Renewal ?  1941 – 1952 \n\nPolicypriorityscore - State Policy Priority Score - collective goods (e.g., education and highways) v particularized benefits (e.g., health care and welfare)  1982-2005\n\n\nControl-\n\nNonwhite - Proportion of the population that is nonwhite 1974 - 2011 \n\nSoc_capital_ma - Hawes et al. Weighted Moving Average Measure of Social Capital, rate per capita 1984 - 2011\n\nEvangelical_pop - Evangelical Population, rate per capita 1975 - 2013\n\npc_inc_ann - Per Capita Annual Income, rate per capita 1929 – 2011\n\nGini_coef - Gini Coefficient 1917 - 2013\n\nHsdiploma  - High School Diploma, rate per capita 1975 – 2006\n\nCo2 - Total CO2 emissions from fossil-fuels (metric tons), rate per capita  1960 – 2001\n\n\nResponse-\n\nIdeo - State Ideology Score 1976 – 2011\n\nst_ec - Mean Economic Liberalism 2000\n\nst_soc - Mean Social Liberalism 2000 \n\n\n\n\nco2emissions was transformed to co2 to change the measure from raw tons to ton per state resident. This enables the variable's unit of measure to align with the units of the other variables used. \n\n\n\n\n\nWe test for the Hypothesis that state social-economic policy interventions have no effect on population policy preferences.\n\n\nObserving the linear regression model with all variables through stargazer shows high p=values for multiple variables and r2 low for most variables with the highest barely above .5. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(st_ec ~ co2 + pldvpag, sd2))$fstatistic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    value     numdf     dendf \n 5.062298  2.000000 44.000000 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages('stargazer')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/srika/AppData/Local/R/win-library/4.2'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): trying to use CRAN without setting a mirror\n```\n:::\n\n```{.r .cell-code}\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(stargazer): there is no package called 'stargazer'\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(st_ec ~ policypriorityscore, data = sd2)\nm2 <- lm(st_ec ~ policypriorityscore + econdev, data = sd2)\nm3 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag, data = sd2)\nm4 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen, data = sd2)\nm5 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite, data = sd2)\nm6 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma, data = sd2)\nm7 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop, data = sd2)\nm8 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop + pc_inc_ann, data = sd2)\nm9 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop + pc_inc_ann + gini_coef, data = sd2)\nm10 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop + pc_inc_ann + gini_coef + hsdiploma, data = sd2)\nm11 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop + pc_inc_ann + gini_coef + hsdiploma + co2, data = sd2)\nm12 <- lm(st_ec ~ policypriorityscore + econdev + pldvpag + urbrenen + nonwhite + soc_capital_ma + evangelical_pop + pc_inc_ann + gini_coef + hsdiploma + co2 + ideo, data = sd2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstargazer(m1, m2, m3,m4,m5,m6,m7,m8,m9,m10,m11,m12, type = 'text')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12, : could not find function \"stargazer\"\n```\n:::\n:::\n\n\n\n\nLooking at variable correlations there is a potential confounder variable with pc_inc_ann and gini_coef, but neither has high correlation with any other variable.\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(sd2$pc_inc_ann, sd2$gini_coef)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.699011\n```\n:::\n:::\n\n\n\n\nWe instead use the model from model comparison #3 with limited variables:\n\nMust remove state first\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd3 = subset(sd2, select = c(year, policypriorityscore, econdev, pldvpag, urbrenen, nonwhite, soc_capital_ma, evangelical_pop, pc_inc_ann, gini_coef, hsdiploma, co2, ideo,st_ec, st_soc))\n```\n:::\n\n\n\nselected model - \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(formula = st_ec ~ policypriorityscore + log(nonwhite) + hsdiploma + \n    st_soc, data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + log(nonwhite) + hsdiploma + \n    st_soc, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.105985 -0.038466  0.001818  0.030985  0.099538 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          0.99820    0.23277   4.288 0.000103 ***\npolicypriorityscore -0.58543    0.13616  -4.300 9.96e-05 ***\nlog(nonwhite)       -0.03483    0.01247  -2.794 0.007814 ** \nhsdiploma           -0.01259    0.00282  -4.464 5.95e-05 ***\nst_soc               0.34288    0.05219   6.570 6.02e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.05578 on 42 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.7119,\tAdjusted R-squared:  0.6844 \nF-statistic: 25.94 on 4 and 42 DF,  p-value: 7.146e-11\n```\n:::\n:::\n\n\n\nResult - We are able to reject the null Hypothesis at the 95% confidence level as a small but statistically significant effect is observed\n\n\n\n\n\n# Model comparison\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"magrittr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/srika/AppData/Local/R/win-library/4.2'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): trying to use CRAN without setting a mirror\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(magrittr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'magrittr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    set_names\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:tidyr':\n\n    extract\n```\n:::\n:::\n\n\n\n\n## 1\n\nCross-validation with training and test set\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nsd2 %>% nrow() %>% multiply_by(0.7) %>% round() -> training_set_size\ntrain_indices <- sample(1:nrow(sd2), training_set_size)\ntrain <- sd2[train_indices,]\ntest <- sd2[-train_indices,]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(train)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 706\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(test)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 302\n```\n:::\n:::\n\n\n\nBase model with all variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbase <- lm(st_ec ~ . , data = train)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(base)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: not plotting observations with leverage one:\n  1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in min(x): no non-missing arguments to min; returning Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in max(x): no non-missing arguments to max; returning -Inf\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in qqnorm.default(rs, main = main, ylab = ylab23, ylim = ylim, ...): y is empty or has only NAs\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n\nAttempt to remove state\n\n\n::: {.cell}\n\n```{.r .cell-code}\nno_region <- lm(st_ec ~ . - state, data = train)\n```\n:::\n\n\n\nWith interaction term\n\n\n::: {.cell}\n\n```{.r .cell-code}\nia <- lm(st_ec ~ . + pc_inc_ann*hsdiploma, data = train)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(ia)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: not plotting observations with leverage one:\n  1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in min(x): no non-missing arguments to min; returning Inf\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in max(x): no non-missing arguments to max; returning -Inf\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in qqnorm.default(rs, main = main, ylab = ylab23, ylim = ylim, ...): y is empty or has only NAs\n```\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean((predict(base, test) - test$st_ec)^2) -> MSE_base\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor state has new levels Alabama, Arizona, Delaware, Georgia, Idaho, Iowa, Michigan, Nebraska, Pennsylvania, Utah, Wisconsin, Wyoming\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean((predict(no_region, test) - test$st_ec)^2) -> MSE_no_region\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor state has new levels Alabama, Arizona, Delaware, Georgia, Idaho, Iowa, Michigan, Nebraska, Pennsylvania, Utah, Wisconsin, Wyoming\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean((predict(ia, test) - test$st_ec)^2) -> MSE_ia\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor state has new levels Alabama, Arizona, Delaware, Georgia, Idaho, Iowa, Michigan, Nebraska, Pennsylvania, Utah, Wisconsin, Wyoming\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean((predict(ia, test) - test$st_ec)^2) -> MSE_ia\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor state has new levels Alabama, Arizona, Delaware, Georgia, Idaho, Iowa, Michigan, Nebraska, Pennsylvania, Utah, Wisconsin, Wyoming\n```\n:::\n:::\n\n\n\n\n## 2\n\nBackward elimination \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ ., data = sd2) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ ., data = sd2)\n\nResiduals:\nALL 47 residuals are 0: no residual degrees of freedom!\n\nCoefficients: (14 not defined because of singularities)\n                     Estimate Std. Error t value Pr(>|t|)\n(Intercept)         -0.038403        NaN     NaN      NaN\nstateArizona        -0.012308        NaN     NaN      NaN\nstateArkansas        0.021562        NaN     NaN      NaN\nstateCalifornia      0.031151        NaN     NaN      NaN\nstateColorado       -0.080098        NaN     NaN      NaN\nstateConnecticut     0.131448        NaN     NaN      NaN\nstateDelaware        0.014173        NaN     NaN      NaN\nstateFlorida         0.049612        NaN     NaN      NaN\nstateGeorgia        -0.067636        NaN     NaN      NaN\nstateIdaho          -0.148045        NaN     NaN      NaN\nstateIllinois        0.062778        NaN     NaN      NaN\nstateIndiana        -0.036880        NaN     NaN      NaN\nstateIowa           -0.132971        NaN     NaN      NaN\nstateKansas         -0.071066        NaN     NaN      NaN\nstateKentucky        0.054573        NaN     NaN      NaN\nstateLouisiana       0.021910        NaN     NaN      NaN\nstateMaine           0.147176        NaN     NaN      NaN\nstateMaryland        0.145870        NaN     NaN      NaN\nstateMassachusetts   0.221486        NaN     NaN      NaN\nstateMichigan        0.037647        NaN     NaN      NaN\nstateMinnesota      -0.053475        NaN     NaN      NaN\nstateMississippi     0.021773        NaN     NaN      NaN\nstateMissouri       -0.080424        NaN     NaN      NaN\nstateMontana         0.044836        NaN     NaN      NaN\nstateNevada         -0.018206        NaN     NaN      NaN\nstateNew Hampshire   0.103719        NaN     NaN      NaN\nstateNew Jersey      0.151180        NaN     NaN      NaN\nstateNew Mexico      0.021713        NaN     NaN      NaN\nstateNew York        0.230023        NaN     NaN      NaN\nstateNorth Carolina  0.057222        NaN     NaN      NaN\nstateNorth Dakota   -0.119446        NaN     NaN      NaN\nstateOhio            0.019121        NaN     NaN      NaN\nstateOklahoma       -0.043207        NaN     NaN      NaN\nstateOregon          0.056329        NaN     NaN      NaN\nstatePennsylvania    0.126404        NaN     NaN      NaN\nstateRhode Island    0.187720        NaN     NaN      NaN\nstateSouth Carolina -0.001439        NaN     NaN      NaN\nstateSouth Dakota   -0.176105        NaN     NaN      NaN\nstateTennessee       0.032912        NaN     NaN      NaN\nstateTexas          -0.067259        NaN     NaN      NaN\nstateUtah           -0.090002        NaN     NaN      NaN\nstateVermont         0.208597        NaN     NaN      NaN\nstateVirginia        0.062810        NaN     NaN      NaN\nstateWashington     -0.006842        NaN     NaN      NaN\nstateWest Virginia   0.128481        NaN     NaN      NaN\nstateWisconsin       0.005363        NaN     NaN      NaN\nstateWyoming        -0.127431        NaN     NaN      NaN\nyear                       NA         NA      NA       NA\npolicypriorityscore        NA         NA      NA       NA\necondev                    NA         NA      NA       NA\npldvpag                    NA         NA      NA       NA\nurbrenen                   NA         NA      NA       NA\nnonwhite                   NA         NA      NA       NA\nsoc_capital_ma             NA         NA      NA       NA\nevangelical_pop            NA         NA      NA       NA\npc_inc_ann                 NA         NA      NA       NA\ngini_coef                  NA         NA      NA       NA\nhsdiploma                  NA         NA      NA       NA\nco2                        NA         NA      NA       NA\nideo                       NA         NA      NA       NA\nst_soc                     NA         NA      NA       NA\n\nResidual standard error: NaN on 0 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:      1,\tAdjusted R-squared:    NaN \nF-statistic:   NaN on 46 and 0 DF,  p-value: NA\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsd3 = subset(sd2, select = c(year, policypriorityscore, econdev, pldvpag, urbrenen, nonwhite, soc_capital_ma, evangelical_pop, pc_inc_ann, gini_coef, hsdiploma, co2, ideo,st_ec, st_soc))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ ., data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ ., data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.100478 -0.032490 -0.005094  0.039044  0.098876 \n\nCoefficients: (1 not defined because of singularities)\n                      Estimate Std. Error t value Pr(>|t|)   \n(Intercept)          1.220e+00  3.456e-01   3.531  0.00125 **\nyear                        NA         NA      NA       NA   \npolicypriorityscore -4.394e-01  1.866e-01  -2.355  0.02462 * \necondev             -1.698e-02  1.804e-02  -0.941  0.35331   \npldvpag              3.069e-02  3.116e-02   0.985  0.33179   \nurbrenen             1.308e-02  2.683e-02   0.488  0.62906   \nnonwhite            -2.035e-01  1.042e-01  -1.953  0.05929 . \nsoc_capital_ma      -3.491e-02  2.629e-02  -1.328  0.19324   \nevangelical_pop     -7.226e-04  9.797e-04  -0.738  0.46601   \npc_inc_ann          -2.421e-06  4.374e-06  -0.554  0.58365   \ngini_coef           -4.285e-01  4.835e-01  -0.886  0.38192   \nhsdiploma           -1.004e-02  3.590e-03  -2.798  0.00851 **\nco2                 -1.521e+02  7.283e+02  -0.209  0.83581   \nideo                 1.505e-01  1.641e-01   0.917  0.36572   \nst_soc               3.714e-01  1.279e-01   2.905  0.00651 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.05653 on 33 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.7675,\tAdjusted R-squared:  0.6759 \nF-statistic: 8.378 on 13 and 33 DF,  p-value: 4.133e-07\n```\n:::\n:::\n\n\n\nInclusion of policypriorityscore, nonwhite, hsdiploma, and st_soc only has the highest adjusted R squared\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ .-econdev -pldvpag -urbrenen -soc_capital_ma -evangelical_pop -pc_inc_ann -gini_coef -co2 -ideo , data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ . - econdev - pldvpag - urbrenen - soc_capital_ma - \n    evangelical_pop - pc_inc_ann - gini_coef - co2 - ideo, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.108606 -0.039738 -0.002334  0.031586  0.101660 \n\nCoefficients: (1 not defined because of singularities)\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          1.174528   0.267140   4.397 7.35e-05 ***\nyear                       NA         NA      NA       NA    \npolicypriorityscore -0.585220   0.136907  -4.275 0.000108 ***\nnonwhite            -0.206434   0.076446  -2.700 0.009941 ** \nhsdiploma           -0.013410   0.003006  -4.461 6.00e-05 ***\nst_soc               0.360374   0.054152   6.655 4.54e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.05607 on 42 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.7089,\tAdjusted R-squared:  0.6811 \nF-statistic: 25.57 on 4 and 42 DF,  p-value: 8.847e-11\n```\n:::\n:::\n\n\n\n\n## 3\n\nForward selection\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore , data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.162156 -0.054892  0.003181  0.042129  0.235594 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -0.02663    0.01155  -2.305   0.0258 *  \npolicypriorityscore -0.92890    0.17092  -5.435 2.14e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.078 on 45 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.3963,\tAdjusted R-squared:  0.3829 \nF-statistic: 29.54 on 1 and 45 DF,  p-value: 2.136e-06\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore + econdev, data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + econdev, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.167145 -0.058159  0.008671  0.040615  0.230549 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -0.02175    0.01595  -1.364    0.180    \npolicypriorityscore -0.92496    0.17268  -5.357 2.95e-06 ***\necondev             -0.01033    0.02304  -0.448    0.656    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.0787 on 44 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.399,\tAdjusted R-squared:  0.3717 \nF-statistic: 14.61 on 2 and 44 DF,  p-value: 1.364e-05\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore + pldvpag, data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + pldvpag, data = sd3)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.13585 -0.05871  0.00821  0.03793  0.22754 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -0.07464    0.03463  -2.155   0.0367 *  \npolicypriorityscore -0.88617    0.17126  -5.175 5.41e-06 ***\npldvpag              0.05428    0.03698   1.468   0.1492    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.07702 on 44 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.4245,\tAdjusted R-squared:  0.3983 \nF-statistic: 16.23 on 2 and 44 DF,  p-value: 5.267e-06\n```\n:::\n:::\n\n\n\nEvangelical_pop is does not increase p-value\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore + evangelical_pop, data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + evangelical_pop, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.175633 -0.037558  0.000244  0.049656  0.188991 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          0.0217794  0.0177642   1.226   0.2267    \npolicypriorityscore -0.7956940  0.1591509  -5.000 9.65e-06 ***\nevangelical_pop     -0.0025410  0.0007552  -3.365   0.0016 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.07035 on 44 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.5198,\tAdjusted R-squared:  0.498 \nF-statistic: 23.82 on 2 and 44 DF,  p-value: 9.786e-08\n```\n:::\n:::\n\n\n\nAll other additions increase p-value\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore + evangelical_pop + pc_inc_ann, data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + evangelical_pop + \n    pc_inc_ann, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.173379 -0.041717 -0.000328  0.051878  0.191366 \n\nCoefficients:\n                      Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         -7.023e-03  9.369e-02  -0.075   0.9406    \npolicypriorityscore -7.852e-01  1.643e-01  -4.780 2.07e-05 ***\nevangelical_pop     -2.388e-03  9.052e-04  -2.639   0.0115 *  \npc_inc_ann           9.061e-07  2.893e-06   0.313   0.7556    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.07108 on 43 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.5209,\tAdjusted R-squared:  0.4875 \nF-statistic: 15.59 on 3 and 43 DF,  p-value: 5.269e-07\n```\n:::\n:::\n\n\n\n\n##4 \n\nLog-linear transformation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(log(st_ec) ~ .-econdev -pldvpag -urbrenen -soc_capital_ma -evangelical_pop -pc_inc_ann -gini_coef -co2 -ideo , data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in log(st_ec): NaNs produced\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(st_ec) ~ . - econdev - pldvpag - urbrenen - \n    soc_capital_ma - evangelical_pop - pc_inc_ann - gini_coef - \n    co2 - ideo, data = sd3)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.9592 -0.4953 -0.1379  0.5761  1.1909 \n\nCoefficients: (1 not defined because of singularities)\n                    Estimate Std. Error t value Pr(>|t|)   \n(Intercept)         10.00268    6.53823   1.530  0.15001   \nyear                      NA         NA      NA       NA   \npolicypriorityscore -4.83181    3.11076  -1.553  0.14436   \nnonwhite            -2.51193    1.63967  -1.532  0.14950   \nhsdiploma           -0.15322    0.07597  -2.017  0.06484 . \nst_soc               4.59439    1.49963   3.064  0.00906 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7851 on 13 degrees of freedom\n  (990 observations deleted due to missingness)\nMultiple R-squared:  0.5959,\tAdjusted R-squared:  0.4715 \nF-statistic: 4.792 on 4 and 13 DF,  p-value: 0.0135\n```\n:::\n:::\n\n\n\n\n##5\n\nLinear-log\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ log(policypriorityscore) + nonwhite + hsdiploma + st_soc , data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in log(policypriorityscore): NaNs produced\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ log(policypriorityscore) + nonwhite + hsdiploma + \n    st_soc, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.115600 -0.050721 -0.000798  0.040976  0.097815 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)   \n(Intercept)               0.990308   0.600184   1.650  0.11729   \nlog(policypriorityscore) -0.006349   0.016818  -0.377  0.71048   \nnonwhite                 -0.182903   0.165846  -1.103  0.28546   \nhsdiploma                -0.011932   0.006463  -1.846  0.08233 . \nst_soc                    0.387463   0.100425   3.858  0.00126 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.06913 on 17 degrees of freedom\n  (986 observations deleted due to missingness)\nMultiple R-squared:  0.4971,\tAdjusted R-squared:  0.3788 \nF-statistic: 4.201 on 4 and 17 DF,  p-value: 0.01516\n```\n:::\n:::\n\n\n\nLinear-log for nonwhite only results in highest adjusted R-squared\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(st_ec ~ policypriorityscore + log(nonwhite) + hsdiploma + st_soc , data = sd3) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = st_ec ~ policypriorityscore + log(nonwhite) + hsdiploma + \n    st_soc, data = sd3)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.105985 -0.038466  0.001818  0.030985  0.099538 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          0.99820    0.23277   4.288 0.000103 ***\npolicypriorityscore -0.58543    0.13616  -4.300 9.96e-05 ***\nlog(nonwhite)       -0.03483    0.01247  -2.794 0.007814 ** \nhsdiploma           -0.01259    0.00282  -4.464 5.95e-05 ***\nst_soc               0.34288    0.05219   6.570 6.02e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.05578 on 42 degrees of freedom\n  (961 observations deleted due to missingness)\nMultiple R-squared:  0.7119,\tAdjusted R-squared:  0.6844 \nF-statistic: 25.94 on 4 and 42 DF,  p-value: 7.146e-11\n```\n:::\n:::\n\n\n\n\n##6\n\nTwo Period Panel data comparing 1990 and 2000 \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd1990 <- subset(sd2, year = 1990, na.rm = TRUE ) \n\nsd2000 <- subset(sd2, year = 1990, na.rm = TRUE ) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndiff_ideo <- sd2000$ideo - sd1990$ideo\ndiff_econdev<- sd2000$econdev - sd1990$econdev\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"AER\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/srika/AppData/Local/R/win-library/4.2'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): trying to use CRAN without setting a mirror\n```\n:::\n\n```{.r .cell-code}\ninstall.packages(\"plm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/srika/AppData/Local/R/win-library/4.2'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in contrib.url(repos, \"source\"): trying to use CRAN without setting a mirror\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(AER)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(AER): there is no package called 'AER'\n```\n:::\n\n```{.r .cell-code}\nlibrary(plm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(plm): there is no package called 'plm'\n```\n:::\n:::\n\n\n\nEstimating a regression using differenced data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nideo_mod <- lm(diff_ideo ~ diff_econdev)\n\ncoeftest(ideo_mod, vcov = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in coeftest(ideo_mod, vcov = vcovHC, type = \"HC1\"): could not find function \"coeftest\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# plot the differenced data\nplot(x = diff_econdev, \n     y = diff_ideo, \n     xlab = \"Change in econdev\",\n     ylab = \"Change in ideo\",\n     main = \"Changes in Economic Development Agency Presence and Ideology in 1990-2000\",\n     xlim = c(-0.6, 0.6),\n     ylim = c(-1.5, 1),\n     pch = 20, \n     col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-61-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# add the regression line to plot\nabline(ideo_mod, lwd = 1.5)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...): 'a' and 'b' must be finite\n```\n:::\n:::\n\n\n\n\n##7\n\nEstimating a combined time and entity fixed effects regression model \n\n\n::: {.cell}\n\n```{.r .cell-code}\nideo_lm_mod <- lm(ideo ~ econdev + state + year - 1, data = sd2)\nideo_lm_mod\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = ideo ~ econdev + state + year - 1, data = sd2)\n\nCoefficients:\n            econdev         stateAlabama         stateArizona  \n          0.0001636           -1.2154481           -1.1040309  \n      stateArkansas      stateCalifornia        stateColorado  \n         -1.1651876           -1.0136333           -1.0488766  \n   stateConnecticut        stateDelaware         stateFlorida  \n         -0.9902822           -1.0545878           -1.0874490  \n       stateGeorgia           stateIdaho        stateIllinois  \n         -1.1408023           -1.2246658           -1.0367910  \n       stateIndiana            stateIowa          stateKansas  \n         -1.1247901           -1.1017004           -1.1408348  \n      stateKentucky       stateLouisiana           stateMaine  \n         -1.1019753           -1.1939602           -1.0447755  \n      stateMaryland   stateMassachusetts        stateMichigan  \n         -0.9994727           -0.9369923           -1.0582279  \n     stateMinnesota     stateMississippi        stateMissouri  \n         -1.0541859           -1.2190042           -1.1057527  \n       stateMontana        stateNebraska          stateNevada  \n         -1.1091557           -1.1442449           -1.0049900  \n stateNew Hampshire      stateNew Jersey      stateNew Mexico  \n         -1.0215205           -0.9929828           -1.1021508  \n      stateNew York  stateNorth Carolina    stateNorth Dakota  \n         -0.9780673           -1.1645759           -1.1695092  \n          stateOhio        stateOklahoma          stateOregon  \n         -1.0620687           -1.2172240           -1.0312511  \n  statePennsylvania    stateRhode Island  stateSouth Carolina  \n         -1.0576267           -0.9651297           -1.1801724  \n  stateSouth Dakota       stateTennessee           stateTexas  \n         -1.2298914           -1.1428635           -1.1739866  \n          stateUtah         stateVermont        stateVirginia  \n         -1.1972355           -0.9604917           -1.1262503  \n    stateWashington   stateWest Virginia       stateWisconsin  \n         -1.0045938           -1.0731507           -1.0857281  \n       stateWyoming                 year  \n         -1.1353952            0.0004764  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nideo_mod <- plm(ideo ~ econdev, \n                      data = sd2,\n                      index = c(\"state\", \"year\"), \n                      model = \"within\", \n                      effect = \"twoways\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plm(ideo ~ econdev, data = sd2, index = c(\"state\", \"year\"), model = \"within\", : could not find function \"plm\"\n```\n:::\n\n```{.r .cell-code}\ncoeftest(ideo_mod, vcov = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in coeftest(ideo_mod, vcov = vcovHC, type = \"HC1\"): could not find function \"coeftest\"\n```\n:::\n:::\n\n\n\nChecking the class of state and year\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(sd2$state)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n\n```{.r .cell-code}\nclass(sd2$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n:::\n\n\n\nChanging to factors \n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate1 <- as.factor(sd2$state)\n\nyear1 <- as.factor(sd2$year)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nideo_mod <- plm(ideo ~ econdev, \n                      data = sd2,\n                      index = c(\"state\", \"year\"), \n                      model = \"within\", \n                      effect = \"twoways\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plm(ideo ~ econdev, data = sd2, index = c(\"state\", \"year\"), model = \"within\", : could not find function \"plm\"\n```\n:::\n\n```{.r .cell-code}\ncoeftest(ideo_mod, vcov = vcovHC, type = \"HC1\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in coeftest(ideo_mod, vcov = vcovHC, type = \"HC1\"): could not find function \"coeftest\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(ideo_lm_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"lm\"\n```\n:::\n:::\n\n\n\nResults in very high p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoeftest(ideo_lm_mod, vcov = vcovHC, type = \"HC1\")[1, ]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in coeftest(ideo_lm_mod, vcov = vcovHC, type = \"HC1\"): could not find function \"coeftest\"\n```\n:::\n:::\n\n\n\n\n# Diagnostic \n\n\nDiagnostic plots for selected model #3 \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstEcLm <- lm(formula = st_ec ~ policypriorityscore + log(nonwhite) + hsdiploma + \n    st_soc, data = sd3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,3)); plot(stEcLm, which = 1:6) \n```\n\n::: {.cell-output-display}\n![](KenDocekal_finalproject2_files/figure-html/unnamed-chunk-70-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "KenDocekal_finalproject2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}