{
  "hash": "eb4b0dc2397e242005ca53e0395a70c0",
  "result": {
    "markdown": "---\ntitle: \"Homework 3\"\nauthor: \"Nick Boonstra\"\ndate: \"November 4, 2022\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.3.6      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n# Question 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nun11 <- tibble(UN11)\n\nhead(un11,20)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 6\n   region     group  fertility  ppgdp lifeExpF pctUrban\n   <fct>      <fct>      <dbl>  <dbl>    <dbl>    <dbl>\n 1 Asia       other       5.97   499      49.5       23\n 2 Europe     other       1.52  3677.     80.4       53\n 3 Africa     africa      2.14  4473      75         67\n 4 Africa     africa      5.14  4322.     53.2       59\n 5 Caribbean  other       2    13750.     81.1      100\n 6 Latin Amer other       2.17  9162.     79.9       93\n 7 Asia       other       1.74  3031.     77.3       64\n 8 Caribbean  other       1.67 22852.     77.8       47\n 9 Oceania    oecd        1.95 57119.     84.3       89\n10 Europe     oecd        1.35 45159.     83.6       68\n11 Asia       other       2.15  5638.     73.7       52\n12 Caribbean  other       1.88 22462.     78.8       84\n13 Asia       other       2.43 18184.     76.1       89\n14 Asia       other       2.16   670.     70.2       29\n15 Caribbean  other       1.58 14497.     80.3       45\n16 Europe     other       1.48  5702      76.4       75\n17 Europe     oecd        1.84 43815.     82.8       97\n18 Latin Amer other       2.68  4496.     77.8       53\n19 Africa     africa      5.08   741.     58.7       42\n20 Caribbean  other       1.76 92625.     82.3      100\n```\n:::\n\n```{.r .cell-code}\nsummary(un11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        region      group       fertility         ppgdp         \n Africa    :53   oecd  : 31   Min.   :1.134   Min.   :   114.8  \n Asia      :50   other :115   1st Qu.:1.754   1st Qu.:  1283.0  \n Europe    :39   africa: 53   Median :2.262   Median :  4684.5  \n Latin Amer:20                Mean   :2.761   Mean   : 13012.0  \n Caribbean :17                3rd Qu.:3.545   3rd Qu.: 15520.5  \n Oceania   :17                Max.   :6.925   Max.   :105095.4  \n (Other)   : 3                                                  \n    lifeExpF        pctUrban     \n Min.   :48.11   Min.   : 11.00  \n 1st Qu.:65.66   1st Qu.: 39.00  \n Median :75.89   Median : 59.00  \n Mean   :72.29   Mean   : 57.93  \n 3rd Qu.:79.58   3rd Qu.: 75.00  \n Max.   :87.12   Max.   :100.00  \n                                 \n```\n:::\n:::\n\n\nThis question involves using United Nations data to \"study the dependence of `fertility` on `ppgdp`\" (the dependence of births per 1000 females on GDP in U.S. dollars per person).\n\n## 1.1.1\n\nIn this model, `ppgdp` would be the predictor variable, and `fertility` would be the response variable.\n\n## 1.1.2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nun11 %>% \n  ggplot(aes(x=ppgdp,y=fertility)) +\n  geom_point() +\n  geom_smooth(method=lm,se=F)\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/un11 lin_lin-1.png){width=672}\n:::\n:::\n\n\nA linear OLS regression of a linear-linear model of the data does not seem to fit the data very well. While the regression does capture the general downward trend of the data, it is plain to see in the above visualization that it is not a good fit, particularly for larger values of the response variable (`ppgdp`).\n\n## 1.1.3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nun11 %>% \n  ggplot(aes(x=log(ppgdp),y=log(fertility))) +\n  geom_point() +\n  geom_smooth(method=lm,se=F)\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/un11 log_log-1.png){width=672}\n:::\n:::\n\n\nThis log-log model of the data is much better suited to a linear OLS regression fit.\n\n# Question 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq2 <- data.frame(\n  life_expec = c(77, 80, 67, 59, 91),\n  usd = c(70000, 91000, 65000, 45000, 122000)\n)\n\nq2 <- q2 %>% \n  mutate(gbp = usd * 1.33)\n\nq2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  life_expec    usd    gbp\n1         77  70000  93100\n2         80  91000 121030\n3         67  65000  86450\n4         59  45000  59850\n5         91 122000 162260\n```\n:::\n\n```{.r .cell-code}\nq2 %>% \n  ggplot(aes(x=usd,y=life_expec)) +\n  geom_point() +\n  geom_smooth(method=lm,se=F)\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/q2 df-1.png){width=672}\n:::\n\n```{.r .cell-code}\nq2 %>% \n  ggplot(aes(x=gbp,y=life_expec)) +\n  geom_point() +\n  geom_smooth(method=lm,se=F)\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/q2 df-2.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(lm(life_expec ~ usd, data = q2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_expec ~ usd, data = q2)\n\nResiduals:\n      1       2       3       4       5 \n 5.6790  0.1838 -2.2984 -2.2078 -1.3567 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)   \n(Intercept) 4.300e+01  5.438e+00   7.908  0.00422 **\nusd         4.045e-04  6.565e-05   6.162  0.00860 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.842 on 3 degrees of freedom\nMultiple R-squared:  0.9268,\tAdjusted R-squared:  0.9024 \nF-statistic: 37.97 on 1 and 3 DF,  p-value: 0.008601\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(life_expec ~ gbp, data = q2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_expec ~ gbp, data = q2)\n\nResiduals:\n      1       2       3       4       5 \n 5.6790  0.1838 -2.2984 -2.2078 -1.3567 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)   \n(Intercept) 4.300e+01  5.438e+00   7.908  0.00422 **\ngbp         3.042e-04  4.936e-05   6.162  0.00860 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.842 on 3 degrees of freedom\nMultiple R-squared:  0.9268,\tAdjusted R-squared:  0.9024 \nF-statistic: 37.97 on 1 and 3 DF,  p-value: 0.008601\n```\n:::\n:::\n\n\nAs can be seen by this example data, transforming a dataset between USD and GBP (that is, adding a linear coefficient to a variable) does change the slope coefficient of the prediction equation (corresponding to the ratio of the value of the two currencies), but it does not alter the overall correlation between the two variables.\n\n# Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwater_data <- tibble(water)\n\nhead(water_data,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 8\n    Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM\n   <int> <dbl> <dbl>   <dbl> <dbl> <dbl>   <dbl>  <int>\n 1  1948  9.13  3.58    3.91  4.1   7.43    6.47  54235\n 2  1949  5.28  4.82    5.2   7.55 11.1    10.3   67567\n 3  1950  4.2   3.77    3.67  9.52 12.2    11.4   66161\n 4  1951  4.6   4.46    3.93 11.1  15.2    11.1   68094\n 5  1952  7.15  4.99    4.88 16.3  20.0    22.8  107080\n 6  1953  9.7   5.65    4.91  8.88  8.15    7.41  67594\n 7  1954  5.02  1.45    1.77 13.6  12.4    13.3   65356\n 8  1955  6.7   7.44    6.51  9.28  9.65    9.8   67909\n 9  1956 10.5   5.85    3.38 21.2  18.6    17.4   92715\n10  1957  9.1   6.13    4.08  9.55  9.2     8.25  70024\n```\n:::\n\n```{.r .cell-code}\npairs(water_data[,2:8])\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/q3-1.png){width=672}\n:::\n:::\n\n\nThe correlation between stream runoff near Bishop, CA and rainfall at these six sites in the Sierra Nevada mountains can be interpreted from the scatterplots along the bottom row or the right-most column in the scatterplot matrix (they are both the same information). From this scatterplot matrix, it would appear that correlation between Bishop, CA runoff and Sierra Nevada rainfall is strongest for the `OPSLAKE`, `OPRC`, and `OPBPC` variables. In these plots, the data most clearly follow a linear trend, and the data are mostly staying close to a fit line. \n\n\n# Question 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrateprof <- tibble(Rateprof)\nhead(rateprof,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 17\n   gender numYears numRat…¹ numCo…² pepper disci…³ dept  quality helpf…⁴ clarity\n   <fct>     <int>    <int>   <int> <fct>  <fct>   <fct>   <dbl>   <dbl>   <dbl>\n 1 male          7       11       5 no     Hum     Engl…    4.64    4.64    4.64\n 2 male          6       11       5 no     Hum     Reli…    4.32    4.55    4.09\n 3 male         10       43       2 no     Hum     Art      4.79    4.72    4.86\n 4 male         11       24       5 no     Hum     Engl…    4.25    4.46    4.04\n 5 male         11       19       7 no     Hum     Span…    4.68    4.68    4.68\n 6 male         10       15       9 no     Hum     Span…    4.23    4.27    4.2 \n 7 male          7       17       3 no     Hum     Span…    4.38    4.35    4.41\n 8 male         11       16       3 no     Hum     Engl…    2.06    2.06    2.06\n 9 male         11       12       4 no     Hum     Music    2.04    2.17    2   \n10 male          7       18       4 no     Hum     Engl…    4.11    4.22    4   \n# … with 7 more variables: easiness <dbl>, raterInterest <dbl>,\n#   sdQuality <dbl>, sdHelpfulness <dbl>, sdClarity <dbl>, sdEasiness <dbl>,\n#   sdRaterInterest <dbl>, and abbreviated variable names ¹​numRaters,\n#   ²​numCourses, ³​discipline, ⁴​helpfulness\n```\n:::\n\n```{.r .cell-code}\npairs(rateprof[,8:12])\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/q4-1.png){width=672}\n:::\n:::\n\n\nThere is a strong positive correlation between `quality`, `helpfulness`, and `clarity`; besides that, the trend seems to be upward for all other pairs, but the correlation is not as strong.\n\n\n# Question 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(student.survey)\n\nsummary(student.survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      subj       ge           ag              hi              co       \n Min.   : 1.00   f:31   Min.   :22.00   Min.   :2.000   Min.   :2.600  \n 1st Qu.:15.75   m:29   1st Qu.:24.00   1st Qu.:3.000   1st Qu.:3.175  \n Median :30.50          Median :26.50   Median :3.350   Median :3.500  \n Mean   :30.50          Mean   :29.17   Mean   :3.308   Mean   :3.453  \n 3rd Qu.:45.25          3rd Qu.:31.00   3rd Qu.:3.625   3rd Qu.:3.725  \n Max.   :60.00          Max.   :71.00   Max.   :4.000   Max.   :4.000  \n                                                                       \n       dh             dr               tv               sp        \n Min.   :   0   Min.   : 0.200   Min.   : 0.000   Min.   : 0.000  \n 1st Qu.: 205   1st Qu.: 1.450   1st Qu.: 3.000   1st Qu.: 3.000  \n Median : 640   Median : 2.000   Median : 6.000   Median : 5.000  \n Mean   :1232   Mean   : 3.818   Mean   : 7.267   Mean   : 5.483  \n 3rd Qu.:1350   3rd Qu.: 5.000   3rd Qu.:10.000   3rd Qu.: 7.000  \n Max.   :8000   Max.   :20.000   Max.   :37.000   Max.   :16.000  \n                                                                  \n       ne               ah             ve          pa    \n Min.   : 0.000   Min.   : 0.000   Mode :logical   d:21  \n 1st Qu.: 2.000   1st Qu.: 0.000   FALSE:60        i:24  \n Median : 3.000   Median : 0.500                   r:15  \n Mean   : 4.083   Mean   : 1.433                         \n 3rd Qu.: 5.250   3rd Qu.: 2.000                         \n Max.   :14.000   Max.   :11.000                         \n                                                         \n                     pi                re         ab              aa         \n very liberal         : 8   never       :15   Mode :logical   Mode :logical  \n liberal              :24   occasionally:29   FALSE:60        FALSE:59       \n slightly liberal     : 6   most weeks  : 7                   NA's :1        \n moderate             :10   every week  : 9                                  \n slightly conservative: 6                                                    \n conservative         : 4                                                    \n very conservative    : 2                                                    \n     ld         \n Mode :logical  \n FALSE:44       \n NA's :16       \n                \n                \n                \n                \n```\n:::\n:::\n\n\nSome of the variables in question for the analysis will need to be recoded to ordinal variables before a proper regression analysis can be performed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent_survey <- student.survey %>% \n  mutate(pi_ord = case_when(\n    pi == \"very liberal\" ~ -3,\n    pi == \"liberal\" ~ -2,\n    pi == \"slightly liberal\" ~ -1,\n    pi == \"moderate\" ~ 0,\n    pi == \"slightly conservative\" ~ 1,\n    pi == \"conservative\" ~ 2,\n    pi == \"very conservative\" ~ 3\n  )) %>% \n  mutate(re_ord = case_when(\n    re == \"never\" ~ 0,\n    re == \"occasionally\" ~ 1,\n    re == \"most weeks\" ~ 2,\n    re == \"every week\" ~ 3\n  ))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(pi_ord ~ re_ord, data = student_survey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pi_ord ~ re_ord, data = student_survey)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.81243 -0.87160  0.09882  1.12840  3.09882 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -2.0988     0.2717  -7.724 1.78e-10 ***\nre_ord        0.9704     0.1792   5.416 1.22e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.345 on 58 degrees of freedom\nMultiple R-squared:  0.3359,\tAdjusted R-squared:  0.3244 \nF-statistic: 29.34 on 1 and 58 DF,  p-value: 1.221e-06\n```\n:::\n\n```{.r .cell-code}\nstudent_survey %>% \n  ggplot(aes(x=re_ord,y=pi_ord)) +\n  geom_point(alpha=0.12) +\n  geom_smooth(method=(lm))\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/pi_re-1.png){width=672}\n:::\n:::\n\nA one-point ordinal increase in church attendance, based upon this response scale, corresponds to nearly a one-point ordinal increase in conservative ideology, with zero church attendance (\"Never\") corresponding to a \"Liberal\" ideology, all to a strong level of statistical significance.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(hi ~ tv, data = student_survey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = student_survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n\n```{.r .cell-code}\nstudent_survey %>% \n  ggplot(aes(x=tv,y=hi)) +\n  geom_point(alpha=0.5) +\n  geom_smooth(method=(lm))\n```\n\n::: {.cell-output-display}\n![](hw3_boonstra_files/figure-html/hi_tv-1.png){width=672}\n:::\n:::\n\nEach additional hour of TV watched corresponds to a roughly 0.02 point decrease in a student's high school GPA. However, there are a few outliers, particularly along the predictor variable, that may skew this result.\n",
    "supporting": [
      "hw3_boonstra_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}