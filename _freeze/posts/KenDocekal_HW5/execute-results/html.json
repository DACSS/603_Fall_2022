{
  "hash": "90cf42e17b404aad827363661c66ec76",
  "result": {
    "markdown": "---\ntitle: \"HW5\"\nauthor: \"Ken Docekal\"\ndesription: \"Homework 5\"\ndate: \"12/10/2022\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n  - Ken Docekal\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(AER)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(AER): there is no package called 'AER'\n```\n:::\n\n```{.r .cell-code}\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(stargazer): there is no package called 'stargazer'\n```\n:::\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n\n\n## Q1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smss) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.2\n```\n:::\n\n```{.r .cell-code}\ndata('house.selling.price.2', package = 'smss')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       P                S              Be              Ba       \n Min.   : 17.50   Min.   :0.40   Min.   :1.000   Min.   :1.000  \n 1st Qu.: 72.90   1st Qu.:1.33   1st Qu.:3.000   1st Qu.:2.000  \n Median : 96.00   Median :1.57   Median :3.000   Median :2.000  \n Mean   : 99.53   Mean   :1.65   Mean   :3.183   Mean   :1.957  \n 3rd Qu.:115.00   3rd Qu.:1.98   3rd Qu.:4.000   3rd Qu.:2.000  \n Max.   :309.40   Max.   :3.85   Max.   :5.000   Max.   :3.000  \n      New        \n Min.   :0.0000  \n 1st Qu.:0.0000  \n Median :0.0000  \n Mean   :0.3011  \n 3rd Qu.:1.0000  \n Max.   :1.0000  \n```\n:::\n\n```{.r .cell-code}\ntibble(house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 93 × 5\n       P     S    Be    Ba   New\n   <dbl> <dbl> <int> <int> <int>\n 1  48.5  1.1      3     1     0\n 2  55    1.01     3     2     0\n 3  68    1.45     3     2     0\n 4 137    2.4      3     3     0\n 5 309.   3.3      4     3     1\n 6  17.5  0.4      1     1     0\n 7  19.6  1.28     3     1     0\n 8  24.5  0.74     3     1     0\n 9  34.8  0.78     2     1     0\n10  32    0.97     3     1     0\n# … with 83 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            P         S        Be        Ba       New\nP   1.0000000 0.8988136 0.5902675 0.7136960 0.3565540\nS   0.8988136 1.0000000 0.6691137 0.6624828 0.1762879\nBe  0.5902675 0.6691137 1.0000000 0.3337966 0.2672091\nBa  0.7136960 0.6624828 0.3337966 1.0000000 0.1820651\nNew 0.3565540 0.1762879 0.2672091 0.1820651 1.0000000\n```\n:::\n\n```{.r .cell-code}\nlm(P ~ S + Be + Ba + New, data = house.selling.price.2) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n\n# A\n\nUsing backward elimination Beds would be eliminated first as it is the variable with the largest p-value. \n\n\n# B \n\nIf we employ forward selection, as the variables with the lowest p-value, New or Size would be selected first. \n \n \n# C \n\nBed's large p-value may be due to its high correlation with Size and therefore not statistically significant on its own as the two variables are multicollinear. \n\n\n# D\n\nR2 - Using R squared and backward elimination the model below should be selected as it results in the greatest R squared score. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(P ~ S + Be + Ba + New, data = house.selling.price.2) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nAdjusted R2 - The model without Bed included is preferred if considering adjusted R squared in backward elimiation instead. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(P ~ S + Ba +  New, data = house.selling.price.2) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Ba + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nBa            20.072      5.495   3.653 0.000438 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nPRESS - Using the PRESS method the model with all variables except Bed is also preferred as that model results in the lowest PRESS score of 27860.05. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MPV)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in library(MPV): there is no package called 'MPV'\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod<-lm(P ~ S + Be + Ba + New, data = house.selling.price.2) \n\nmod1<-lm(P ~ S + Ba + New, data = house.selling.price.2) \n\nmod2<-lm(P ~ S + New, data = house.selling.price.2) \n\nmod3<-lm(P ~ S + New, data = house.selling.price.2) \n\nmod4<-lm(P ~ S, data = house.selling.price.2) \n\nPRESS(mod)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(mod): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(mod1)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(mod1): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(mod2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(mod2): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(mod3)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(mod3): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nPRESS(mod4)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(mod4): could not find function \"PRESS\"\n```\n:::\n:::\n\n\n\nAIC - The model with all variables but Bed, as the model with the lowest AIC score of 789.14, is preferred.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.6225\n```\n:::\n\n```{.r .cell-code}\nAIC(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 789.1366\n```\n:::\n\n```{.r .cell-code}\nAIC(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.1262\n```\n:::\n\n```{.r .cell-code}\nAIC(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.1262\n```\n:::\n\n```{.r .cell-code}\nAIC(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 820.1439\n```\n:::\n:::\n\n\n\nBIC - The model with all variables but Bed, as the model with the lowest BIC score of 801.80, is preferred.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 805.8181\n```\n:::\n\n```{.r .cell-code}\nBIC(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 801.7996\n```\n:::\n\n```{.r .cell-code}\nBIC(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 810.2566\n```\n:::\n\n```{.r .cell-code}\nBIC(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 810.2566\n```\n:::\n\n```{.r .cell-code}\nBIC(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 827.7417\n```\n:::\n:::\n\n\n\n# E\n\nI prefer the model with all variables except Bed. Tests using adjusted R squared, PRESS, AIC, and BIC as predictors all indicate this model has the greatest comparative predictive power. \n\n\n\n## Q2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Girth           Height       Volume     \n Min.   : 8.30   Min.   :63   Min.   :10.20  \n 1st Qu.:11.05   1st Qu.:72   1st Qu.:19.40  \n Median :12.90   Median :76   Median :24.20  \n Mean   :13.25   Mean   :76   Mean   :30.17  \n 3rd Qu.:15.25   3rd Qu.:80   3rd Qu.:37.30  \n Max.   :20.60   Max.   :87   Max.   :77.00  \n```\n:::\n\n```{.r .cell-code}\ntibble(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 31 × 3\n   Girth Height Volume\n   <dbl>  <dbl>  <dbl>\n 1   8.3     70   10.3\n 2   8.6     65   10.3\n 3   8.8     63   10.2\n 4  10.5     72   16.4\n 5  10.7     81   18.8\n 6  10.8     83   19.7\n 7  11       66   15.6\n 8  11       75   18.2\n 9  11.1     80   22.6\n10  11.2     75   19.9\n# … with 21 more rows\n```\n:::\n:::\n\n\n\n\n# A\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(Volume ~ Girth + Height, data = trees)|> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n# B\n\nBased on the residual vs fitted and normal Q-Q plots this regression model does not meet the linearity assumption. Additionally the trend line in the scale-location plot indicates non-constant variance. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit = lm(Volume ~ Girth + Height, data = trees)\n\nplot(fit, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-13-6.png){width=672}\n:::\n:::\n\n\n\n\n## Q3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(alr4) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\ndata('florida', package = 'alr4')\n\nsummary(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Gore             Bush           Buchanan     \n Min.   :   788   Min.   :  1316   Min.   :   9.0  \n 1st Qu.:  3055   1st Qu.:  4746   1st Qu.:  46.5  \n Median : 14152   Median : 20196   Median : 114.0  \n Mean   : 43341   Mean   : 43356   Mean   : 258.5  \n 3rd Qu.: 45974   3rd Qu.: 56542   3rd Qu.: 285.5  \n Max.   :386518   Max.   :289456   Max.   :3407.0  \n```\n:::\n\n```{.r .cell-code}\ntibble(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 67 × 3\n     Gore   Bush Buchanan\n    <int>  <int>    <int>\n 1  47300  34062      262\n 2   2392   5610       73\n 3  18850  38637      248\n 4   3072   5413       65\n 5  97318 115185      570\n 6 386518 177279      789\n 7   2155   2873       90\n 8  29641  35419      182\n 9  25501  29744      270\n10  14630  41745      186\n# … with 57 more rows\n```\n:::\n:::\n\n\n\n# A\n\nBased on the linear regression and plots below, Palm Beach is an outlier. The Cook's distance for Palm Beach is larger than 1 indicating an influential observation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(Buchanan ~ Bush, data = florida)|> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Buchanan ~ Bush, data = florida)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-907.50  -46.10  -29.19   12.26 2610.19 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 4.529e+01  5.448e+01   0.831    0.409    \nBush        4.917e-03  7.644e-04   6.432 1.73e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 353.9 on 65 degrees of freedom\nMultiple R-squared:  0.3889,\tAdjusted R-squared:  0.3795 \nF-statistic: 41.37 on 1 and 65 DF,  p-value: 1.727e-08\n```\n:::\n\n```{.r .cell-code}\nfit2 = lm(Buchanan ~ Bush, data = florida)\n\nplot(fit2, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-15-6.png){width=672}\n:::\n:::\n\n\n\n# B\n\nUsing log of both variables instead results a stronger model with a much higer adjusted R squared score of .85 compared to the non-log version's score of .38. This change does not seem to result in a change in the influence of Palm Beach however as indicated by similarities in the Cook's Distance and Scale-Location plots below. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(log(Buchanan) ~ log(Bush), data = florida)|> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(Buchanan) ~ log(Bush), data = florida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.96075 -0.25949  0.01282  0.23826  1.66564 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.57712    0.38919  -6.622 8.04e-09 ***\nlog(Bush)    0.75772    0.03936  19.251  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4673 on 65 degrees of freedom\nMultiple R-squared:  0.8508,\tAdjusted R-squared:  0.8485 \nF-statistic: 370.6 on 1 and 65 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit3 = lm(log(Buchanan) ~ log(Bush), data = florida)\n\nplot(fit3, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](KenDocekal_HW5_files/figure-html/unnamed-chunk-16-6.png){width=672}\n:::\n:::\n",
    "supporting": [
      "KenDocekal_HW5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}