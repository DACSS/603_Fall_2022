{
  "hash": "c76610aa69edc22c33d034edbf54f9e0",
  "result": {
    "markdown": "---\ntitle: \"Final Project Part-2\"\nauthor: \"Niharika Pola\"\ndescription: \"Final Project Part-2\"\ndate: \"12/1/2022\"\nformat:\n  html:\n    df-print: paged\n    css: styles.css\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Final Project Part-2\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(corrplot)\nlibrary(reshape2)\nlibrary(corrgram)\nlibrary(ggpubr)\nlibrary(caTools)\nlibrary(GGally)\n```\n:::\n\n\n## Background/Motivation\n\nWhat is takes for a country or a continent to be happy? Is it the economy, life-expectancy, freedom or the trust in the government? What are the factors that affect a country's or continents overall happiness? Can we predict the happiness score? The curiosity to find answers to these questions made me explore the world happiness data of 2022.\n\n\"This year marks the 10th anniversary of the **World Happiness Report**, which uses global survey data to report how people evaluate their own lives in more than 150 countries worldwide. The **World Happiness Report 2022** reveals a bright light in dark times. The pandemic brought not only pain and suffering but also an increase in social support and benevolence. As we battle the ills of disease and war, it is essential to remember the universal desire for happiness and the capacity of individuals to rally to each other's support in times of great need.\" - World Happiness Report 2022\n\n## Research Question\n\nThe World happiness data tries to measure the happiness of the populace of every country and comes up with a score which connotes the level of happiness of the populace.\n\nThe data set uses various variables to measure happiness such as the GDP per capita, Freedom to make choices, life expectancy, the perception of corruption, generosity and social support.\n\nIn this study, I aim to find out answers to the following research questions:\n\n1.  What are the variables or factors that are affecting world's happiness, with a focus on individual countries & continents. This includes analyzing the correlation between most effective variables.\n2.  To find out which model accurately predicts the happiness score.\n\n## Hypothesis\n\nI wish to test the following hypothesis,\n\n1.  Better economy of a country would lead to happiness\n2.  Longer life expectancy would lead to happiness\n3.  Having family/social support leads to happiness\n4.  Freedom leads to happiness\n5.  People's trust in the Government leads to happiness\n6.  Generosity leads to happiness\n\n## Data Preparation\n\n### Reading the data set\n\n\n```{rmessage=FALSE, warning=FALSE}\nprimary <- read.csv(\"project datasets/World Happiness Report 2022.csv\")\nhead(primary)\nstr(primary)\nstr(primary$Country)\n```\n\n\nThe dataset that I have chosen is happiness 2022 dataset, one of Kaggle's dataset. This dataset gives the happiness rank and happiness score of 147 countries around the world based on 8 factors including GDP per capita, Social support, Health life expectancy, freedom to make life choices, Generosity, Perceptions of corruption and dystopia residual. The higher value of each of these 8 factors means the level of happiness is higher. Dystopia is the opposite of utopia and has the lowest happiness level. Dystopia will be considered as a reference for other countries to show how far they are from being the poorest country regarding happiness level.\n\nSource of the data: World Happiness Report 2022 use data from the Gallup World Poll surveys from 2019 to 2021. They are based on answers to the main life evaluation question asked in the poll.\n\nSome of the variable names are not clear enough and I decided to change the name of several of them a little bit. Also, I will remove whisker low and whisker high variables from my dataset because these variables give only the lower and upper confidence interval of happiness score and there is no need to use them for visualization and prediction.\n\nThe next step is adding another column to the dataset which is continent. I want to work on different continents to discover whether there are different trends for them regarding which factors play a significant role in gaining higher happiness score. Asia, Africa, North America, South America, Europe, and Australia are our six continents in this dataset. Then I moved the position of the continent column to the second column because I think with this position arrange, dataset looks better. Finally, I changed the type of continent variable to factor to be able to work with it easily for visualization.\n\n## Preparation of the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Changing the name of columns\ncolnames (primary) <- c(\"Happiness.Rank\", \"Country\",  \"Happiness.Score\",\n                          \"Whisker.High\", \"Whisker.Low\", \"Dystopia.Residual\",   \"Economy\", \"Family\", \"Life.Expectancy\", \"Freedom\", \"Generosity\",\n                          \"Trust\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in colnames(primary) <- c(\"Happiness.Rank\", \"Country\", \"Happiness.Score\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\n# Country: Name of countries\n# Happiness.Rank: Rank of the country based on the Happiness Score\n# Happiness.Score: Happiness measurement on a scale of 0 to 10\n# Whisker.High: Upper confidence interval of happiness score\n# Whisker.Low: Lower confidence interval of happiness score\n# Economy: The value of all final goods and services produced within a nation in a given year\n# Family: Importance of having a family\n# Life.Expectancy: Importance of health and amount of time prople expect to live\n# Freedom: Importance of freedom in each country\n# Generosity: The quality of being kind and generous\n# Trust: Perception of corruption in a government\n# Dystopia.Residual: Plays as a reference\n\n# Deleting unnecessary columns (Whisker.high and Whisker.low)\n\nprimary <- primary[, -c(4,5)]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'primary' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprimary$Continent <- NA\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent <- NA: object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(primary$Country %in% c(\"Israel\", \"United Arab Emirates\", \"Singapore\", \"Thailand\", \"Taiwan Province of China\",\n                                   \"Qatar\", \"Saudi Arabia\", \"Kuwait\", \"Bahrain\", \"Malaysia\", \"Uzbekistan\", \"Japan\",\n                                   \"South Korea\", \"Turkmenistan\", \"Kazakhstan\", \"Turkey\", \"Hong Kong S.A.R., China\", \"Philippines\",\n                                   \"Jordan\", \"China\", \"Pakistan\", \"Indonesia\", \"Azerbaijan\", \"Lebanon\", \"Vietnam\",\n                                   \"Tajikistan\", \"Bhutan\", \"Kyrgyzstan\", \"Nepal\", \"Mongolia\", \"Palestinian Territories\",\n                                   \"Iran\", \"Bangladesh\", \"Myanmar\", \"Iraq\", \"Sri Lanka\", \"Armenia\", \"India\", \"Georgia\",\n                                   \"Cambodia\", \"Afghanistan\", \"Yemen\", \"Syria\"))] <- \"Asia\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(primary$Country %in% c(\"Israel\", \"United Arab Emirates\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(primary$Country %in% c(\"Norway\", \"Denmark\", \"Iceland\", \"Switzerland\", \"Finland\",\n                                   \"Netherlands\", \"Sweden\", \"Austria\", \"Ireland\", \"Germany\",\n                                   \"Belgium\", \"Luxembourg\", \"United Kingdom\", \"Czech Republic\",\n                                   \"Malta\", \"France\", \"Spain\", \"Slovakia\", \"Poland\", \"Italy\",\n                                   \"Russia\", \"Lithuania\", \"Latvia\", \"Moldova\", \"Romania\",\n                                   \"Slovenia\", \"North Cyprus\", \"Cyprus\", \"Estonia\", \"Belarus\",\n                                   \"Serbia\", \"Hungary\", \"Croatia\", \"Kosovo\", \"Montenegro\",\n                                   \"Greece\", \"Portugal\", \"Bosnia and Herzegovina\", \"Macedonia\",\n                                   \"Bulgaria\", \"Albania\", \"Ukraine\"))] <- \"Europe\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(primary$Country %in% c(\"Norway\", \"Denmark\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(primary$Country %in% c(\"Canada\", \"Costa Rica\", \"United States\", \"Mexico\",  \n                                   \"Panama\",\"Trinidad and Tobago\", \"El Salvador\", \"Belize\", \"Guatemala\",\n                                   \"Jamaica\", \"Nicaragua\", \"Dominican Republic\", \"Honduras\",\n                                   \"Haiti\"))] <- \"North America\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(primary$Country %in% c(\"Canada\", \"Costa Rica\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(primary$Country %in% c(\"Chile\", \"Brazil\", \"Argentina\", \"Uruguay\",\n                                   \"Colombia\", \"Ecuador\", \"Bolivia\", \"Peru\",\n                                   \"Paraguay\", \"Venezuela\"))] <- \"South America\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(primary$Country %in% c(\"Chile\", \"Brazil\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(primary$Country %in% c(\"New Zealand\", \"Australia\"))] <- \"Australia\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(primary$Country %in% c(\"New Zealand\", : object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nprimary$Continent[which(is.na(primary$Continent))] <- \"Africa\"\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in primary$Continent[which(is.na(primary$Continent))] <- \"Africa\": object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\n# Moving the continent column's position in the dataset to the second column\n\nprimary <- primary %>% select(Country,Continent, everything())\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., Country, Continent, everything()): object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\n#Renaming the final dataframe to happy\n\nhappy <- primary\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'primary' not found\n```\n:::\n\n```{.r .cell-code}\nstr(happy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t51020 obs. of  10 variables:\n $ id     : num  1 2 3 4 5 6 7 8 9 10 ...\n $ happy  : Factor w/ 3 levels \"not too happy\",..: 1 1 2 1 2 2 1 1 2 2 ...\n $ year   : num  1972 1972 1972 1972 1972 ...\n $ age    : num  23 70 48 27 61 26 28 27 21 30 ...\n $ sex    : Factor w/ 2 levels \"male\",\"female\": 2 1 2 2 2 1 1 1 2 2 ...\n $ marital: Factor w/ 5 levels \"married\",\"never married\",..: 2 1 1 1 1 2 3 2 2 1 ...\n $ degree : Factor w/ 5 levels \"lt high school\",..: 4 1 2 4 2 2 2 4 2 2 ...\n $ finrela: Factor w/ 5 levels \"far below average\",..: 3 4 3 3 4 4 4 3 3 2 ...\n $ health : Factor w/ 4 levels \"poor\",\"fair\",..: 3 2 4 3 3 3 4 3 4 2 ...\n $ wtssall: num  0.445 0.889 0.889 0.889 0.889 ...\n```\n:::\n:::\n\n\n## Visualization\n\n## Analyzing the correlation between each numeric variable\n\nAs we already know that the sum of these numeric variables gives the happiness score and there is an inverse relationship between happiness score and happiness rank. The higher the happiness score, the lower the happiness rank. Hence there is no need of looking at the correlation between each numeric variable and happiness rank. We can directly look at the happiness score and other numeric variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a correlation plot\nggcorr(dataset, label = TRUE, label_round = 2, label_size = 3.5, size = 2, hjust = .85) +\n  ggtitle(\"Correlation Heatmap\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggcorr(dataset, label = TRUE, label_round = 2, label_size = 3.5, : object 'dataset' not found\n```\n:::\n:::\n\n\nAccording to the above cor plot, Economy, life expectancy, and family play the most significant role in contributing to happiness. Trust and generosity have the lowest impact on the happiness score.\n\n### **Comparing different continents regarding their happiness variables**\n\nLet's calculate the average happiness score and the average of the other seven variables for each continent. Then melt it to have variables and values in separate columns. Finally, using ggplot to show the difference between continents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhappy.Continent <- happy %>%\n                          select(-3) %>%\n                          group_by(Continent) %>%\n                          summarise_at(vars(-Country), funs(mean(., na.rm=TRUE)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `group_by()`:\n! Must group by variables found in `.data`.\n✖ Column `Continent` is not found.\n```\n:::\n\n```{.r .cell-code}\n# Or we can use aggregate\n# aggregate(happy[, 4:11], list(happy$Continent), mean)\n\n# Melting the \"happy.Continent\" dataset\nhappy.Continent.melt <- melt(happy.Continent)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in melt(happy.Continent): object 'happy.Continent' not found\n```\n:::\n\n```{.r .cell-code}\n# Faceting\nggplot(happy.Continent.melt, aes(y=value, x=Continent, color=Continent, fill=Continent)) + \n  geom_bar( stat=\"identity\") +    \n  facet_wrap(~variable) + theme_bw() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +\n  labs(title = \"Average value of happiness variables for different continents\", \n       y = \"Average value\") \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(happy.Continent.melt, aes(y = value, x = Continent, color = Continent, : object 'happy.Continent.melt' not found\n```\n:::\n:::\n\n\nWe can see that Australia has approximately the highest average in all fields except dystopia residual, after that Europe, North America, and South America are roughly the same regarding happiness score and the other seven factors. Finally, Asia and Africa have the lowest scores in all fields.\n\n### **Correlation plot for each continent**\n\nLet's see the correlation between variables for each continent.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorr(happy %>% select(-3) %>% filter(Continent == \"Africa\"), label = TRUE, label_round = 2, label_size = 3.5, size = 3.5, hjust = .85) +\n  ggtitle(\"Happiness Matrix for Africa\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Continent == \"Africa\"`.\nCaused by error in `mask$eval_all_filter()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n\n**Correlation between \"Happiness Score\" and the other variables in Africa:**\\\nEconomy \\> Life Expectancy \\> Family \\> Dystopia Residual \\> Freedom\n\nHappiness score and Generosity are inversely correlated.\\\nThere is no correlation between happiness score and trust.\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorr(happy %>% select(-3) %>% filter(Continent == \"Asia\"), label = TRUE, label_round = 2, label_size = 3.5, size = 3.5, hjust = .85) +\n  ggtitle(\"Happiness Matrix for Asia\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Continent == \"Asia\"`.\nCaused by error in `mask$eval_all_filter()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n\n**Correlation between \"Happiness Score\" and the other variables in Asia:**\\\nFamily \\> Dystopia.Residual \\> Freedom \\> Economy \\> Life Expectancy \\> Trust\\\n\nThere is no correlation between happiness score and Generosity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorr(happy %>% select(-3) %>% filter(Continent == \"Europe\"), label = TRUE, label_round = 2, label_size = 3.5, size = 3.5, hjust = .85) +\n  ggtitle(\"Happiness Matrix for Europe\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Continent == \"Europe\"`.\nCaused by error in `mask$eval_all_filter()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n\n**Correlation between \"Happiness Score\" and the other variables in Europe:**\\\nTrust \\> Economy \\> Freedom \\> Life Expectancy \\> Dystopia Residual \\> Family \\> Generosity\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorr(happy %>% select(-3) %>% filter(Continent == \"North America\"), label = TRUE, label_round = 2, label_size = 3.5, size = 3.5, hjust = .85) +\n  ggtitle(\"Happiness Matrix for North America\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Continent == \"North America\"`.\nCaused by error in `mask$eval_all_filter()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n\n**Correlation between \"Happiness Score\" and the other variables in North America:**\\\nEconomy \\> Life Expectancy \\> Family \\> Generosity \\> Trust \\\nThere is an inverse correlation between happiness score and dystopia residual.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggcorr(happy %>% select(-3) %>% filter(Continent == \"South America\"), label = TRUE, label_round = 2, label_size = 3.5, size = 3.5, hjust = .85) +\n  ggtitle(\"Happiness Matrix for South America\") +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `filter()`:\n! Problem while computing `..1 = Continent == \"South America\"`.\nCaused by error in `mask$eval_all_filter()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n\n**Correlation between \"Happiness Score\" and the other variables in South America:**\\\nDystopia.Residual \\> Trust \\> Family \\> Freedom \\> Life Expectancy\\\nThere is an inverse correlation between happiness score and dystopia residual, Generosity.\n\n### **Happiness score comparison on different continents**\n\nWe will use scatter plot, box plot, and violin plot to see the happiness score distribution in different countries, how this score is populated in these continents and also will calculate the mean and median of happiness score for each of these continents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n####### Happiness score for each continent\n\ngg1 <- ggplot(happy,\n              aes(x=Continent,\n                  y=Happiness.Score,\n                  color=Continent))+\n  geom_point() + theme_bw() +\n  theme(axis.title = element_text(family = \"Helvetica\", size = (8)))\n\ngg2 <- ggplot(happy , aes(x = Continent, y = Happiness.Score)) +\n  geom_boxplot(aes(fill=Continent)) + theme_bw() +\n  theme(axis.title = element_text(family = \"Helvetica\", size = (8)))\n\ngg3 <- ggplot(happy,aes(x=Continent,y=Happiness.Score))+\n  geom_violin(aes(fill=Continent),alpha=0.7)+ theme_bw() +\n  theme(axis.title = element_text(family = \"Helvetica\", size = (8)))\n\n# Compute descriptive statistics by groups\nstable <- desc_statby(happy, measure.var = \"Happiness.Score\",\n                      grps = \"Continent\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `group_by()`:\n! Must group by variables found in `.data`.\n✖ Column `Continent` is not found.\n```\n:::\n\n```{.r .cell-code}\nstable <- stable[, c(\"Continent\",\"mean\",\"median\")]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'stable' not found\n```\n:::\n\n```{.r .cell-code}\nnames(stable) <- c(\"Continent\", \"Mean of happiness score\",\"Median of happiness score\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in names(stable) <- c(\"Continent\", \"Mean of happiness score\", \"Median of happiness score\"): object 'stable' not found\n```\n:::\n\n```{.r .cell-code}\n# Summary table plot\nstable.p <- ggtexttable(stable,rows = NULL, \n                         theme = ttheme(\"classic\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in as.matrix(d): object 'stable' not found\n```\n:::\n\n```{.r .cell-code}\nggarrange(gg1, gg2, ncol = 1, nrow = 2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `geom_point()`:\n! Problem while computing aesthetics.\nℹ Error occurred in the 1st layer.\nCaused by error in `FUN()`:\n! object 'Continent' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggarrange(gg3, stable.p, ncol = 1, nrow = 2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggarrange(gg3, stable.p, ncol = 1, nrow = 2): object 'stable.p' not found\n```\n:::\n:::\n\n\nAs we have seen before, Australia has the highest median happiness score. Europe, South America, and North America are in the second place regarding median happiness score. Asia has the lowest median after Africa. We can see the range of happiness score for different continents, and also the concentration of happiness score.\n\n## Find Relationship using Scatter Plot of Happiness Score with each variable (include regression line)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Life.Expectancy, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Life Expectancy)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nThe correlation between life expectancy and happiness score in Europe, North America, and Asia is more significant than the other continents. Worth mentioning that we will not take Australia into account because there are just two countries in Australia and creating scatter plot with the regression line for this continent will not give us any insight.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Economy, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Economy)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nWe can see pretty the same result here for the correlation between happiness score and economy. Africa has the lowest relationship in this regard.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Freedom, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Freedom)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nFreedom in Europe and North America is more correlated to happiness score than any other continents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Trust, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Trust)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nApproximately there is no correlation between trust and happiness score in Africa.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Generosity, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Generosity)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nThe regression line has a positive slope only for Europe and South America. For Asia the line is horizontal, and for Africa and North America the slope is negative.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Family, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Family)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nIn South America with increase in the family score, the happiness score remains constant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(subset(happy, happy$Continent != \"Australia\"), aes(x = Dystopia.Residual, y = Happiness.Score)) + \n  geom_point(aes(color=Continent), size = 3, alpha = 0.8) +  \n  geom_smooth(aes(color = Continent, fill = Continent), \n              method = \"lm\", fullrange = TRUE) +\n  facet_wrap(~Continent) +\n  theme_bw() + labs(title = \"Scatter plot with regression line (Happiness Score & Dystopia Residual)\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in happy$Continent: $ operator is invalid for atomic vectors\n```\n:::\n:::\n\n\nAll continents act pretty the same regarding dystopia residual.\n\n## Prediction using Regression Models\n\nIn this section, we will implement several machine learning algorithms to predict happiness score. First, we should split our dataset into training and test set. Our dependent variable is happiness score, and the independent variables are family, economy, life expectancy, trust, freedom, generosity, and dystopia residual.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Splitting the dataset into the Training set and Test set\nset.seed(123)\ndataset <- happy[4:11]\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `[.data.frame`(happy, 4:11): undefined columns selected\n```\n:::\n\n```{.r .cell-code}\nsplit = sample.split(dataset$Happiness.Score, SplitRatio = 0.8)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in sample.split(dataset$Happiness.Score, SplitRatio = 0.8): object 'dataset' not found\n```\n:::\n\n```{.r .cell-code}\ntraining_set = subset(dataset, split == TRUE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in subset(dataset, split == TRUE): object 'dataset' not found\n```\n:::\n\n```{.r .cell-code}\ntest_set = subset(dataset, split == FALSE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in subset(dataset, split == FALSE): object 'dataset' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fitting Multiple Linear Regression to the Training set\nregressor_lm = lm(formula = Happiness.Score ~ .,\n               data = training_set)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'training_set' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(regressor_lm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(regressor_lm): object 'regressor_lm' not found\n```\n:::\n:::\n\n\nThe summary shows that all independent variables have a significant impact, and adjusted R squared is 1! As we discussed, it is clear that there is a linear correlation between dependent and independent variables. Again, I should mention that the sum of the independent variables is equal to the dependent variable which is the happiness score. This is the justification for having an adjusted R squared equals to 1. As a result, I guess Multiple Linear Regression will predict happiness scores with 100 % accuracy!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n####### Predicting the Test set results\ny_pred_lm = predict(regressor_lm, newdata = test_set)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in predict(regressor_lm, newdata = test_set): object 'regressor_lm' not found\n```\n:::\n\n```{.r .cell-code}\nPred_Actual_lm <- as.data.frame(cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score): object 'y_pred_lm' not found\n```\n:::\n\n```{.r .cell-code}\ngg.lm <- ggplot(Pred_Actual_lm, aes(Actual, Prediction )) +\n  geom_point() + theme_bw() + geom_abline() +\n  labs(title = \"Multiple Linear Regression\", x = \"Actual happiness score\",\n       y = \"Predicted happiness score\") +\n  theme(plot.title = element_text(family = \"Helvetica\", face = \"bold\", size = (15)), \n        axis.title = element_text(family = \"Helvetica\", size = (10)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(Pred_Actual_lm, aes(Actual, Prediction)): object 'Pred_Actual_lm' not found\n```\n:::\n\n```{.r .cell-code}\ngg.lm\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'gg.lm' not found\n```\n:::\n:::\n\n\nAs we expected, actual versus predicted plot shows the accuracy of our model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fitting Multiple Linear Regression to the Training set\nregressor_lm_2 = lm(formula = happy$Happiness.Score ~ happy$Trust+happy$Life.Expectancy+ happy$Generosity + happy$Economy+ happy$Family + happy$Freedom+happy$Dystopia.Residual,\n               data = training_set)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'training_set' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(regressor_lm_2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(regressor_lm_2): object 'regressor_lm_2' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n####### Predicting the Test set results\ny_pred_lm = predict(regressor_lm_2, newdata = test_set)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in predict(regressor_lm_2, newdata = test_set): object 'regressor_lm_2' not found\n```\n:::\n\n```{.r .cell-code}\nPred_Actual_lm <- as.data.frame(cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in cbind(Prediction = y_pred_lm, Actual = test_set$Happiness.Score): object 'y_pred_lm' not found\n```\n:::\n\n```{.r .cell-code}\ngg.lm <- ggplot(Pred_Actual_lm, aes(Actual, Prediction )) +\n  geom_point() + theme_bw() + geom_abline() +\n  labs(title = \"Multiple Linear Regression\", x = \"Actual happiness score\",\n       y = \"Predicted happiness score\") +\n  theme(plot.title = element_text(family = \"Helvetica\", face = \"bold\", size = (15)), \n        axis.title = element_text(family = \"Helvetica\", size = (10)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(Pred_Actual_lm, aes(Actual, Prediction)): object 'Pred_Actual_lm' not found\n```\n:::\n\n```{.r .cell-code}\ngg.lm\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'gg.lm' not found\n```\n:::\n:::\n\n\n\\\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}